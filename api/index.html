<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Python API - FreeTensor</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Python API";
        var mkdocs_page_input_path = "api.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../resource/logo-light.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">FreeTensor</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/roastduck/FreeTensor">GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/">Get Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/build-and-run/">Build and Run</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/first-program/">Your First Program with FreeTenor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/schedules/">Optimize a Program with Schedules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/hint/">Optimize a Program with Hints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/gpu/">Running on a GPU</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/ad/">Automatic Differentiation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Python API</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../doxygen/html/">Internal C++ Interface</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../about/contrib/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../about/pub/">Publication</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/roastduck/FreeTensor/blob/master/LICENSE">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">FreeTensor</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>API Reference &raquo;</li>
      <li>Python API</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="python-api">Python API<a class="headerlink" href="#python-api" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="freetensor"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="freetensor.core" class="doc doc-heading">
          <code>freetensor.core</code>


<a href="#freetensor.core" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="freetensor.core.autograd" class="doc doc-heading">
          <code>freetensor.core.autograd</code>


<a href="#freetensor.core.autograd" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.autograd.ParamRetDict" class="doc doc-heading">
        <code>freetensor.core.autograd.ParamRetDict</code>


<a href="#freetensor.core.autograd.ParamRetDict" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Look an object using either a function parameter or return value's name or position</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.autograd.Parameter" class="doc doc-heading">
        <code>freetensor.core.autograd.Parameter</code>


<a href="#freetensor.core.autograd.Parameter" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Alias of a parameter of a function by position instead of by name</p>
<p><code>Parameter(n)</code> represents the n-th parameter (counted from 0)</p>
<p><code>Parameter()</code> can be used if there is only one parameter</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.autograd.Return" class="doc doc-heading">
        <code>freetensor.core.autograd.Return</code>


<a href="#freetensor.core.autograd.Return" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Alias of a return value of a function by position instead of by name</p>
<p><code>Return(n)</code> represents the n-th return value (counted from 0)</p>
<p><code>Return()</code> can be used if there is only one return value</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.grad" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">provides</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">,</span> <span class="n">tape_in_closure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.autograd.grad" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Reverse mode automatic differentiation (out-of-place version)</p>
<p>It returns a forward function, a backward function, and two maps on names. The
forward function computes the original results. The backward function computes
the gradients. The maps map from the names of the original arguments and return
values, to the names of their gradients.</p>
<p>If <code>tape_in_closure</code> is True (by default), the forward function has the same
interface of the original function, but it will store some intermediate tensors
(the tape) in some hidden global states. The backward functions receives the same
inputs as the original function plus the graidents of the outputs, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>grad</code> is an out-of-place AD interface, the backward
function returns the resulting gradients as additional return values. Names of
the additional arguments and return values can be looked up in the maps returned
by <code>grad</code>.</p>
<p>If <code>tape_in_closure</code> is False, global states described above will be passed by
explicit arguments and return values, so you can store or manipluate these states
between the forward run and the backward run.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>AST</code>
          </td>
          <td><p>The original function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>requires</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>]]</code>
          </td>
          <td><p>Name of input variables that need gradients. A parameter of a function can also
be specified with a <code>Parameter</code> object by position</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>provides</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Return" href="#freetensor.core.autograd.Return">Return</a>]]</code>
          </td>
          <td><p>Name of output variables whose gradients are known. A mutable parameter of a
function can also be specified with a <code>Parameter</code> object by position. A return
value of a function can also be specified with a <code>Return</code> object by position</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tapes</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>, <span title="freetensor_ffi.GradTapeMode">GradTapeMode</span>]</code>
          </td>
          <td><p>Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></td>
          <td>
                <code>GradTapeMode.NoReuseOnly</code>
          </td>
        </tr>
        <tr>
          <td><code>tape_in_closure</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>True to pass taped tensors from the forward function to the backward function in
implicit I/O parameters, i.e. in closure. False to pass these tensors as
explicit I/O parameters. Default to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>invert</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to true, it can reduce the amount of recomputation or taping required.
However, this may result in a loss of precision for floating-point numbers. Defaults</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>user_grads</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.StmtSetToUserGrad">StmtSetToUserGrad</span>]]</code>
          </td>
          <td><p>For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Verbosity level</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>(
0. Forward AST.
1. Backward AST.
2. Mapping from names in requries to its gradient name.
3. Mapping from names in provides to its gradient name.
)</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.grad_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad_</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">provides</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">,</span> <span class="n">tape_in_closure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.autograd.grad_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Reverse mode automatic differentiation (in-place version)</p>
<p>It returns a forward function, a backward function, and two maps on names. The
forward function computes the original results. The backward function computes
the gradients. The maps map from the names of the original arguments and return
values, to the names of their gradients.</p>
<p>If <code>tape_in_closure</code> is True (by default), the forward function has the same
interface of the original function, but it will store some intermediate tensors
(the tape) in some hidden global states. The backward functions receives the same
inputs as the original function plus the graidents of the outputs, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>grad_</code> is an in-place AD interface, the backward
function passes the resulting gradients by additional mutable arguments. Names of
the additional arguments can be looked up in the maps returned by <code>grad_</code>.</p>
<p>If <code>tape_in_closure</code> is False, global states described above will be passed by
explicit arguments and return values, so you can store or manipluate these states
between the forward run and the backward run.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>AST</code>
          </td>
          <td><p>The original function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>requires</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>]]</code>
          </td>
          <td><p>Name of input variables that need gradients. A parameter of a function can also
be specified with a <code>Parameter</code> object by position</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>provides</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Return" href="#freetensor.core.autograd.Return">Return</a>]]</code>
          </td>
          <td><p>Name of output variables whose gradients are known. A mutable parameter of a
function can also be specified with a <code>Parameter</code> object by position. A return
value of a function can also be specified with a <code>Return</code> object by position</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tapes</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>, <span title="freetensor_ffi.GradTapeMode">GradTapeMode</span>]</code>
          </td>
          <td><p>Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></td>
          <td>
                <code>GradTapeMode.NoReuseOnly</code>
          </td>
        </tr>
        <tr>
          <td><code>tape_in_closure</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>True to pass taped tensors from the forward function to the backward function in
implicit I/O parameters, i.e. in closure. False to pass these tensors as
explicit I/O parameters. Default to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>invert</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to true, it can reduce the amount of recomputation or taping required.
However, this may result in a loss of precision for floating-point numbers. Defaults
to true.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>user_grads</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.StmtSetToUserGrad">StmtSetToUserGrad</span>]]</code>
          </td>
          <td><p>For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Verbosity level</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>(
0. Forward AST.
1. Backward AST.
2. Mapping from names in requries to its gradient name.
3. Mapping from names in provides to its gradient name.
)</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.grad_body" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad_body</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">provides</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#freetensor.core.autograd.grad_body" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>grad</code> or <code>grad_</code> on a function body (for internal tests only)</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.jacrev" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">jacrev</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.autograd.jacrev" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute Jacobian tensors using Reverse mode automatic differentiation (out-of-place)</p>
<p><code>jacrev</code> computes one Jacobian tensor for one output and one or more inputs. Each
Jacobian tensor consists of derivatives of all elements in the output tensor w.r.t.
all elements in each inputs tensor.</p>
<p>It returns a forward function, a backward function, and a map on names. The
forward function computes the original results. The backward function computes
the Jacobian tensors. The map maps from the names of the original arguments to the
names of their Jacobian tensors.</p>
<p>The forward function has the same interface of the original function, but it will
store some intermediate tensors (the tape) in some hidden global states. The
backward functions receives the same inputs as the original function, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>jacrev</code> is an out-of-place interface, the backward
function returns the resulting Jacobian as additional return values. Names of the
additional return values can be looked up in the map returned by <code>jacrev</code>.</p>
<p>Suppose the output's shape is <code>(d1, d2, ...)</code>, and there are two inputs, whose shapes
are <code>(e1, e2, ...)</code> and <code>(f1, f2, ...)</code>, respectively. If <code>flatten</code> is False (by
default), the Jacobian tensors' shape will be <code>(d1, d2, ..., e1, e2, ...)</code> and
<code>(d1, d2, ..., f1, f2, ...)</code>, respectively. If <code>flatten</code> is True, there will be only
one Jacbian tensor, whose shape will be <code>(d1 * d2 * ..., e1 * e2 * ... + f1 * f2 * ...)</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>AST</code>
          </td>
          <td><p>The original function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>]]</code>
          </td>
          <td><p>Name of input variables that the Jacobian tensors are for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Return" href="#freetensor.core.autograd.Return">Return</a>]</code>
          </td>
          <td><p>Name of one output variables that the Jacobian tensors are for. A return value of a
function can be specified with a <code>Return</code> object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>flatten</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, concatenate all Jacobian tensors together, to form an <code>(n, m)</code>-shaped output,
where <code>n</code> is the total number of elements in the specified output, and <code>m</code> is the
total number of elements in the specified inputs. This requires all involved inputs
having the same data type and memory type. In this case, the name of the Jacobian
tensor will be <code>"jacrev.flatten"</code>, and the returned name map will be empty</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>tapes</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>, <span title="freetensor_ffi.GradTapeMode">GradTapeMode</span>]</code>
          </td>
          <td><p>Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></td>
          <td>
                <code>GradTapeMode.NoReuseOnly</code>
          </td>
        </tr>
        <tr>
          <td><code>invert</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to true, it can reduce the amount of recomputation or taping required.
However, this may result in a loss of precision for floating-point numbers. Defaults</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>user_grads</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.StmtSetToUserGrad">StmtSetToUserGrad</span>]]</code>
          </td>
          <td><p>For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Verbosity level</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>(
0. Forward AST.
1. Backward AST.
2. Mapping from names in inputs to its Jacobian tensor name.
)</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.jacrev_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">jacrev_</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.autograd.jacrev_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute Jacobian tensors using Reverse mode automatic differentiation (in-place)</p>
<p><code>jacrev</code> computes one Jacobian tensor for one output and one or more inputs. Each
Jacobian tensor consists of derivatives of all elements in the output tensor w.r.t.
all elements in each inputs tensor.</p>
<p>It returns a forward function, a backward function, and a map on names. The
forward function computes the original results. The backward function computes
the Jacobian tensors. The map maps from the names of the original arguments to the
names of their Jacobian tensors.</p>
<p>The forward function has the same interface of the original function, but it will
store some intermediate tensors (the tape) in some hidden global states. The
backward functions receives the same inputs as the original function, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>jacrev_</code> is an in-place interface, the backward
function passes the resulting gradients by additional mutable arguments. Names of
the additional arguments can be looked up in the map returned by <code>jacrev_</code>.</p>
<p>Suppose the output's shape is <code>(d1, d2, ...)</code>, and there are two inputs, whose shapes
are <code>(e1, e2, ...)</code> and <code>(f1, f2, ...)</code>, respectively. If <code>flatten</code> is False (by
default), the Jacobian tensors' shape will be <code>(d1, d2, ..., e1, e2, ...)</code> and
<code>(d1, d2, ..., f1, f2, ...)</code>, respectively. If <code>flatten</code> is True, there will be only
one Jacbian tensor, whose shape will be <code>(d1 * d2 * ..., e1 * e2 * ... + f1 * f2 * ...)</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>AST</code>
          </td>
          <td><p>The original function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>]]</code>
          </td>
          <td><p>Name of input variables that the Jacobian tensors are for. A parameter of a function
can also be specified with a <code>Parameter</code> object by position</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Parameter" href="#freetensor.core.autograd.Parameter">Parameter</a>, <a class="autorefs autorefs-internal" title="freetensor.core.autograd.Return" href="#freetensor.core.autograd.Return">Return</a>]</code>
          </td>
          <td><p>Name of one output variables that the Jacobian tensors are for. A mutable parameter
of a function can also be specified with a <code>Parameter</code> object by position. A return
value of a function can also be specified with a <code>Return</code> object by position</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>flatten</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, concatenate all Jacobian tensors together, to form an <code>(n, m)</code>-shaped output,
where <code>n</code> is the total number of elements in the specified output, and <code>m</code> is the
total number of elements in the specified inputs. This requires all involved inputs
having the same data type and memory type. In this case, the name of the Jacobian
tensor will be <code>"jacrev.flatten"</code>, and the returned name map will be empty</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>tapes</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>, <span title="freetensor_ffi.GradTapeMode">GradTapeMode</span>]</code>
          </td>
          <td><p>Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></td>
          <td>
                <code>GradTapeMode.NoReuseOnly</code>
          </td>
        </tr>
        <tr>
          <td><code>invert</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to true, it can reduce the amount of recomputation or taping required.
However, this may result in a loss of precision for floating-point numbers. Defaults</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>user_grads</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.StmtSetToUserGrad">StmtSetToUserGrad</span>]]</code>
          </td>
          <td><p>For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Verbosity level</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td><p>(
0. Forward AST.
1. Backward AST.
2. Mapping from names in inputs to its Jacobian tensor name.
)</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.codegen" class="doc doc-heading">
          <code>freetensor.core.codegen</code>


<a href="#freetensor.core.codegen" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.core.codegen.codegen" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">codegen</span><span class="o">.</span><span class="n">codegen</span><span class="p">(</span><span class="n">ast</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.codegen.codegen" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Generate native code</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ast</code></td>
          <td>
                <code>AST</code>
          </td>
          <td><p>The AST to be lowered. It must includes function signature to determine
parameters and return values. If not specified, a partial function is
returned, which can be used as a decorator</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>jit_cache</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[<span title="typing.Callable">Callable</span>, <span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>Function decorator used to cache JIT instances</p></td>
          <td>
                <code>functools.cache</code>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="freetensor.core.driver.Target">Target</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>The target architecture. If omitted, use the default one in config</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>NativeCode or JITTemplate</code>
          </td>
          <td><p>Return a NativeCode for the generated code if there is no JIT parameters.
Return a JITTemplate that generates a NativeCode if there is at least one</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.config" class="doc doc-heading">
          <code>freetensor.core.config</code>


<a href="#freetensor.core.config" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">
  
      <p>Global configurations</p>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.context" class="doc doc-heading">
          <code>freetensor.core.context</code>


<a href="#freetensor.core.context" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">
  
      <p>Facility to pick statements to build an AST</p>
<p>Classes and functions in this module are internally used by <code>transformer</code> to construct ASTs.
They are also used by some internal tests. API of these classes and functions are subject to changes.
End users are encouraged to use <code>transformer</code>, instead of this module.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.context.ContextStack" class="doc doc-heading">
        <code>freetensor.core.context.ContextStack</code>


<a href="#freetensor.core.context.ContextStack" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.context.ContextStack.get_last_stmt_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ContextStack</span><span class="o">.</span><span class="n">get_last_stmt_id</span><span class="p">()</span></code>

<a href="#freetensor.core.context.ContextStack.get_last_stmt_id" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Can be used inside the staged code, to get the ID of the immediately preceding statement</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.context.ContextStack.push_append_stmt_callback" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ContextStack</span><span class="o">.</span><span class="n">push_append_stmt_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span></code>

<a href="#freetensor.core.context.ContextStack.push_append_stmt_callback" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Add a callback to be called with all next statements to be appended. For <code>If</code> statement, it
can be called twice, one without "else" branch, and then maybe one more with "else" branch</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.context.StmtRange" class="doc doc-heading">
        <code>freetensor.core.context.StmtRange</code>


<a href="#freetensor.core.context.StmtRange" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Record a set of statement in a program, can be used for custom gradient</p>
<p>Usage:</p>
<pre><code>with StmtRange() as rng:
    # Some statements
</code></pre>
<p><code>StmtRange</code> can be used interleaved with AST scopes. In these cases, you can directly call
<code>__enter__</code> and <code>__exit__</code>. E.g.,</p>
<pre><code>rng = StmtRange()
rng.__enter__()
# Some statements
with VarDef(...)  # Some scopes
    # Some other statements
    rng.__exit__(None, None, None)

</code></pre>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.context.pop_ast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">pop_ast</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#freetensor.core.context.pop_ast" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get AST and reset context</p>
<p>Internally used by <code>transformer</code> and tests</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.context.pop_ast_and_user_grads" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">pop_ast_and_user_grads</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#freetensor.core.context.pop_ast_and_user_grads" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get AST and reset context. Return an extra list for custom gradients</p>
<p>Set <code>UserGrad</code> for details</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.driver" class="doc doc-heading">
          <code>freetensor.core.driver</code>


<a href="#freetensor.core.driver" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.driver.Device" class="doc doc-heading">
        <code>freetensor.core.driver.Device</code>


<a href="#freetensor.core.driver.Device" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.Device">Device</span></code></p>

  
      <p>A computing device can be constructed from
     1. (TargetType, DeviceNumber)
     2. (TargetType, getDeviceByName): cuda uses best matches criteria.
     3. (TargetType, FullName, nth): get nth(from 0) device named <code>Fullname</code>.</p>
<p>E.g. Device(TargetType::GPU, 0) means the 0-th GPU (device)
     Device(TargetType::GPU, "V100") means a GPU which best matches "V100"
     Device(TargetType::GPU, "NVIDIA GeForce RTX 3060 Laptop GPU", 0)</p>
<p>A Device can be used as a "with" scope, then all the <code>Array</code>s and <code>Driver</code>s
will use it by default. In this style, it also sets the default Target. E.g:</p>
<pre><code>with Device(...):
    ast = lower(ast)  # Use the Target of the Device above by default
    a = Array(...)  # Use the Device above by default
</code></pre>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.driver.Driver" class="doc doc-heading">
        <code>freetensor.core.driver.Driver</code>


<a href="#freetensor.core.driver.Driver" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.Driver">Driver</span></code></p>




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.Driver.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.Driver.__call__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Set argument, execute the binary code, and collect the returns</p>
<p>If there is only one return value, it is returned directly. Otherwise,
the return values are packed in a ReturnValuesPack</p>
<p>This function will introduce some overhaed handling arguments and return
values. For an accurate execution time measurement, plase call
<code>self.set_args</code> first, then <code>self.time</code>, and finally <code>self.collect_returns</code></p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.Driver.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host_device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.Driver.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Compile a program using a backend compiler and load it into memory</p>
<p>This class is for internal use. Please consider using <code>build_binary</code></p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code><span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.Func">Func</span></code>
          </td>
          <td><p>AST of the function, where the function signature is needed to
determine the parameters and return values</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>src</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Native code generated from codegen</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.driver.Device" href="#freetensor.core.driver.Device">Device</a>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>The device to run the program. If omitted, use the default device
in config</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>True to print extra infomation</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.Driver.collect_returns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">collect_returns</span><span class="p">(</span><span class="n">always_return_pack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.Driver.collect_returns" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Collect return values from an invocation</p>
<p>Return values must be collect. Otherwise there will be memory leaks</p>
<p>If there is only one return value, it is returned directly. Otherwise,
or if <code>always_return_pack</code> is set, the return values are packed in a
ReturnValuesPack</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.Driver.native_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">native_code</span><span class="p">()</span></code>

<a href="#freetensor.core.driver.Driver.native_code" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get native code compiled by backend compiler</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.Driver.set_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">set_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.Driver.set_args" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Set argument for an invocation</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.driver.ReturnValuesPack" class="doc doc-heading">
        <code>freetensor.core.driver.ReturnValuesPack</code>


<a href="#freetensor.core.driver.ReturnValuesPack" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Hold return values from a Driver invocation</p>
<p>Return values can be retrieved in an anonymous manner: <code>x, y, z = pack</code>,
or in a named manner: <code>pack['x']</code></p>
<p>Please note that a ReturnValuesPack is different from a OrderedDict, as
OrderedDict unpacks to keys rather than values</p>



  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.ReturnValuesPack.__contains__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">ReturnValuesPack</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.ReturnValuesPack.__contains__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Test if a return value exists</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.ReturnValuesPack.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">ReturnValuesPack</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.ReturnValuesPack.__getitem__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get a return value with a name. Tuple is supported for multiple values</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.driver.ReturnValuesPack.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">ReturnValuesPack</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span></code>

<a href="#freetensor.core.driver.ReturnValuesPack.__iter__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get all return values in the order declared in Func</p>

  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.driver.array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dont_drop_borrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">moved</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.array" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Factory function for Array</p>
<p>This function is preferred over directly calling <code>Array</code>'s constructor, because
it accepts more data format.</p>
<ul>
<li>If <code>data</code> is another FreeTensor <code>Array</code>, the original object will be returned,
with <code>dont_drop_borrow</code> and <code>moved</code> set to new values. If <code>dtype</code> is set and
different from the original data type, the <code>Array</code> will be copied first to convert
the data type.</li>
<li>If <code>data</code> is Numpy <code>Array</code> or PyTorch <code>Tensor</code>, it will be converted to FreeTensor
<code>Array</code>. Memory copy will be avoided in most cases, but it is inevitable if the
data is strided. If <code>dtype</code> is set and different from the original data type, the
<code>Array</code> or <code>Tensor</code> will be copied first to convert the data type.</li>
<li>Otherwise, the data will be treated as an n-dimensional array-like object, and
will be parsed according the rules in NumPy. The data type is also set accordingly,
unless <code>dtype</code> is set.</li>
</ul>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>FreeTensor Array, Numpy Array, PyTorch Tensor, or other array-like objects</code>
          </td>
          <td><p>Data to be copied to or borrowed by the new Array object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>ft.DataType or str</code>
          </td>
          <td><p>If <code>data</code> is not in <code>dtype</code>, convert it to <code>dtype</code> first before constructing
the <code>Array</code></p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dont_drop_borrow</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If true, report an error if we have to drop a borrwed data. This flag is set
to true when the Array is cunstructed IMPLICITLY (not by this function) from
a user object by borrowing from it, where users may expect they are acutually
manipulating the their user object, instead of this Array</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>moved</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If true, it means we do not care about data in this Array any more after the
program runs. Variables with "input-mutable" access type may modify the Array</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.driver.build_binary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">build_binary</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host_device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.build_binary" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compile a program using a backend compiler and load it into memory</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>code</code></td>
          <td>
                <code><span title="freetensor.core.codegen.NativeCode">NativeCode</span></code>
          </td>
          <td><p>Native code generated by <code>codegen</code>. If not specified, a partial
function is returned, which can be used as a decorator</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.driver.Device" href="#freetensor.core.driver.Device">Device</a>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>The device to run the program. If omitted, use the default device
in config</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>jit_cache</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[<span title="typing.Callable">Callable</span>, <span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>Function decorator used to cache JIT instances</p></td>
          <td>
                <code>functools.cache</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Verbosity level</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Driver or JITTemplate</code>
          </td>
          <td><p>Return a Driver for the executable if there is no JIT parameters.
Return a JITTemplate that generates a Driver if there is at least one</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.driver.move" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#freetensor.core.driver.move" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Alias for array(data, dont_drop_borrow=False, moved=True)</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.expr" class="doc doc-heading">
          <code>freetensor.core.expr</code>


<a href="#freetensor.core.expr" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">
  
      <p>Facility to build AST expressions</p>
<p>Classes and functions in this module are not only used internally for constructing AST nodes,
and also exposed to users via multi-stage programming</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.AlreadyMadeReduceTo" class="doc doc-heading">
        <code>freetensor.core.expr.AlreadyMadeReduceTo</code>


<a href="#freetensor.core.expr.AlreadyMadeReduceTo" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>A single-value type that marks a ReduceTo node is already made, and there is no need to
make another Store node</p>
<p>In standard Python data model, functions like <strong>iadd</strong> returns the modified self, and
<strong>setitem</strong> does a self-assignment. We do the augmenting assignment directly in <strong>iadd</strong>
and return AlreadyMadeReduceTo, so we do not have to Store it again</p>



  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.UndeclaredParam" class="doc doc-heading">
        <code>freetensor.core.expr.UndeclaredParam</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.expr.UndeclaredParam" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Error type. For error reporting only.</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.VarRef" class="doc doc-heading">
        <code>freetensor.core.expr.VarRef</code>


<a href="#freetensor.core.expr.VarRef" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.FrontendVar">FrontendVar</span></code></p>

  
      <p>Variable of FreeTensor</p>
<p>All variables in FreeTensor DSL (declared via <code>Var</code>, created by <code>empty</code> or <code>var</code>,
returned by <code>libop</code>, etc.), and their slices, are <code>VarRef</code> objects. Operations
on <code>VarRef</code> objects generates AST nodes</p>



  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.expr.VarRef.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRef</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.VarRef.shape" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return lengths of all dimensions or the length of one dimension</p>
<p><code>.shape()</code> -&gt; list of lengths of all dimensions</p>
<p><code>.shape(dim)</code> -&gt; length of dimension <code>dim</code>, where <code>dim</code> can be <code>int</code>
or <code>Expr</code></p>
<p>All lengths can be <code>Expr</code> (if the length is dynamically decided) or
<code>int</code> (if statically decided)</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.VarRefFromVarDef" class="doc doc-heading">
        <code>freetensor.core.expr.VarRefFromVarDef</code>


<a href="#freetensor.core.expr.VarRefFromVarDef" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="freetensor.core.expr.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code></p>

  
      <p>VarRef with extra checks</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.VarVersionRef" class="doc doc-heading">
        <code>freetensor.core.expr.VarVersionRef</code>


<a href="#freetensor.core.expr.VarVersionRef" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="freetensor.core.expr.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code></p>

  
      <p>Special VarRef used for custom gradient, generated from <code>mark_version</code></p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.abs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.abs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Absolute value</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.abs</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The absolute value</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.add" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.add" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs + rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.add</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The sum</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.any" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">any</span><span class="p">()</span></code>

<a href="#freetensor.core.expr.any" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create an AnyExpr node (only for testing and type inference)</p>
<p>Any nodes matches any expression nodes in <code>ast.match</code></p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.cast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.cast" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Cast to another type</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>DataTypr or str</code>
          </td>
          <td><p>The target data type</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The result</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ceil" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.ceil" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Round a float up to an interger (towards +inf)</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ceil</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The result</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ceildiv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.ceildiv" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Ceiling integer division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>The result rounds towards positive infinity</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ceildiv</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The quotient</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.dtype" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get element data type of a variable</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.eq" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs == rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.eq</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The comparison</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.exp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.exp" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Natural exponent</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.exp</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The exponent</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.floor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.floor" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Round a float down to an interger (towards -inf)</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.floor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The result</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.floordiv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.floordiv" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Floored integer division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>The result rounds towards negative infinity (following Python convention, instead of C)
This function is recommended over <code>round_towards_0_div</code>, as it enjoys more optimizations</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.floordiv</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The quotient</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.ge" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs &gt;= rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ge</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The comparison</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.gt" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs &gt; rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.gt</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The comparison</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.if_then_else" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">if_then_else</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">then_case</span><span class="p">,</span> <span class="n">else_case</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.if_then_else" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Similar to <code>then_case if cond else else_case</code></p>
<p>NOTE: there is NO guarantee that only one branch will be executed. In some cases,
both branches will be executed and the result of one of them will be picked.
Therefore, please do NOT use <code>if_then_else</code> to guard an out-of-bound array indexing</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cond</code></td>
          <td>
                <code>VarRef of Number</code>
          </td>
          <td><p>Condition</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>then_case</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>Then-case experssion</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>else_case</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>Else-case expression</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The result</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.intrinsic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">intrinsic</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="n">ret_type</span><span class="o">=</span><span class="s1">&#39;void&#39;</span><span class="p">,</span> <span class="n">has_side_effect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.intrinsic" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Invoke whatever target code</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fmt</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>What to run. "%" is filled by parameters one by one. E.g. sinf(%)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*params</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[Expr]</code>
          </td>
          <td><p>(Positional variadic) Parameters to <code>fmt</code></p></td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>ret_type</code></td>
          <td>
                <code>DataType or str</code>
          </td>
          <td><p>(Keyword argument only) The return type. Void for no return type. Defaults to Void</p></td>
          <td>
                <code>&#39;void&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>has_side_effect</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>(Keyword argument only) True to indicate the intrinsic modifes something other than the return value. Defaults to false</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.l_and" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">l_and</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.l_and" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Logical and of <code>lhs</code> and <code>rhs</code></p>
<p>NOTE: Short-circuit evaluation is NOT supported</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.l_and</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The logical and</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.l_not" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">l_not</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.l_not" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Logical not</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.l_not</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The logical not</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.l_or" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">l_or</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.l_or" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Logical or of <code>lhs</code> and <code>rhs</code></p>
<p>NOTE: Short-circuit evaluation is NOT supported</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.l_or</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The logical or</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.le" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs &lt;= rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.le</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The comparison</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ln" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.ln" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Natural logarithm</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ln</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The exponent</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.load_at_version" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">load_at_version</span><span class="p">(</span><span class="n">tape_name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="o">*</span><span class="n">indices</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.load_at_version" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create an LoadAtVersion node (only for custom gradient)</p>
<p>This node is only used for custom gradient. See <code>UserGradForPrevStmt</code>.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.lt" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs &lt; rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.lt</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The comparison</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.max" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Maximum of <code>lhs</code> and <code>rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.max</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The maximum</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.min" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.min" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Minimum of <code>lhs</code> and <code>rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.min</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The minimum</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.mod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.mod" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs</code> modulus <code>rhs</code></p>
<p>The result is always non-negative (following Python convention, instead of C).
This function is recommended over <code>remainder</code>, as it enjoys more optimizations</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.mod</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The modulo</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.mtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">mtype</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.mtype" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get memory type of a variable</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.mul" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.mul" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs * rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.mul</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The product</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ndim" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.ndim" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get the number of dimensions of a variable</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.ne" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs != rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ne</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The comparison</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.remainder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.remainder" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remainder of <code>lhs</code> dividing <code>rhs</code></p>
<p>The result can be positive or negative (following C convention, instead of Python).
End users are encouraged to use <code>lhs % rhs</code> instead, which follows Python convetion,
and enjoys better optimization in FreeTensor</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.remainder</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The remainder</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.round_towards_0_div" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">round_towards_0_div</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.round_towards_0_div" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>C-style integer division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>The result rounds towards 0 (following C convention, instead of Python)
End users are encouraged to use <code>lhs // rhs</code> instead, which follows Python convetion,
and enjoys better optimization in FreeTensor</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.round_towards_0_div</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The quotient</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.shape" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>shape(var, i): Get size of specified dimension of a variable
shape(var): Get sizes of all dimensions of a variable</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sigmoid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.sigmoid" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Sigmoid</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.sigmoid</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The result</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sqrt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.sqrt" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Square root</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.sqrt</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The square root</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.square" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.square" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Square</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.square</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The square</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sub" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.sub" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p><code>lhs - rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.sub</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The difference</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.tanh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.tanh" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Hyperbolic tangent</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.tanh</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expr</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The result</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.truediv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

<a href="#freetensor.core.expr.truediv" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Floating point division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.truediv</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rhs</code></td>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>VarRef or Number</code>
          </td>
          <td><p>The quotient</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.frontend" class="doc doc-heading">
          <code>freetensor.core.frontend</code>


<a href="#freetensor.core.frontend" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">
  
      <p>A frontend transforming user Python functions to ASTs via staging.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.FreeTensorOverload" class="doc doc-heading">
        <code>freetensor.core.frontend.FreeTensorOverload</code>


<a href="#freetensor.core.frontend.FreeTensorOverload" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="freetensor.core.staging.StagingOverload" href="#freetensor.core.staging.StagingOverload">StagingOverload</a></code></p>

  
      <p>Helper class managing context in IR staging.</p>



  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.frontend.FreeTensorOverload.fullname" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">fullname</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.FreeTensorOverload.fullname" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get distinct name.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.LifetimeScope" class="doc doc-heading">
        <code>freetensor.core.frontend.LifetimeScope</code>


<a href="#freetensor.core.frontend.LifetimeScope" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>This scope is used to register multiple scopes inside a single lifetime scope.
The inner scopes might be used to register variables, etc.
They will be exited in reverse order of their registration.</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.UserGrad" class="doc doc-heading">
        <code>freetensor.core.frontend.UserGrad</code>


<a href="#freetensor.core.frontend.UserGrad" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="freetensor.core.stmt.UserGradStaged" href="#freetensor.core.stmt.UserGradStaged">UserGradStaged</a></code></p>

  
      <p>Define a custom gradient</p>
<p>Follow the following steps to define custom gradient:</p>
<ol>
<li>Add some <code>mark_version</code> statements in the program. <code>mark_version('y0', y)</code> marks the specific
versions of variable <code>y</code> <strong>at the program position of the statement</strong> and <strong>at all iterations</strong>
as <code>'y0'</code>.</li>
<li>Add a <code>UserGrad</code> scope.
2.1. <code>UserGrad</code> optionally receives parameter <code>stmt_range</code>, recorded by the <code>StmtRange</code> helper class,
which means the gradient is for the code specified in the range. Ignoring the parameter means setting
gradient for the previous statement of the scope.
2.2. Other parameters of <code>UserGrad</code> sets the mapping from original variables to gradient variables.
<code>with UserGradForPrevStmt(x, y) as (dx, dy)</code> provides <code>VarRef</code> <code>dx</code> and <code>dy</code> as gradient variables
to be used inside the scope.</li>
<li>In order to use the value from the forward pass in the backward pass, do not access the forward
variables directly in the scope. Instead, use <code>load_at_version</code> expressions. <code>load_at_version(y0, i, j)</code>
loads from <code>y[i, j]</code> <strong>at the specific version marked by <code>y0 = mark_version(y)</code></strong>, saved from <strong>the same
iteration in the forward pass</strong>. (If directly writing staged code, it is <code>MarkVersion('y0', y)</code>). In
other words, after AD, the position of <code>mark_version</code> and the dynamic loop iterator together makes up
the actual version number for the tape.</li>
<li>Build the AST with <code>pop_ast_and_user_grads</code> instead of <code>pop_ast</code>. An extra list will be returned
together with the AST, which you need to pass as <code>grad</code>'s <code>user_grads</code> argument. This list records
the forward-to-backward relation of the nodes.</li>
</ol>
<p>If you are directly writing staged code, use <code>UserGradStaged</code> instead.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="freetensor.core.stmt.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a>]</code>
          </td>
          <td><p>(Positional variadic) Mapping from original variables to gradient variables</p></td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>stmt_range</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.context.StmtRange" href="#freetensor.core.context.StmtRange">StmtRange</a></code>
          </td>
          <td><p>The range in the original program that we are setting custom gradient for</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.Var" class="doc doc-heading">
        <code>freetensor.core.frontend.Var</code>


<a href="#freetensor.core.frontend.Var" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor.core.staging.StagedTypeAnnotation">StagedTypeAnnotation</span></code></p>




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.frontend.Var.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">atype</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">mtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.Var.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Declare a variable</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>shape</code></td>
          <td>
                <code>Sequence[Expr] or Var</code>
          </td>
          <td><p>Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>str or DataType</code>
          </td>
          <td><p>Data type of the variable</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atype</code></td>
          <td>
                <code>str or AccessType</code>
          </td>
          <td><p>Access type of the variable. It specifies whether (and how) the variable
is an I/O variable of the function it belongs to. Defaults to "input"</p></td>
          <td>
                <code>&#39;input&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mtype</code></td>
          <td>
                <code>str or MemType (Optional)</code>
          </td>
          <td><p>Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.VarCreator" class="doc doc-heading">
        <code>freetensor.core.frontend.VarCreator</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.frontend.VarCreator" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor.core.staging.StagedAssignable">StagedAssignable</span></code></p>




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.frontend.VarCreator.assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VarCreator</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.VarCreator.assign" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized assign behavior. Creates a VarDef with its full name.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.VersionMarker" class="doc doc-heading">
        <code>freetensor.core.frontend.VersionMarker</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.frontend.VersionMarker" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor.core.staging.StagedAssignable">StagedAssignable</span></code></p>




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.frontend.VersionMarker.assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VersionMarker</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">tape_name</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.VersionMarker.assign" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized assign behavior. Creates a MarkVersion with its full name.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.dynamic_range" class="doc doc-heading">
        <code>freetensor.core.frontend.dynamic_range</code>


<a href="#freetensor.core.frontend.dynamic_range" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor.core.staging.StagedIterable">StagedIterable</span></code></p>

  
      <p>Dynamic range that generates For loop in IR tree.</p>



  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.frontend.dynamic_range.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.dynamic_range.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Initialize a dynamic range.
Arguments semantic identical to builtin <code>range</code>.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.frontend.dynamic_range.foreach" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.dynamic_range.foreach" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized foreach behavior. Creates a For loop.</p>

  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.frontend.push_for_backward" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">push_for_backward</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

<a href="#freetensor.core.frontend.push_for_backward" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Push the current value from the forward pass to be used at the backward pass</p>
<p>This function is for custom gradients. See <code>UserGrad</code> for details on how to provide custom
gradients.</p>
<p>You may imagine there is a virtual stack for each variable. Each time you call <code>x_handle =
push_for_backward(x)</code> in the forward pass, the value of <code>x</code> <strong>at the current iteration</strong>
will be "pushed" to the virtual stack. You can access <code>x_handle</code> at the backward pass. Each
time you access <code>x_handle</code>, you will "pop" the stack and get the value of <code>x</code> <strong>pushed at
the same iteration</strong>. Since the "stack" is virtual, you do NOT need to "pop" the same count
as "push"es: the version numbering is fully automatic. Besides, there may not be a real
stack at runtime: it can be compiled to any data structure.</p>
<p>This function will be staged to <code>mark_version</code> statement in the IR.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.func" class="doc doc-heading">
          <code>freetensor.core.func</code>


<a href="#freetensor.core.func" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.func.Func" class="doc doc-heading">
        <code>freetensor.core.func.Func</code>


<a href="#freetensor.core.func.Func" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="freetensor_ffi">ffi</span>.<span title="freetensor_ffi.Func">Func</span></code></p>




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.func.Func.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">Func</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

<a href="#freetensor.core.func.Func.__call__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Enable invoking a transformed AST in another function being transformed, via
<code>inlined_invoke</code></p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.jit" class="doc doc-heading">
          <code>freetensor.core.jit</code>


<a href="#freetensor.core.jit" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.jit.JIT" class="doc doc-heading">
        <code>freetensor.core.jit.JIT</code>


<a href="#freetensor.core.jit.JIT" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Declare a function parameter as a JIT parameter</p>
<p>A function with one or more JIT parameters will be compiled to a JIT template. It can
be instantiate after the JIT paraemters are provided</p>
<p>Usage: <code>x: JIT</code> or <code>x: JIT[AnyPythonType]</code>. The latter form has no syntactic meanings,
and is only for documentation.</p>
<p>NOTE 1: The <code>JIT</code> type annotation can only be used for parameter of the outer-most
function intended for <code>@transform</code> (or <code>@optimize</code>, etc). It can NOT be used for inner
functions intended for <code>@inline</code>.</p>
<p>NOTE 2: The <code>JIT</code> type annoation can only annotated on parameters inside the function
signature. It is NOT supported in annotations for statements.</p>



  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.jit.JITTemplate" class="doc doc-heading">
        <code>freetensor.core.jit.JITTemplate</code>


<a href="#freetensor.core.jit.JITTemplate" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>abc.<span title="abc.ABC">ABC</span></code></p>

  
      <p>A template that can be instantiated given concrete arguments</p>
<p>By calling <code>instantiate</code> with actual arguments you are expecting to run a JIT function with,
an instantiated object will be returned. Subclasses of <code>JITTemplate</code> should override
<code>instantiate_by_only_jit_args</code>, and define what is actually returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>params</code></td>
          <td>
                <code>OrderedDict</code>
          </td>
          <td><p>Parameter list from inspect.signature(func).parameters</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>jit_param_names</code></td>
          <td>
                <code>Sequence</code>
          </td>
          <td><p>Sequence of names of JIT parameters in the original order defined in the function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.jit.JITTemplate.instantiate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

<a href="#freetensor.core.jit.JITTemplate.instantiate" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get an instance with the arguments you are expecting to run a JIT function with</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.jit.JITTemplate.instantiate_and_call" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">instantiate_and_call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

<a href="#freetensor.core.jit.JITTemplate.instantiate_and_call" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get an instance and call it with the arguments you are expecting to run a JIT function with</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.jit.JITTemplate.instantiate_by_only_jit_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">instantiate_by_only_jit_args</span><span class="p">(</span><span class="o">*</span><span class="n">jit_args</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#freetensor.core.jit.JITTemplate.instantiate_by_only_jit_args" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get an instance with only JIT arguments</p>
<p>This function accpets a tuple of arguments. Keyword arguments is NOT supported, so
memoization can be easier, with considering the order of the arguments.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.jit.JITTemplate.separate_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">separate_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

<a href="#freetensor.core.jit.JITTemplate.separate_args" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a list of non-JIT args, and a list of JIT args</p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.optimize" class="doc doc-heading">
          <code>freetensor.core.optimize</code>


<a href="#freetensor.core.optimize" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.core.optimize.optimize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dynamic_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.optimize.optimize" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>An one-click optimization from Python function to binary executable</p>
<p>Usage:</p>
<pre><code>@optimize
def f(...):
    ...
</code></pre>
<p>It is equivalent to:</p>
<pre><code>@build_binary
@codegen
@lower
@transform
def f(...):
    ...
</code></pre>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>Python function or AST</code>
          </td>
          <td><p>The user function to optimize. If not specified, a partial function will
be returend, which can be used as a decorator</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>schedule_callback</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Schedule(s) to apply</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="freetensor.core.driver.Target">Target</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>The target architecture. You don't have to set target if you set device</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.driver.Device" href="#freetensor.core.driver.Device">Device</a>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Where to run the program</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>default_dynamic_range</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, the built-in range is replaced with freetensor.dynamic_range.
Defaults to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>int(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Verbosity level. Can be 0, 1 or 2</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.optimize.optimize_to_pytorch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">optimize_to_pytorch</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">,</span> <span class="n">forward_schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backward_schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dynamic_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.optimize.optimize_to_pytorch" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compile a FreeTensor function to a PyTorch call, whose gradient can be
recognized by PyTorch</p>
<p>The compiled function will be a typical PyTorch's "function" (rather than
a PyTorch's "module"). Technically, this means it is a wrapper function
around a PyTorch's <code>Function</code>'s <code>apply</code> method</p>
<p>Schedules (if any) must be applied to the forward function and the backward
function separated. For this reason, currently only first-order gradient
is supported</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>Python function or AST</code>
          </td>
          <td><p>The user function to optimize. If not specified, a partial function will
be returend, which can be used as a decorator</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>tapes</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>, <span title="freetensor_ffi.GradTapeMode">GradTapeMode</span>]</code>
          </td>
          <td><p>Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></td>
          <td>
                <code>GradTapeMode.NoReuseOnly</code>
          </td>
        </tr>
        <tr>
          <td><code>forward_schedule_callback</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Schedule(s) to apply to the forward function</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>backward_schedule_callback</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Schedule(s) to apply to the backward function</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="freetensor.core.driver.Target">Target</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>The target architecture. You don't have to set target if you set device</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.driver.Device" href="#freetensor.core.driver.Device">Device</a>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Where to run the program</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>default_dynamic_range</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, the built-in range is replaced with freetensor.dynamic_range.
Defaults to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>int(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Verbosity level. Can be 0, 1 or 2</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.passes" class="doc doc-heading">
          <code>freetensor.core.passes</code>


<a href="#freetensor.core.passes" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.core.passes.lower" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">passes</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">ast</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_passes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.passes.lower" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Lower an AST using a series of passes</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ast</code></td>
          <td>
                <code>AST</code>
          </td>
          <td><p>The AST to be lowered. Can be a <code>Func</code> or a <code>Stmt</code>. If not specified, a
partial function of <code>lower</code> will be returned, which can be used as a
decorator</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="freetensor.core.driver.Target">Target</span>(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Lower the AST to a target with target-specific passes, then the AST can
be used for codegen. If not set, use the default Target in Config</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>skip_passes</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[str](<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Skip some pass for testing or debugging. Names in <code>skip_passes</code> are in
underscore_style, as in Python. Please note that some passes will not be
skipped even specified in these parameter, because they are indirectly
called in some other passes</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>jit_cache</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[<span title="typing.Callable">Callable</span>, <span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>Function decorator used to cache JIT instances</p></td>
          <td>
                <code>functools.cache</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>int(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>0 = print nothing. 1 = print the lowered AST. 2 = print AST after every
single passes</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Func or JITTemplate</code>
          </td>
          <td><p>Return a Func for an AST if there is no JIT parameters. Return a JITTemplate
that generates a Func if there is at least one</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.staging" class="doc doc-heading">
          <code>freetensor.core.staging</code>


<a href="#freetensor.core.staging" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">
  
      <p>A staging framework to support the FreeTensor frontend.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.AllowShortcutScope" class="doc doc-heading">
        <code>freetensor.core.staging.AllowShortcutScope</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.staging.AllowShortcutScope" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Allow return scope.
This is a context manager that allows return in statically deterministic control
flow.</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.BreakException" class="doc doc-heading">
        <code>freetensor.core.staging.BreakException</code>


<a href="#freetensor.core.staging.BreakException" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Exception to be raised by StagingOverload.break_stmt.
Breaks from a for loop.</p>



  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.ContinueException" class="doc doc-heading">
        <code>freetensor.core.staging.ContinueException</code>


<a href="#freetensor.core.staging.ContinueException" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Exception to be raised by StagingOverload.continue_stmt.
Continues a for loop.</p>



  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.ReturnException" class="doc doc-heading">
        <code>freetensor.core.staging.ReturnException</code>


<a href="#freetensor.core.staging.ReturnException" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Exception to be raised by StagingOverload.return_stmt.
Holds a return value that will be passed through to the function wrapper.</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagingError" class="doc doc-heading">
        <code>freetensor.core.staging.StagingError</code>


<a href="#freetensor.core.staging.StagingError" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Error occurred during staging function execution (i.e. IR tree generation).</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagingOverload" class="doc doc-heading">
        <code>freetensor.core.staging.StagingOverload</code>


<a href="#freetensor.core.staging.StagingOverload" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.allow_shortcut_scope" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">allow_shortcut_scope</span><span class="p">(</span><span class="n">allow</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.allow_shortcut_scope" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Opens a scope that allows shortcut control flows in a statically deterministic
context. Need to be closed by <code>with</code> statement.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.assert_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">assert_stmt</span><span class="p">(</span><span class="n">test</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.assert_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Assert staging tool.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.assign_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">assign_stmt</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.assign_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized assign wrapper.
If <code>value</code> is instance of <code>StagedAssignable</code>, it's regarded as a customized
assign behavior and gets executed with the assigned target variable name.
This wrapper is used for initializing a variable.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.at_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">at_position</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.at_position" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Code position handler.</p>
<p>Defaults to a no-op.
Can be overridden by subclasses.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of the file containing code for the next statement.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lineno</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Line number of the next statement.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.break_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">break_stmt</span><span class="p">()</span></code>

<a href="#freetensor.core.staging.StagingOverload.break_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Break staging tool. Only allow break in static control flow.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.continue_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">continue_stmt</span><span class="p">()</span></code>

<a href="#freetensor.core.staging.StagingOverload.continue_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Continue staging tool. Only allow continue in static control flow.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.custom_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">custom_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.custom_attr" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized attribute accessor.</p>
<p>The framework first looks for a Python native attribute. If not found, it looks
for this overloaded custom attribute resolver.</p>
<p>The default implementation provides no custom attribute.
Can be overridden by subclasses.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Object to access attribute.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Attribute name.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>The attribute value.</p></td>
        </tr>
    </tbody>
  </table>
      <h6 id="freetensor.core.staging.StagingOverload.custom_attr--throws">Throws<a class="headerlink" href="#freetensor.core.staging.StagingOverload.custom_attr--throws" title="Permanent link">&para;</a></h6>
<p>AttributeError :
    If the attribute is not found.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.foreach" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.foreach" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized foreach wrapper.
If <code>value</code> is instance of <code>StagedIterable</code>, its regarded as a customized foreach
behavior and used to generate code for the python for loop.
Otherwise, we try to execute the loop as usual.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.functiondef_wrapper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">functiondef_wrapper</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.functiondef_wrapper" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Function definition wrapper.
This wrapper performs extra initialization and cleanup for function definition.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.if_then_else_expr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">if_then_else_expr</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">then_expr</span><span class="p">,</span> <span class="n">else_expr</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.if_then_else_expr" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>If-then-else expression staging tool.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.if_then_else_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">if_then_else_stmt</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">then_body</span><span class="p">,</span> <span class="n">else_body</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.if_then_else_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>If-then-else statement staging tool.
When predicate is deterministic in staging, only one branch is generated.
Otherwise, a If node in IR is generated.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.load_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">load_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.load_attr" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Load attribute staging tool. Allows customization of reading attributes.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">metadata</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.metadata" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Metadata handler.</p>
<p>A metadata line is a comment starting with <code>#!</code> and followed by a metadata,
represented as a string parameter.</p>
<p>Defaults to a no-op.
Can be overridden by subclasses.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>content</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The metadata content.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.return_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">return_stmt</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">funcname</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.return_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return staging tool. Only allow return in static control flow.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.unpack_assign_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">unpack_assign_stmt</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.unpack_assign_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Customized assign wrapper for one or more targets.</p>
<p>If <code>values</code> is instance of <code>StagedUnpackAssignable</code>, it's regarded as a customized
assign behavior and gets executed with all the assigned targets' names. Otherwise,
it calls <code>assign_stmt</code> with each sub-assignments.</p>
<p>Please note that <code>names</code> can be nested tuples like <code>("a", ("b", "c"))</code>.</p>
<p>Please also note that <code>names</code> can also be a single string like "a" even if <code>values</code>
is a tuple. There is no unpacking in this case</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.StagingOverload.while_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">while_stmt</span><span class="p">(</span><span class="n">fpred</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.StagingOverload.while_stmt" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>While statement staging tool.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.TransformError" class="doc doc-heading">
        <code>freetensor.core.staging.TransformError</code>


<a href="#freetensor.core.staging.TransformError" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>

  
      <p>Error occurred during AST transforming from python function to staging function
that generates IR tree.</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.Transformer" class="doc doc-heading">
        <code>freetensor.core.staging.Transformer</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.staging.Transformer" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>ast.<span title="ast.NodeTransformer">NodeTransformer</span></code></p>




  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_AnnAssign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_AnnAssign</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_AnnAssign" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Rule:
<code>x: Ty</code> -&gt; <code>freetensor__annotate__x = annotate_stmt('x', Ty)
if freetensor__annotate__x:
    x = freetensor__annotate__x</code>: pure annotation</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_Assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_Assign</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_Assign" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Rule:
<code>lhs = rhs</code> -&gt; <code>lhs = unpack_assign_stmt('lhs', rhs)</code>
<code>x.lhs = rhs</code> -&gt; <code>x.lhs = unpack_assign_stmt('lhs', rhs)</code>
<code>a, (b, c) = (x, (y, z))</code> -&gt; <code>a, (b, c) = unpack_assign_stmt(('a', ('b', 'c')), (x, (y, z)))</code>
<code>a = b = c</code> -&gt; <code>a = unpack_assign_stmt('a', c); b = unpack_assign_stmt('b', c)</code></p>
<p>If <code>unpack_assign_stmt</code> is not overloaded, <code>assign_stmt</code> will be called for each item</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_Compare" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_Compare</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_Compare" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Expand multiple comparison into <code>and</code> expression.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_For" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_For</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_For" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Rule:</p>
<pre><code>for x in iter:
    body
</code></pre>
<p>-&gt;</p>
<pre><code>def for_body(x):
    body
foreach('x', iter, for_body)
</code></pre>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_If" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_If</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_If" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Rule:</p>
<pre><code>if pred:
    body
else:
    orelse
</code></pre>
<p>-&gt;</p>
<pre><code>def then_body():
    body
def else_body():
    orelse
if_then_else_stmt(pred, then_body, else_body)
</code></pre>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_IfExp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_IfExp</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_IfExp" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Rule: <code>body if test else orelse</code> -&gt; <code>if_then_else_expr(test, body, orelse)</code></p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h5 id="freetensor.core.staging.Transformer.visit_While" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_While</span><span class="p">(</span><span class="n">old_node</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.Transformer.visit_While" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Rule:</p>
<pre><code>while pred:
    body
</code></pre>
<p>-&gt;</p>
<pre><code>def while_body():
    body
while_stmt(lambda: pred, while_body)
</code></pre>

  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.staging.call_helper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">call_helper</span><span class="p">(</span><span class="n">callee</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.call_helper" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Call helper that generates a python AST Call node with given callee (overload
member) and arguments AST node.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.staging.function_helper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">function_helper</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">nonlocals</span><span class="p">)</span></code>

<a href="#freetensor.core.staging.function_helper" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Function helper that generates a python AST FunctionDef node with given name,
arguments name, and body.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.stmt" class="doc doc-heading">
          <code>freetensor.core.stmt</code>


<a href="#freetensor.core.stmt" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">
  
      <p>Facility to build AST statements</p>
<p>Classes and functions in this module are internally used by <code>transformer</code> to construct ASTs.
They are also used by some internal tests. API of these classes and functions are subject to changes.
End users are encouraged to use <code>transformer</code>, instead of this module.</p>
<p>Classes and functions in this module are all in BigCamel naming style, to distinguish from
expressions in <code>expr.py</code></p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.Assert" class="doc doc-heading">
        <code>freetensor.core.stmt.Assert</code>


<a href="#freetensor.core.stmt.Assert" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Scope used to create an Assert node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with Assert(i &gt; 0):
    ... # Assertion body
</code></pre>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.Else" class="doc doc-heading">
        <code>freetensor.core.stmt.Else</code>


<a href="#freetensor.core.stmt.Else" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Scope used to create an else branch of an If node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with If(i &gt; 0):
    ... # True branch
with Else():
    ... # Else branch
</code></pre>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.For" class="doc doc-heading">
        <code>freetensor.core.stmt.For</code>


<a href="#freetensor.core.stmt.For" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Scope used to create a For node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with For('i', 0, n) as i:
    ... # Loop body
</code></pre>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.If" class="doc doc-heading">
        <code>freetensor.core.stmt.If</code>


<a href="#freetensor.core.stmt.If" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Scope used to create an If node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with If(i &gt; 0):
    ... # Branch body
</code></pre>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.Invoke" class="doc doc-heading">
        <code>freetensor.core.stmt.Invoke</code>


<a href="#freetensor.core.stmt.Invoke" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Inlined invocation of another AST</p>
<p><code>Invoke</code> is used as a scope (<code>with Invoke(...) as returned_vars</code>), so that variables returned by
the callee can be used in the socpe</p>
<p><code>Invoke</code> can be used for invoking a gradient function, which has already been lowered as an AST.
Please note that once a user function has been lowered as an AST, the dimensionalities of its
tensors get fixed. Therefore, to invoke ordinary user functions, please use <code>inline</code> in <code>transformer</code>
instead, which supports generic types</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.NamedScope" class="doc doc-heading">
        <code>freetensor.core.stmt.NamedScope</code>


<a href="#freetensor.core.stmt.NamedScope" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Scope used to create an StmtSeq node with an explicit labels</p>
<p>E.g.:</p>
<pre><code>with NamedScope():
    ... # body
</code></pre>
<p>This scope is used for testing only. StmtSeq nodes can be deleted in many lowering passes</p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.UserGradStaged" class="doc doc-heading">
        <code>freetensor.core.stmt.UserGradStaged</code>


<a href="#freetensor.core.stmt.UserGradStaged" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Internal staged implementation of <code>UserGrad</code></p>



  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.Any" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">Any</span><span class="p">()</span></code>

<a href="#freetensor.core.stmt.Any" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create an Any node (only for testing)</p>
<p>Any nodes matches any statement nodes in <code>ast.match</code></p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.Eval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">Eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

<a href="#freetensor.core.stmt.Eval" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create an Eval node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.MarkLabel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">MarkLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></code>

<a href="#freetensor.core.stmt.MarkLabel" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Mark the ID of the following statement</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.MarkVersion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">MarkVersion</span><span class="p">(</span><span class="n">tape_name</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span></code>

<a href="#freetensor.core.stmt.MarkVersion" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create an MarkVersion node (only for custom gradient)</p>
<p>This node is only used for custom gradient. See <code>UserGrad</code>.</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.VarDef" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">VarDef</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

<a href="#freetensor.core.stmt.VarDef" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>A factory function that creates a VarDef or a series of nested <code>VarDef</code>s</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.core.utils" class="doc doc-heading">
          <code>freetensor.core.utils</code>


<a href="#freetensor.core.utils" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.core.utils.as_decorator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">as_decorator</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code>

<a href="#freetensor.core.utils.as_decorator" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Enable a multi-parameter function <code>f</code> to be used as a decorator</p>
<p>Suppose <code>g = as_decorator(f)</code>, enable the following usages:</p>
<pre><code>@g
def h(...):
    ...

@g(a=a, b=b, c=c)
def h(...):
    ...
</code></pre>
<p>Formally, <code>g</code> will have the same parameters as <code>f</code>. <code>f</code>'s first parameter should
be the function it decorate, say <code>h</code>, and may have other parameters with default
values. If <code>h</code> is set when called, <code>g</code> will return the decorated function, just
as <code>f</code> does. If <code>h</code> is not set, <code>g</code> will return an <code>f</code>'s partial function with
all other parameters set, and the partial function can then be decorate another
<code>h</code> again.</p>

  </div>

</div>



  </div>

  </div>

</div>


  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="freetensor.libop" class="doc doc-heading">
          <code>freetensor.libop</code>


<a href="#freetensor.libop" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="freetensor.libop.constant" class="doc doc-heading">
          <code>freetensor.libop.constant</code>


<a href="#freetensor.libop.constant" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.constant.zeros" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">mtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.libop.constant.zeros" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a zero tensor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>shape</code></td>
          <td>
                <code>Sequence[Expr] or Var</code>
          </td>
          <td><p>Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>str or DataType</code>
          </td>
          <td><p>Data type of the variable</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mtype</code></td>
          <td>
                <code>str or MemType (Optional)</code>
          </td>
          <td><p>Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>VarRef</code></td>          <td>
          </td>
          <td><p>The zero tensor</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.constant.zeros_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">zeros_</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>

<a href="#freetensor.libop.constant.zeros_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Fill zeros to a tensor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The tensor to fill</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.libop.element_wise" class="doc doc-heading">
          <code>freetensor.libop.element_wise</code>


<a href="#freetensor.libop.element_wise" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.binary_op" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">binary_op</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

<a href="#freetensor.libop.element_wise.binary_op" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>(Broadcasted) any element-wise operation on two tensors and return the result</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>op</code></td>
          <td>
                <code>Callable</code>
          </td>
          <td><p>The operation applied to each item</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>Left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>Right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.binary_op_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">binary_op_</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span></code>

<a href="#freetensor.libop.element_wise.binary_op_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>(Broadcasted) any element-wise operation on two tensors. The result is written to another tensor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>op</code></td>
          <td>
                <code>Callable</code>
          </td>
          <td><p>The operation applied to each item</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>Left-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>Right-hand-side operand</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>out</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.unary_op" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">unary_op</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>

<a href="#freetensor.libop.element_wise.unary_op" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Any element-wise operation on a tensor and return the result</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>op</code></td>
          <td>
                <code>Callable</code>
          </td>
          <td><p>The operation applied to each item</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The input tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.unary_op_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">unary_op_</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>

<a href="#freetensor.libop.element_wise.unary_op_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Any element-wise operation on a tensor. The result is written to another tensor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>op</code></td>
          <td>
                <code>Callable</code>
          </td>
          <td><p>The operation applied to each item</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The input tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.libop.pooling" class="doc doc-heading">
          <code>freetensor.libop.pooling</code>


<a href="#freetensor.libop.pooling" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.global_avg_pool" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">global_avg_pool</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#freetensor.libop.pooling.global_avg_pool" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Global averaging pooling. The result is returned</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.global_avg_pool_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">global_avg_pool_</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span></code>

<a href="#freetensor.libop.pooling.global_avg_pool_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Global averaging pooling. The result is written to another tensor</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.max_pool" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">max_pool</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">auto_pad</span><span class="o">=</span><span class="s1">&#39;NOTSET&#39;</span><span class="p">,</span> <span class="n">dilations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.libop.pooling.max_pool" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Maximum pooling. The result is returned</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.max_pool_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">max_pool_</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">auto_pad</span><span class="o">=</span><span class="s1">&#39;NOTSET&#39;</span><span class="p">,</span> <span class="n">dilations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#freetensor.libop.pooling.max_pool_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Maximum pooling. The result is written to another tensor</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="freetensor.libop.reduction" class="doc doc-heading">
          <code>freetensor.libop.reduction</code>


<a href="#freetensor.libop.reduction" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents ">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#freetensor.libop.reduction.reduce_max" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Maximum of a tensor through one or more dimensions and return the result</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The input tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axes</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[int](<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keepdims</code></td>
          <td>
                <code>bool(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Keep the reduced dimensions as singleton dimensions. Defaults to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_max_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_max_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#freetensor.libop.reduction.reduce_max_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Maximum of a tensor through one or more dimensions. The result is written to another tensor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The input tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axes</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[int](<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keepdims</code></td>
          <td>
                <code>bool(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Keep the reduced dimensions as singleton dimensions. Defaults to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_min" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#freetensor.libop.reduction.reduce_min" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Minimum of a tensor through one or more dimensions and return the result</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The input tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axes</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[int](<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keepdims</code></td>
          <td>
                <code>bool(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Keep the reduced dimensions as singleton dimensions. Defaults to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_min_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_min_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#freetensor.libop.reduction.reduce_min_" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Minimum of a tensor through one or more dimensions. The result is written to another tensor</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The input tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="freetensor.core.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a></code>
          </td>
          <td><p>The result tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axes</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[int](<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keepdims</code></td>
          <td>
                <code>bool(<span title="typing.Optional">Optional</span>)</code>
          </td>
          <td><p>Keep the reduced dimensions as singleton dimensions. Defaults to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>


  </div>

  </div>

</div>


  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../guide/ad/" class="btn btn-neutral float-left" title="Automatic Differentiation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../doxygen/html/" class="btn btn-neutral float-right" title="Internal C++ Interface">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../guide/ad/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../doxygen/html/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../javascripts/mathjax.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
