<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Python API - FreeTensor</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Python API";
        var mkdocs_page_input_path = "api.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../resource/logo-light.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">FreeTensor</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/roastduck/FreeTensor">GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/">Get Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/build-and-run/">Build and Run</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/first-program/">Your First Program with FreeTenor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/schedules/">Optimize a Program with Schedules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/hint/">Optimize a Program with Hints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/gpu/">Running on a GPU</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guide/ad/">Automatic Differentiation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Python API</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../doxygen/html/">Internal C++ Interface</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../about/contrib/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../about/pub/">Publication</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/roastduck/FreeTensor/blob/master/LICENSE">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">FreeTensor</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>API Reference &raquo;</li>
      <li>Python API</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="python-api">Python API<a class="headerlink" href="#python-api" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="freetensor"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">












  <div class="doc doc-object doc-module">



<h2 id="freetensor.core" class="doc doc-heading">
        <code>freetensor.core</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.autograd" class="doc doc-heading">
        <code>freetensor.core.autograd</code>



<a href="#freetensor.core.autograd" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.grad" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">provides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=&lt;</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">tape_in_closure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reset_provided_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attach_backward</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">_override_func_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.autograd.grad" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reverse mode automatic differentiation (out-of-place version)</p>
<p>It returns a forward function, a backward function, and two maps on names. The
forward function computes the original results. The backward function computes
the gradients. The maps map from the names of the original arguments and return
values, to the names of their gradients.</p>
<p>If <code>tape_in_closure</code> is True (by default), the forward function has the same
interface of the original function, but it will store some intermediate tensors
(the tape) in some hidden global states. The backward functions receives the same
inputs as the original function plus the graidents of the outputs, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>grad</code> is an out-of-place AD interface, the backward
function returns the resulting gradients as additional return values. Names of
the additional arguments and return values can be looked up in the maps returned
by <code>grad</code>.</p>
<p>If <code>tape_in_closure</code> is False, global states described above will be passed by
explicit arguments and return values, so you can store or manipluate these states
between the forward run and the backward run.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>AST</code>) – The original function</p></li>
            <li><p><strong>requires</strong> (<code>Sequence[Union[str, freetensor.core.param_ret_dict.Parameter]]</code>) – Name of input variables that need gradients. A parameter of a function can also
be specified with a <code>Parameter</code> object by position</p></li>
            <li><p><strong>provides</strong> (<code>Sequence[Union[str, freetensor.core.param_ret_dict.Parameter, freetensor.core.param_ret_dict.Return]]</code>) – Name of output variables whose gradients are known. A mutable parameter of a
function can also be specified with a <code>Parameter</code> object by position. A return
value of a function can also be specified with a <code>Return</code> object by position</p></li>
            <li><p><strong>tapes</strong> (<code>Union[Sequence, freetensor_ffi.GradTapeMode, freetensor_ffi.TapeStrategy]</code>) – Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></li>
            <li><p><strong>tape_in_closure</strong> (<code>bool</code>) – True to pass taped tensors from the forward function to the backward function in
implicit I/O parameters, i.e. in closure. False to pass these tensors as
explicit I/O parameters. Default to True</p></li>
            <li><p><strong>reset_provided_grad</strong> (<code>bool</code>) – If true, reset gradients for all variables in <code>provides</code> to 0 after use. This ensures
the final result is correct when computing gradients of a program part by part with
multiple calls to this function. If false, do not touch the provided gradient, which
makes it convenient to run for multiple rounds for timing.</p></li>
            <li><p><strong>invert</strong> (<code>bool</code>) – (Experimental) If set to true, it can reduce the amount of recomputation or taping
required. However, this may result in a loss of precision for floating-point numbers.</p></li>
            <li><p><strong>user_grads</strong> (<code>Optional[Sequence[freetensor_ffi.StmtSetToUserGrad]]</code>) – For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></li>
            <li><p><strong>attach_backward</strong> (<code>bool</code>) – If True, the forward function will be the only return value, with backward function
and other metadata attached to it</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – Verbosity level</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func if attach_backward else Tuple</code> – If <code>attach_backward</code> is False, return a tuple.</p>
<ul>
<li>Return[0]: forward AST.</li>
<li>Return[1]: backward AST.</li>
<li>Return[2]: Mapping from names in requries to its gradient name.</li>
<li>Return[3]: Mapping from names in provides to its gradient name.</li>
</ul>
<p>If <code>attach_backward</code> is True, only the forward AST is returned, and others can be get by
<code>.backward</code>, <code>.input_name_to_gradient_name</code> and <code>.output_name_to_gradient_name</code> on the
return value, respectively.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.grad_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad_</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">provides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=&lt;</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">tape_in_closure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reset_provided_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attach_backward</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">_override_func_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.autograd.grad_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reverse mode automatic differentiation (in-place version)</p>
<p>It returns a forward function, a backward function, and two maps on names. The
forward function computes the original results. The backward function computes
the gradients. The maps map from the names of the original arguments and return
values, to the names of their gradients.</p>
<p>If <code>tape_in_closure</code> is True (by default), the forward function has the same
interface of the original function, but it will store some intermediate tensors
(the tape) in some hidden global states. The backward functions receives the same
inputs as the original function plus the graidents of the outputs, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>grad_</code> is an in-place AD interface, the backward
function passes the resulting gradients by additional mutable arguments. Names of
the additional arguments can be looked up in the maps returned by <code>grad_</code>.</p>
<p>If <code>tape_in_closure</code> is False, global states described above will be passed by
explicit arguments and return values, so you can store or manipluate these states
between the forward run and the backward run.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>AST</code>) – The original function</p></li>
            <li><p><strong>requires</strong> (<code>Sequence[Union[str, freetensor.core.param_ret_dict.Parameter]]</code>) – Name of input variables that need gradients. A parameter of a function can also
be specified with a <code>Parameter</code> object by position</p></li>
            <li><p><strong>provides</strong> (<code>Sequence[Union[str, freetensor.core.param_ret_dict.Parameter, freetensor.core.param_ret_dict.Return]]</code>) – Name of output variables whose gradients are known. A mutable parameter of a
function can also be specified with a <code>Parameter</code> object by position. A return
value of a function can also be specified with a <code>Return</code> object by position</p></li>
            <li><p><strong>tapes</strong> (<code>Union[Sequence, freetensor_ffi.GradTapeMode, freetensor_ffi.TapeStrategy]</code>) – Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></li>
            <li><p><strong>tape_in_closure</strong> (<code>bool</code>) – True to pass taped tensors from the forward function to the backward function in
implicit I/O parameters, i.e. in closure. False to pass these tensors as
explicit I/O parameters. Default to True</p></li>
            <li><p><strong>reset_provided_grad</strong> (<code>bool</code>) – If true, reset gradients for all variables in <code>provides</code> to 0 after use. This ensures
the final result is correct when computing gradients of a program part by part with
multiple calls to this function. If false, do not touch the provided gradient, which
makes it convenient to run for multiple rounds for timing.</p></li>
            <li><p><strong>invert</strong> (<code>bool</code>) – (Experimental) If set to true, it can reduce the amount of recomputation or taping
required. However, this may result in a loss of precision for floating-point numbers.</p></li>
            <li><p><strong>user_grads</strong> (<code>Optional[Sequence[freetensor_ffi.StmtSetToUserGrad]]</code>) – For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></li>
            <li><p><strong>attach_backward</strong> (<code>bool</code>) – If True, the forward function will be the only return value, with backward function
and other metadata attached to it</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – Verbosity level</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func if attach_backward else Tuple</code> – If <code>attach_backward</code> is False, return a tuple.</p>
<ul>
<li>Return[0]: forward AST.</li>
<li>Return[1]: backward AST.</li>
<li>Return[2]: Mapping from names in requries to its gradient name.</li>
<li>Return[3]: Mapping from names in provides to its gradient name.</li>
</ul>
<p>If <code>attach_backward</code> is True, only the forward AST is returned, and others can be get by
<code>.backward</code>, <code>.input_name_to_gradient_name</code> and <code>.output_name_to_gradient_name</code> on the
return value, respectively.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.grad_body" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad_body</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">provides</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=&lt;</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">reset_provided_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="p">[])</span></code>


<a href="#freetensor.core.autograd.grad_body" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>grad</code> or <code>grad_</code> on a function body (for internal tests only)</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.jacrev" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">jacrev</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=&lt;</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">tape_in_closure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attach_backward</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">_override_func_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.autograd.jacrev" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Compute Jacobian tensors using Reverse mode automatic differentiation (out-of-place)</p>
<p><code>jacrev</code> computes one Jacobian tensor for one output and one or more inputs. Each
Jacobian tensor consists of derivatives of all elements in the output tensor w.r.t.
all elements in each inputs tensor.</p>
<p>It returns a forward function, a backward function, and a map on names. The
forward function computes the original results. The backward function computes
the Jacobian tensors. The map maps from the names of the original arguments to the
names of their Jacobian tensors.</p>
<p>By default, the forward function has the same interface of the original function, but
it will store some intermediate tensors (the tape) in some hidden global states. The
backward functions receives the same inputs as the original function, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>jacrev</code> is an out-of-place interface, the backward
function returns the resulting Jacobian as additional return values. Names of the
additional return values can be looked up in the map returned by <code>jacrev</code>.</p>
<p>Suppose the output's shape is <code>(d1, d2, ...)</code>, and there are two inputs, whose shapes
are <code>(e1, e2, ...)</code> and <code>(f1, f2, ...)</code>, respectively. If <code>flatten</code> is False (by
default), the Jacobian tensors' shape will be <code>(d1, d2, ..., e1, e2, ...)</code> and
<code>(d1, d2, ..., f1, f2, ...)</code>, respectively. If <code>flatten</code> is True, there will be only
one Jacbian tensor, whose shape will be <code>(d1 * d2 * ..., e1 * e2 * ... + f1 * f2 * ...)</code>.</p>
<p>If <code>tape_in_closure</code> is False, global states described above will be passed by
explicit arguments and return values, so you can store or manipluate these states
between the forward run and the backward run.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>AST</code>) – The original function</p></li>
            <li><p><strong>inputs</strong> (<code>Sequence[Union[str, freetensor.core.param_ret_dict.Parameter]]</code>) – Name of input variables that the Jacobian tensors are for.</p></li>
            <li><p><strong>output</strong> (<code>Union[str, freetensor.core.param_ret_dict.Parameter, freetensor.core.param_ret_dict.Return]</code>) – Name of one output variables that the Jacobian tensors are for. A return value of a
function can be specified with a <code>Return</code> object</p></li>
            <li><p><strong>flatten</strong> (<code>bool</code>) – If True, concatenate all Jacobian tensors together, to form an <code>(n, m)</code>-shaped output,
where <code>n</code> is the total number of elements in the specified output, and <code>m</code> is the
total number of elements in the specified inputs. This requires all involved inputs
having the same data type and memory type. In this case, the name of the Jacobian
tensor will be <code>"jacrev.flatten"</code>, and the returned name map will be empty</p></li>
            <li><p><strong>tapes</strong> (<code>Union[Sequence, freetensor_ffi.GradTapeMode, freetensor_ffi.TapeStrategy]</code>) – Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></li>
            <li><p><strong>tape_in_closure</strong> (<code>bool</code>) – True to pass taped tensors from the forward function to the backward function in
implicit I/O parameters, i.e. in closure. False to pass these tensors as
explicit I/O parameters. Default to True</p></li>
            <li><p><strong>invert</strong> (<code>bool</code>) – (Experimental) If set to true, it can reduce the amount of recomputation or taping
required. However, this may result in a loss of precision for floating-point numbers.</p></li>
            <li><p><strong>user_grads</strong> (<code>Optional[Sequence[freetensor_ffi.StmtSetToUserGrad]]</code>) – For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></li>
            <li><p><strong>attach_backward</strong> (<code>bool</code>) – If True, the forward function will be the only return value, with backward function
and other metadata attached to it</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – Verbosity level</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func if attach_backward else Tuple</code> – If <code>attach_backward</code> is False, return a tuple.</p>
<ul>
<li>Return[0]: forward AST.</li>
<li>Return[1]: backward AST.</li>
<li>Return[2]: Mapping from names in inputs to its Jacobian tensor name.</li>
</ul>
<p>If <code>attach_backward</code> is True, only the forward AST is returned, and others can be get by
<code>.backward</code> and <code>.input_name_to_gradient_name</code> on the return value, respectively.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.autograd.jacrev_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">jacrev_</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=&lt;</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">tape_in_closure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">user_grads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attach_backward</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">_override_func_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.autograd.jacrev_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Compute Jacobian tensors using Reverse mode automatic differentiation (in-place)</p>
<p><code>jacrev</code> computes one Jacobian tensor for one output and one or more inputs. Each
Jacobian tensor consists of derivatives of all elements in the output tensor w.r.t.
all elements in each inputs tensor.</p>
<p>It returns a forward function, a backward function, and a map on names. The
forward function computes the original results. The backward function computes
the Jacobian tensors. The map maps from the names of the original arguments to the
names of their Jacobian tensors.</p>
<p>By default, the forward function has the same interface of the original function, but
it will store some intermediate tensors (the tape) in some hidden global states. The
backward functions receives the same inputs as the original function, and also reads
from the hidden states. The outputs of the original function are no longer exist
in the backward function, and the input-outputs of the original function are
converted to pure inputs. As <code>jacrev_</code> is an in-place interface, the backward
function passes the resulting gradients by additional mutable arguments. Names of
the additional arguments can be looked up in the map returned by <code>jacrev_</code>.</p>
<p>Suppose the output's shape is <code>(d1, d2, ...)</code>, and there are two inputs, whose shapes
are <code>(e1, e2, ...)</code> and <code>(f1, f2, ...)</code>, respectively. If <code>flatten</code> is False (by
default), the Jacobian tensors' shape will be <code>(d1, d2, ..., e1, e2, ...)</code> and
<code>(d1, d2, ..., f1, f2, ...)</code>, respectively. If <code>flatten</code> is True, there will be only
one Jacbian tensor, whose shape will be <code>(d1 * d2 * ..., e1 * e2 * ... + f1 * f2 * ...)</code>.</p>
<p>If <code>tape_in_closure</code> is False, global states described above will be passed by
explicit arguments and return values, so you can store or manipluate these states
between the forward run and the backward run.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>AST</code>) – The original function</p></li>
            <li><p><strong>inputs</strong> (<code>Sequence[Union[str, freetensor.core.param_ret_dict.Parameter]]</code>) – Name of input variables that the Jacobian tensors are for. A parameter of a function
can also be specified with a <code>Parameter</code> object by position</p></li>
            <li><p><strong>output</strong> (<code>Union[str, freetensor.core.param_ret_dict.Parameter, freetensor.core.param_ret_dict.Return]</code>) – Name of one output variables that the Jacobian tensors are for. A mutable parameter
of a function can also be specified with a <code>Parameter</code> object by position. A return
value of a function can also be specified with a <code>Return</code> object by position</p></li>
            <li><p><strong>flatten</strong> (<code>bool</code>) – If True, concatenate all Jacobian tensors together, to form an <code>(n, m)</code>-shaped output,
where <code>n</code> is the total number of elements in the specified output, and <code>m</code> is the
total number of elements in the specified inputs. This requires all involved inputs
having the same data type and memory type. In this case, the name of the Jacobian
tensor will be <code>"jacrev.flatten"</code>, and the returned name map will be empty</p></li>
            <li><p><strong>tapes</strong> (<code>Union[Sequence, freetensor_ffi.GradTapeMode]</code>) – Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></li>
            <li><p><strong>tape_in_closure</strong> (<code>bool</code>) – True to pass taped tensors from the forward function to the backward function in
implicit I/O parameters, i.e. in closure. False to pass these tensors as
explicit I/O parameters. Default to True</p></li>
            <li><p><strong>invert</strong> (<code>bool</code>) – (Experimental) If set to true, it can reduce the amount of recomputation or taping
required. However, this may result in a loss of precision for floating-point numbers.</p></li>
            <li><p><strong>user_grads</strong> (<code>Optional[Sequence[freetensor_ffi.StmtSetToUserGrad]]</code>) – For custom gradient. You do not have to explicitly set this parameter unless you
are manipulating <code>func</code> by yourself (not getting it from the Python frontend). See
<code>UserGrad</code> for details</p></li>
            <li><p><strong>attach_backward</strong> (<code>bool</code>) – If True, the forward function will be the only return value, with backward function
and other metadata attached to it</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – Verbosity level</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func if attach_backward else Tuple</code> – If <code>attach_backward</code> is False, return a tuple.</p>
<ul>
<li>Return[0]: forward AST.</li>
<li>Return[1]: backward AST.</li>
<li>Return[2]: Mapping from names in inputs to its Jacobian tensor name.</li>
</ul>
<p>If <code>attach_backward</code> is True, only the forward AST is returned, and others can be get by
<code>.backward</code> and <code>.input_name_to_gradient_name</code> on the return value, respectively.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.codegen" class="doc doc-heading">
        <code>freetensor.core.codegen</code>



<a href="#freetensor.core.codegen" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.codegen.NativeCode" class="doc doc-heading">
        <code>
freetensor.core.codegen.NativeCode            (<a class="autorefs autorefs-internal" title="freetensor.core.enable_attach_backward.EnableAttachBackward" href="#freetensor.core.enable_attach_backward.EnableAttachBackward">EnableAttachBackward</a>, <span title="freetensor_ffi.NativeCode">NativeCode</span>)
        </code>



<a href="#freetensor.core.codegen.NativeCode" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Generated native code with metadata</p>
<p>NOTE: This class does not support serialization yet. If you need serialization,
serialize the Func, and re-run codegen.</p>




  <div class="doc doc-children">




















  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.codegen.NativeCode.__contains__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">codegen</span><span class="o">.</span><span class="n">NativeCode</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.codegen.NativeCode.__contains__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Legacy interface for testing if a string is in the code</p>

    </div>

  </div>









  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.codegen.codegen" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">codegen</span><span class="o">.</span><span class="n">codegen</span><span class="p">(</span><span class="n">ast</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.codegen.codegen" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Generate native code</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>ast</strong> (<code>Func</code>) – The AST to be lowered. It must includes function signature to determine
parameters and return values. If not specified, a partial function is
returned, which can be used as a decorator</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>target</strong> (<code>Optional[freetensor_ffi.Target]</code>) – The target architecture. If omitted, use the default one in config</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>NativeCode</code> – Return a NativeCode for the generated code if there is no JIT parameters.
Return a JITTemplate that generates a NativeCode if there is at least one</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.config" class="doc doc-heading">
        <code>freetensor.core.config</code>



<a href="#freetensor.core.config" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Global configurations</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.backend_compiler_cxx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">backend_compiler_cxx</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.backend_compiler_cxx" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>backend_compiler_cxx() -&gt; List[str]</p>
<p>Backend compiler used to compile generated C++ code</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.backend_compiler_nvcc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">backend_compiler_nvcc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.backend_compiler_nvcc" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>backend_compiler_nvcc() -&gt; List[str]</p>
<p>Backend compiler used to compile generated CUDA code</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.backend_openmp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">backend_openmp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.backend_openmp" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>backend_openmp() -&gt; List[str]</p>
<p>OpenMP library linked to the compiled executable</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.debug_binary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">debug_binary</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.debug_binary" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>debug_binary() -&gt; bool</p>
<p>Check if compiling binary in debug mode</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.debug_cuda_with_um" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">debug_cuda_with_um</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.debug_cuda_with_um" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>debug_cuda_with_um() -&gt; bool</p>
<p>Check if debugging with Unified Memory enabled</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.default_device" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">default_device</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.default_device" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>default_device() -&gt; freetensor_ffi.Device</p>
<p>Check current default device</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.default_target" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">default_target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.default_target" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>default_target() -&gt; freetensor_ffi.Target</p>
<p>Check current default target</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.fast_math" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">fast_math</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.fast_math" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>fast_math() -&gt; bool</p>
<p>Run <code>pass/float_simplify</code> optimization pass, and enable fast math on backend compilers</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.pretty_print" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.pretty_print" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>pretty_print() -&gt; bool</p>
<p>Check if colored printing enabled</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.print_all_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">print_all_id</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.print_all_id" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>print_all_id() -&gt; bool</p>
<p>Check if printing IDs of all statements in an AST</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.print_source_location" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">print_source_location</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.print_source_location" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>print_source_location() -&gt; bool</p>
<p>Check if printing Python source location of all statements in an AST</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.runtime_dir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">runtime_dir</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.runtime_dir" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>runtime_dir() -&gt; List[str]</p>
<p>Serach paths for FreeTensor runtime header files</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_backend_compiler_cxx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_backend_compiler_cxx</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_backend_compiler_cxx" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_backend_compiler_cxx(path: List[str]) -&gt; None</p>
<p>Set backend compiler used to compile generated C++ code, unescaped raw path expected</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_backend_compiler_nvcc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_backend_compiler_nvcc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_backend_compiler_nvcc" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_backend_compiler_nvcc(path: List[str]) -&gt; None</p>
<p>Set backend compiler used to compile generated CUDA code, unescaped raw path expected</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_backend_openmp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_backend_openmp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_backend_openmp" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_backend_openmp(arg0: List[str]) -&gt; None</p>
<p>Set the OpenMP library linked to the compiled executable</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_debug_binary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_debug_binary</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_debug_binary" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_debug_binary(flag: bool = True) -&gt; None</p>
<p>Compile with <code>-g</code> at backend. FreeTensor will not delete the binary file after loading it</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_debug_cuda_with_um" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_debug_cuda_with_um</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_debug_cuda_with_um" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_debug_cuda_with_um(arg0: bool) -&gt; None</p>
<p>Allocate CUDA buffers on Unified Memory, for faster (debugging) access of GPU <code>Array</code> from CPU, but with slower <code>Array</code> allocations and more synchronizations. No performance effect on normal in-kernel computations</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_default_device" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_default_device</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_default_device" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_default_device(device: freetensor_ffi.Device) -&gt; None</p>
<p>Set default device (internal implementation of <code>with Device</code>)</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_default_target" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_default_target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_default_target" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_default_target(target: freetensor_ffi.Target) -&gt; None</p>
<p>Set default target (internal implementation of <code>with Target</code>)</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_fast_math" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_fast_math</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_fast_math" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_fast_math(flag: bool = True) -&gt; None</p>
<p>Set to run <code>pass/float_simplify</code> optimization pass, and enable fast math on backend compilers (or not)</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_pretty_print" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_pretty_print</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_pretty_print" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_pretty_print(flag: bool = True) -&gt; None</p>
<p>Set colored printing</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_print_all_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_print_all_id</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_print_all_id" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_print_all_id(flag: bool = True) -&gt; None</p>
<p>Print IDs of all statements in an AST</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_print_source_location" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_print_source_location</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_print_source_location" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_print_source_location(flag: bool = True) -&gt; None</p>
<p>Print Python source location of all statements in an AST</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_runtime_dir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_runtime_dir</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_runtime_dir" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_runtime_dir(paths: List[str]) -&gt; None</p>
<p>Set serach paths for FreeTensor runtime header files</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.set_werror" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_werror</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.set_werror" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>set_werror(flag: bool = True) -&gt; None</p>
<p>Error on warning</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.werror" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">werror</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.werror" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>werror() -&gt; bool</p>
<p>Check if error-on-warning enabled</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.with_cuda" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">with_cuda</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.with_cuda" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>with_cuda() -&gt; bool</p>
<p>Check if FreeTensor is built with CUDA</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.with_mkl" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">with_mkl</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.with_mkl" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>with_mkl() -&gt; bool</p>
<p>Check if FreeTensor is built with MKL</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.config.with_pytorch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">with_pytorch</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.config.with_pytorch" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>with_pytorch() -&gt; bool</p>
<p>Check if FreeTensor is built with PyTorch interface</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.context" class="doc doc-heading">
        <code>freetensor.core.context</code>



<a href="#freetensor.core.context" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Facility to pick statements to build an AST</p>
<p>Classes and functions in this module are internally used by <code>transformer</code> to construct ASTs.
They are also used by some internal tests. API of these classes and functions are subject to changes.
End users are encouraged to use <code>transformer</code>, instead of this module.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.context.ContextStack" class="doc doc-heading">
        <code>
freetensor.core.context.ContextStack        </code>



<a href="#freetensor.core.context.ContextStack" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.context.ContextStack.get_last_stmt_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ContextStack</span><span class="o">.</span><span class="n">get_last_stmt_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.context.ContextStack.get_last_stmt_id" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Can be used inside the staged code, to get the ID of the immediately preceding statement</p>

    </div>

  </div>








  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.context.ContextStack.push_append_stmt_callback" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">ContextStack</span><span class="o">.</span><span class="n">push_append_stmt_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>


<a href="#freetensor.core.context.ContextStack.push_append_stmt_callback" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Add a callback to be called with all next statements to be appended. For <code>If</code> statement, it</p>
<p>can be called twice, one without "else" branch, and then maybe one more with "else" branch</p>

    </div>

  </div>








  </div>

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.context.StmtRange" class="doc doc-heading">
        <code>
freetensor.core.context.StmtRange        </code>



<a href="#freetensor.core.context.StmtRange" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Record a set of statement in a program, can be used for custom gradient</p>
<p>Usage:</p>
<pre><code>with StmtRange() as rng:
    # Some statements
</code></pre>
<p><code>StmtRange</code> can be used interleaved with AST scopes. In these cases, you can directly call
<code>__enter__</code> and <code>__exit__</code>. E.g.,</p>
<pre><code>rng = StmtRange()
rng.__enter__()
# Some statements
with VarDef(...)  # Some scopes
    # Some other statements
    rng.__exit__(None, None, None)

</code></pre>




  <div class="doc doc-children">















  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.context.pop_ast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">pop_ast</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.context.pop_ast" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get AST and reset context</p>
<p>Internally used by <code>transformer</code> and tests</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.context.pop_ast_and_user_grads" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">pop_ast_and_user_grads</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.context.pop_ast_and_user_grads" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get AST and reset context. Return an extra list for custom gradients</p>
<p>Set <code>UserGrad</code> for details</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.driver" class="doc doc-heading">
        <code>freetensor.core.driver</code>



<a href="#freetensor.core.driver" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.driver.Driver" class="doc doc-heading">
        <code>
freetensor.core.driver.Driver            (<a class="autorefs autorefs-internal" title="freetensor.core.enable_attach_backward.EnableAttachBackward" href="#freetensor.core.enable_attach_backward.EnableAttachBackward">EnableAttachBackward</a>, <span title="freetensor_ffi.Driver">Driver</span>)
        </code>



<a href="#freetensor.core.driver.Driver" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.driver.Driver.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.driver.Driver.__call__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Set argument, execute the binary code, and collect the returns</p>
<p>If there is only one return value, it is returned directly. Otherwise,
the return values are packed in a ReturnValuesPack</p>
<p>This function will introduce some overhaed handling arguments and return
values. For an accurate execution time measurement, plase call
<code>self.set_args</code> first, then <code>self.time</code>, and finally <code>self.collect_returns</code></p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.driver.Driver.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">native_code</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host_device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cxx_flags</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.driver.Driver.__init__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Compile a program using a backend compiler and load it into memory</p>
<p>This class is for internal use. Please consider using <code>build_binary</code></p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>native_code</strong> (<code>NativeCode</code>) – Native code generated from codegen</p></li>
            <li><p><strong>device</strong> (<code>Optional[freetensor_ffi.Device]</code>) – The device to run the program. If omitted, use the default device
in config</p></li>
            <li><p><strong>cxx_flags</strong> (<code>Sequence[str]</code>) – Additional C++ flags passed to the backend compiler</p></li>
            <li><p><strong>verbose</strong> (<code>bool</code>) – True to print extra infomation</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.driver.Driver.collect_returns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">collect_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always_return_pack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.driver.Driver.collect_returns" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Collect return values from an invocation</p>
<p>Return values must be collect. Otherwise there will be memory leaks</p>
<p>If there is only one return value, it is returned directly. Otherwise,
or if <code>always_return_pack</code> is set, the return values are packed in a
ReturnValuesPack</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.driver.Driver.native_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">native_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.driver.Driver.native_code" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get native code compiled by backend compiler</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.driver.Driver.set_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">set_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span></code>


<a href="#freetensor.core.driver.Driver.set_args" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Set argument for an invocation</p>

    </div>

  </div>





  </div>

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.driver.array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dont_drop_borrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">moved</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.driver.array" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Factory function for Array</p>
<p>This function is preferred over directly calling <code>Array</code>'s constructor, because
it accepts more data format.</p>
<ul>
<li>If <code>data</code> is another FreeTensor <code>Array</code>, the original object will be returned,
with <code>dont_drop_borrow</code> and <code>moved</code> set to new values. If <code>dtype</code> is set and
different from the original data type, the <code>Array</code> will be copied first to convert
the data type.</li>
<li>If <code>data</code> is Numpy <code>Array</code> or PyTorch <code>Tensor</code>, it will be converted to FreeTensor
<code>Array</code>. Memory copy will be avoided in most cases, but it is inevitable if the
data is strided. If <code>dtype</code> is set and different from the original data type, the
<code>Array</code> or <code>Tensor</code> will be copied first to convert the data type.</li>
<li>Otherwise, the data will be treated as an n-dimensional array-like object, and
will be parsed according the rules in NumPy. The data type is also set accordingly,
unless <code>dtype</code> is set.</li>
</ul>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>data</strong> (<code>FreeTensor Array, Numpy Array, PyTorch Tensor, or other array-like objects</code>) – Data to be copied to or borrowed by the new Array object</p></li>
            <li><p><strong>dtype</strong> (<code>ft.DataType or str</code>) – If <code>data</code> is not in <code>dtype</code>, convert it to <code>dtype</code> first before constructing
the <code>Array</code></p></li>
            <li><p><strong>dont_drop_borrow</strong> (<code>bool</code>) – If true, report an error if we have to drop a borrwed data. This flag is set
to true when the Array is cunstructed IMPLICITLY (not by this function) from
a user object by borrowing from it, where users may expect they are acutually
manipulating the their user object, instead of this Array</p></li>
            <li><p><strong>moved</strong> (<code>bool</code>) – If true, it means we do not care about data in this Array any more after the
program runs. Variables with "input-mutable" access type may modify the Array</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.driver.build_binary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">build_binary</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host_device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">cxx_flags</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.driver.build_binary" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Compile a program using a backend compiler and load it into memory</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>code</strong> (<code>Optional[freetensor.core.codegen.NativeCode]</code>) – Native code generated by <code>codegen</code>. If not specified, a partial
function is returned, which can be used as a decorator</p></li>
            <li><p><strong>device</strong> (<code>Optional[freetensor_ffi.Device]</code>) – The device to run the program. If omitted, use the default device
in config</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>cxx_flags</strong> (<code>Sequence[str]</code>) – Additional C++ flags passed to the backend compiler</p></li>
            <li><p><strong>verbose</strong> (<code>bool</code>) – Verbosity level</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Driver or JITTemplate</code> – Return a Driver for the executable if there is no JIT parameters.
Return a JITTemplate that generates a Driver if there is at least one</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.driver.move" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>


<a href="#freetensor.core.driver.move" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Alias for array(data, dont_drop_borrow=False, moved=True)</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.enable_attach_backward" class="doc doc-heading">
        <code>freetensor.core.enable_attach_backward</code>



<a href="#freetensor.core.enable_attach_backward" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.enable_attach_backward.EnableAttachBackward" class="doc doc-heading">
        <code>
freetensor.core.enable_attach_backward.EnableAttachBackward        </code>



<a href="#freetensor.core.enable_attach_backward.EnableAttachBackward" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get backward object (Func, Driver, etc) and other meta data from a forward object</p>
<p>This class is a Mixin Class. It should be inherited BEFORE other base classes in
multiple inheritance.</p>




  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.enable_attach_backward.EnableAttachBackward.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">enable_attach_backward</span><span class="o">.</span><span class="n">EnableAttachBackward</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.enable_attach_backward.EnableAttachBackward.__init__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Forward all arguments to other base classes</p>
<p>In Python, super().<strong>init</strong> calls the next base class in the full inheritance
graph of the final class, not only base classes of BackwardAttachedMixin.
See https://docs.python.org/3/tutorial/classes.html#multiple-inheritance</p>

    </div>

  </div>







  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.expr" class="doc doc-heading">
        <code>freetensor.core.expr</code>



<a href="#freetensor.core.expr" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Facility to build AST expressions</p>
<p>Classes and functions in this module are not only used internally for constructing AST nodes,
and also exposed to users via multi-stage programming</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.AlreadyMadeReduceTo" class="doc doc-heading">
        <code>
freetensor.core.expr.AlreadyMadeReduceTo        </code>



<a href="#freetensor.core.expr.AlreadyMadeReduceTo" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>A single-value type that marks a ReduceTo node is already made, and there is no need to</p>
<p>make another Store node</p>
<p>In standard Python data model, functions like <strong>iadd</strong> returns the modified self, and
<strong>setitem</strong> does a self-assignment. We do the augmenting assignment directly in <strong>iadd</strong>
and return AlreadyMadeReduceTo, so we do not have to Store it again</p>



    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.UndeclaredParam" class="doc doc-heading">
        <code>
freetensor.core.expr.UndeclaredParam        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.expr.UndeclaredParam" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Error type. For error reporting only.</p>




  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.VarRef" class="doc doc-heading">
        <code>
freetensor.core.expr.VarRef            (<span title="freetensor_ffi.FrontendVar">FrontendVar</span>)
        </code>



<a href="#freetensor.core.expr.VarRef" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Variable of FreeTensor</p>
<p>All variables in FreeTensor DSL (declared via <code>Var</code>, created by <code>empty</code> or <code>var</code>,
returned by <code>libop</code>, etc.), and their slices, are <code>VarRef</code> objects. Operations
on <code>VarRef</code> objects generates AST nodes</p>




  <div class="doc doc-children">
















































  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRef.as_reduce_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRef</span><span class="o">.</span><span class="n">as_reduce_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduce_op</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.VarRef.as_reduce_to" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>as_reduce_to(self: freetensor_ffi.FrontendVar, op: freetensor_ffi.ReduceOp, metadata: freetensor_ffi.Metadata, value: freetensor_ffi.Expr, atomic: bool = False) -&gt; freetensor_ffi.Stmt</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRef.as_store" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRef</span><span class="o">.</span><span class="n">as_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.VarRef.as_store" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>as_store(self: freetensor_ffi.FrontendVar, metadata: freetensor_ffi.Metadata, value: freetensor_ffi.Expr) -&gt; freetensor_ffi.Stmt</p>

    </div>

  </div>











  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRef.select" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRef</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.VarRef.select" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Alias for <code>self[..., idx, ...]</code>, where <code>idx</code> is at the <code>dim</code>-th dimension</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRef.select_slice" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRef</span><span class="o">.</span><span class="n">select_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.VarRef.select_slice" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Alias for <code>self[..., begin:end, ...]</code>, where <code>begin:end</code> is at the <code>dim</code>-th dimension</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRef.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRef</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.VarRef.shape" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return lengths of all dimensions or the length of one dimension</p>
<p><code>.shape()</code> -&gt; list of lengths of all dimensions</p>
<p><code>.shape(dim)</code> -&gt; length of dimension <code>dim</code>, where <code>dim</code> can be <code>int</code>
or <code>Expr</code></p>
<p>All lengths can be <code>Expr</code> (if the length is dynamically decided) or
<code>int</code> (if statically decided)</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.VarRefFromVarDef" class="doc doc-heading">
        <code>
freetensor.core.expr.VarRefFromVarDef            (<a class="autorefs autorefs-internal" title="freetensor.core.expr.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a>)
        </code>



<a href="#freetensor.core.expr.VarRefFromVarDef" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>VarRef with extra checks</p>




  <div class="doc doc-children">
















































  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRefFromVarDef.as_reduce_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRefFromVarDef</span><span class="o">.</span><span class="n">as_reduce_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduce_op</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarRefFromVarDef.as_reduce_to" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>as_reduce_to(self: freetensor_ffi.FrontendVar, op: freetensor_ffi.ReduceOp, metadata: freetensor_ffi.Metadata, value: freetensor_ffi.Expr, atomic: bool = False) -&gt; freetensor_ffi.Stmt</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRefFromVarDef.as_store" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRefFromVarDef</span><span class="o">.</span><span class="n">as_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarRefFromVarDef.as_store" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>as_store(self: freetensor_ffi.FrontendVar, metadata: freetensor_ffi.Metadata, value: freetensor_ffi.Expr) -&gt; freetensor_ffi.Stmt</p>

    </div>

  </div>











  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRefFromVarDef.select" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRefFromVarDef</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarRefFromVarDef.select" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Alias for <code>self[..., idx, ...]</code>, where <code>idx</code> is at the <code>dim</code>-th dimension</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRefFromVarDef.select_slice" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRefFromVarDef</span><span class="o">.</span><span class="n">select_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarRefFromVarDef.select_slice" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Alias for <code>self[..., begin:end, ...]</code>, where <code>begin:end</code> is at the <code>dim</code>-th dimension</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarRefFromVarDef.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarRefFromVarDef</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarRefFromVarDef.shape" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return lengths of all dimensions or the length of one dimension</p>
<p><code>.shape()</code> -&gt; list of lengths of all dimensions</p>
<p><code>.shape(dim)</code> -&gt; length of dimension <code>dim</code>, where <code>dim</code> can be <code>int</code>
or <code>Expr</code></p>
<p>All lengths can be <code>Expr</code> (if the length is dynamically decided) or
<code>int</code> (if statically decided)</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.expr.VarVersionRef" class="doc doc-heading">
        <code>
freetensor.core.expr.VarVersionRef            (<a class="autorefs autorefs-internal" title="freetensor.core.expr.VarRef" href="#freetensor.core.expr.VarRef">VarRef</a>)
        </code>



<a href="#freetensor.core.expr.VarVersionRef" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Special VarRef used for custom gradient, generated from <code>mark_version</code></p>




  <div class="doc doc-children">
















































  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarVersionRef.as_reduce_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarVersionRef</span><span class="o">.</span><span class="n">as_reduce_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduce_op</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarVersionRef.as_reduce_to" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>as_reduce_to(self: freetensor_ffi.FrontendVar, op: freetensor_ffi.ReduceOp, metadata: freetensor_ffi.Metadata, value: freetensor_ffi.Expr, atomic: bool = False) -&gt; freetensor_ffi.Stmt</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarVersionRef.as_store" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarVersionRef</span><span class="o">.</span><span class="n">as_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarVersionRef.as_store" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>as_store(self: freetensor_ffi.FrontendVar, metadata: freetensor_ffi.Metadata, value: freetensor_ffi.Expr) -&gt; freetensor_ffi.Stmt</p>

    </div>

  </div>











  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarVersionRef.select" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarVersionRef</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarVersionRef.select" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Alias for <code>self[..., idx, ...]</code>, where <code>idx</code> is at the <code>dim</code>-th dimension</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarVersionRef.select_slice" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarVersionRef</span><span class="o">.</span><span class="n">select_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarVersionRef.select_slice" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Alias for <code>self[..., begin:end, ...]</code>, where <code>begin:end</code> is at the <code>dim</code>-th dimension</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.expr.VarVersionRef.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">VarVersionRef</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.expr.VarVersionRef.shape" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return lengths of all dimensions or the length of one dimension</p>
<p><code>.shape()</code> -&gt; list of lengths of all dimensions</p>
<p><code>.shape(dim)</code> -&gt; length of dimension <code>dim</code>, where <code>dim</code> can be <code>int</code>
or <code>Expr</code></p>
<p>All lengths can be <code>Expr</code> (if the length is dynamically decided) or
<code>int</code> (if statically decided)</p>

    </div>

  </div>






  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.abs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.abs" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Absolute value</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.abs</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The absolute value</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.add" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.add" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs + rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.add</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The sum</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.any" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">any</span><span class="p">()</span></code>


<a href="#freetensor.core.expr.any" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an AnyExpr node (only for testing and type inference)</p>
<p>Any nodes matches any expression nodes in <code>ast.match</code></p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.cast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.cast" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Cast to another type</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
            <li><p><strong>dtype</strong> (<code>DataTypr or str</code>) – The target data type</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ceil" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.ceil" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Round a float up to an interger (towards +inf)</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ceil</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ceildiv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.ceildiv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Ceiling integer division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>The result rounds towards positive infinity</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ceildiv</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The quotient</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.cos" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.cos" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Cosine</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.tanh</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.dtype" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get element data type of a variable</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.eq" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs == rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.eq</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The comparison</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.exp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.exp" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Natural exponent</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.exp</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The exponent</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.floor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.floor" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Round a float down to an interger (towards -inf)</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.floor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.floordiv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.floordiv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Floored integer division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>The result rounds towards negative infinity (following Python convention, instead of C)
This function is recommended over <code>round_towards_0_div</code>, as it enjoys more optimizations</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.floordiv</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The quotient</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.ge" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs &gt;= rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ge</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The comparison</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.gt" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs &gt; rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.gt</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The comparison</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.if_then_else" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">if_then_else</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">then_case</span><span class="p">,</span> <span class="n">else_case</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.if_then_else" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Similar to <code>then_case if cond else else_case</code></p>
<p>NOTE: there is NO guarantee that only one branch will be executed. In some cases,
both branches will be executed and the result of one of them will be picked.
Therefore, please do NOT use <code>if_then_else</code> to guard an out-of-bound array indexing</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>cond</strong> (<code>VarRef of Number</code>) – Condition</p></li>
            <li><p><strong>then_case</strong> (<code>VarRef or Number</code>) – Then-case experssion</p></li>
            <li><p><strong>else_case</strong> (<code>VarRef or Number</code>) – Else-case expression</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.intrinsic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">intrinsic</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ret_type</span><span class="o">=</span><span class="s1">&#39;void&#39;</span><span class="p">,</span> <span class="n">has_side_effect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.intrinsic" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Invoke whatever target code</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>fmt</strong> (<code>str</code>) – What to run. "%" is filled by parameters one by one. E.g. sinf(%). Use "%%" to
escape for "%". If you need two adjacent parameters, type "(%)(%)" or "% %".</p></li>
            <li><p><strong>*params</strong> (<code>Sequence[Expr]</code>) – (Positional variadic) Parameters to <code>fmt</code></p></li>
            <li><p><strong>ret_type</strong> (<code>DataType or str</code>) – (Keyword argument only) The return type. Void for no return type. Defaults to Void</p></li>
            <li><p><strong>has_side_effect</strong> (<code>bool</code>) – (Keyword argument only) True to indicate the intrinsic modifes something other
than the return value. Defaults to false</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.l_and" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">l_and</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.l_and" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Logical and of <code>lhs</code> and <code>rhs</code></p>
<p>NOTE: Short-circuit evaluation is NOT supported</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.l_and</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The logical and</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.l_not" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">l_not</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.l_not" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Logical not</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.l_not</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The logical not</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.l_or" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">l_or</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.l_or" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Logical or of <code>lhs</code> and <code>rhs</code></p>
<p>NOTE: Short-circuit evaluation is NOT supported</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.l_or</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The logical or</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.le" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs &lt;= rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.le</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The comparison</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ln" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.ln" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Natural logarithm</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ln</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The exponent</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.load_at_version" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">load_at_version</span><span class="p">(</span><span class="n">tape_name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="o">*</span><span class="n">indices</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.load_at_version" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an LoadAtVersion node (only for custom gradient)</p>
<p>This node is only used for custom gradient. See <code>UserGradForPrevStmt</code>.</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.lt" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs &lt; rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.lt</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The comparison</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.max" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Maximum of <code>lhs</code> and <code>rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.max</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The maximum</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.min" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.min" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Minimum of <code>lhs</code> and <code>rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.min</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The minimum</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.mod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.mod" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs</code> modulus <code>rhs</code></p>
<p>The result is always non-negative (following Python convention, instead of C).
This function is recommended over <code>remainder</code>, as it enjoys more optimizations</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.mod</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The modulo</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.mtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">mtype</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.mtype" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get memory type of a variable</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.mul" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.mul" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs * rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.mul</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The product</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ndim" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.ndim" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get the number of dimensions of a variable</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.ne" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs != rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.ne</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The comparison</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.remainder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.remainder" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Remainder of <code>lhs</code> dividing <code>rhs</code></p>
<p>The result can be positive or negative (following C convention, instead of Python).
End users are encouraged to use <code>lhs % rhs</code> instead, which follows Python convetion,
and enjoys better optimization in FreeTensor</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.remainder</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The remainder</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.round_towards_0_div" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">round_towards_0_div</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.round_towards_0_div" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>C-style integer division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>The result rounds towards 0 (following C convention, instead of Python)
End users are encouraged to use <code>lhs // rhs</code> instead, which follows Python convetion,
and enjoys better optimization in FreeTensor</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.round_towards_0_div</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The quotient</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.shape" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>shape(var, i): Get size of specified dimension of a variable</p>
<p>shape(var): Get sizes of all dimensions of a variable</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sigmoid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.sigmoid" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Sigmoid</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.sigmoid</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sin" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.sin" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Sine</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.tanh</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sqrt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.sqrt" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Square root</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.sqrt</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The square root</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.square" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.square" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Square</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.square</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The square</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.sub" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.sub" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p><code>lhs - rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.sub</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The difference</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.tan" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.tan" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Tangent</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.tanh</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.tanh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.tanh" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Hyperbolic tangent</p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.tanh</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.truediv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.truediv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Floating point division of <code>lhs</code> dividing by <code>rhs</code></p>
<p>For scalar operands, it emit an expression node in AST. For non-scalar operands,
it calls libop.truediv</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lhs</strong> (<code>VarRef or Number</code>) – The left-hand-side operand</p></li>
            <li><p><strong>rhs</strong> (<code>VarRef or Number</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The quotient</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.expr.unbound" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">unbound</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.expr.unbound" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Explicitly mark a bool expression not to used for boundary analysis and thus</p>
<p>not used for shrinking loops or variables</p>
<p>This is useful when we want to leave a loop length constatnt or regular, and
guard it with a branch, e.g.:</p>
<pre><code>for i = 0 to 100
  if unbound(i &lt; x)
    ...
</code></pre>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>expr</strong> (<code>VarRef or Number</code>) – The bool expression to mark</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef or Number</code> – The marked expression</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.frontend" class="doc doc-heading">
        <code>freetensor.core.frontend</code>



<a href="#freetensor.core.frontend" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A frontend transforming user Python functions to ASTs via staging.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.FreeTensorOverload" class="doc doc-heading">
        <code>
freetensor.core.frontend.FreeTensorOverload            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagingOverload" href="#freetensor.core.staging.StagingOverload">StagingOverload</a>)
        </code>



<a href="#freetensor.core.frontend.FreeTensorOverload" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Helper class managing context in IR staging.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.allow_shortcut_scope" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">allow_shortcut_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allow</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.allow_shortcut_scope" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Opens a scope that allows shortcut control flows in a statically deterministic</p>
<p>context. Need to be closed by <code>with</code> statement.</p>

    </div>

  </div>





  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.assert_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">assert_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.assert_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Assert staging tool.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.assign_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">assign_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.assign_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign wrapper.</p>
<p>If <code>value</code> is instance of <code>StagedAssignable</code>, it's regarded as a customized
assign behavior and gets executed with the assigned target variable name.
This wrapper is used for initializing a variable.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.break_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">break_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.break_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Break staging tool. Only allow break in static control flow.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.continue_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">continue_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.continue_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Continue staging tool. Only allow continue in static control flow.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.custom_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">custom_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.FreeTensorOverload.custom_attr" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized attribute accessor.</p>
<p>The framework first looks for a Python native attribute. If not found, it looks
for this overloaded custom attribute resolver.</p>
<p>The default implementation provides no custom attribute.
Can be overridden by subclasses.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>obj</strong> (<code>Any</code>) – Object to access attribute.</p></li>
            <li><p><strong>attr</strong> (<code>str</code>) – Attribute name.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Any</code> – The attribute value.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.foreach" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.foreach" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized foreach wrapper.</p>
<p>If <code>value</code> is instance of <code>StagedIterable</code>, its regarded as a customized foreach
behavior and used to generate code for the python for loop.
Otherwise, we try to execute the loop as usual.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.fullname" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">fullname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.FreeTensorOverload.fullname" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get distinct name.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.functiondef_wrapper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">functiondef_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.FreeTensorOverload.functiondef_wrapper" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Function definition wrapper.</p>
<p>This wrapper performs extra initialization and cleanup for function definition.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.if_then_else_expr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">if_then_else_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">then_expr</span><span class="p">,</span> <span class="n">else_expr</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.if_then_else_expr" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>If-then-else expression staging tool.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.if_then_else_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">if_then_else_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">then_body</span><span class="p">,</span> <span class="n">else_body</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.if_then_else_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>If-then-else statement staging tool.</p>
<p>When predicate is deterministic in staging, only one branch is generated.
Otherwise, a If node in IR is generated.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.load_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">load_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.load_attr" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Load attribute staging tool. Allows customization of reading attributes.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.mark_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">mark_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.FreeTensorOverload.mark_position" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Code position handler.</p>
<p>Defaults to a no-op. Can be overridden by subclasses.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lineno</strong> (<code>int</code>) – Line number of the next statement.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.FreeTensorOverload.metadata" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metadata handler.</p>
<p>A metadata line is a comment starting with <code>#!</code> and followed by a metadata,
represented as a string parameter.</p>
<p>Defaults to a no-op.
Can be overridden by subclasses.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>content</strong> (<code>str</code>) – The metadata content.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>








  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.return_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">return_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">funcname</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.return_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return staging tool. Only allow return in static control flow.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.unpack_assign_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">unpack_assign_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.unpack_assign_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign wrapper for one or more targets.</p>
<p>If <code>values</code> is instance of <code>StagedUnpackAssignable</code>, it's regarded as a customized
assign behavior and gets executed with all the assigned targets' names. Otherwise,
it calls <code>assign_stmt</code> with each sub-assignments.</p>
<p>Please note that <code>names</code> can be nested tuples like <code>("a", ("b", "c"))</code>.</p>
<p>Please also note that <code>names</code> can also be a single string like "a" even if <code>values</code>
is a tuple. There is no unpacking in this case</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.FreeTensorOverload.while_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">FreeTensorOverload</span><span class="o">.</span><span class="n">while_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpred</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.FreeTensorOverload.while_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>While statement staging tool.</p>

    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.FreeTensorStagingError" class="doc doc-heading">
        <code>
freetensor.core.frontend.FreeTensorStagingError            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagingError" href="#freetensor.core.staging.StagingError">StagingError</a>)
        </code>



<a href="#freetensor.core.frontend.FreeTensorStagingError" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Error occurred during staging function execution (i.e. IR tree generation).</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.LifetimeScope" class="doc doc-heading">
        <code>
freetensor.core.frontend.LifetimeScope        </code>



<a href="#freetensor.core.frontend.LifetimeScope" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>This scope is used to register multiple scopes inside a single lifetime scope.</p>
<p>The inner scopes might be used to register variables, etc.
They will be exited in reverse order of their registration.</p>




  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.PredefinedVarCreator" class="doc doc-heading">
        <code>
freetensor.core.frontend.PredefinedVarCreator            (<a class="autorefs autorefs-internal" title="freetensor.core.frontend.VarCreator" href="#freetensor.core.frontend.VarCreator">VarCreator</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.frontend.PredefinedVarCreator" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">












  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.frontend.PredefinedVarCreator.__class__" class="doc doc-heading">
        <code>
freetensor.core.frontend.PredefinedVarCreator.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.PredefinedVarCreator.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.PredefinedVarCreator.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">PredefinedVarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.PredefinedVarCreator.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.PredefinedVarCreator.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">PredefinedVarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.frontend.PredefinedVarCreator.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.PredefinedVarCreator.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">PredefinedVarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.PredefinedVarCreator.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.PredefinedVarCreator.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">PredefinedVarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.PredefinedVarCreator.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.PredefinedVarCreator.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">PredefinedVarCreator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initializer</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">mtype</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.PredefinedVarCreator.__init__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Initialize self.  See help(type(self)) for accurate signature.</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.PredefinedVarCreator.assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">PredefinedVarCreator</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.PredefinedVarCreator.assign" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign behavior. Creates a VarDef with its full name.</p>

    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.ReversedIterable" class="doc doc-heading">
        <code>
freetensor.core.frontend.ReversedIterable            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagedIterable" href="#freetensor.core.staging.StagedIterable">StagedIterable</a>)
        </code>



<a href="#freetensor.core.frontend.ReversedIterable" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.frontend.ReversedIterable.__class__" class="doc doc-heading">
        <code>
freetensor.core.frontend.ReversedIterable.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.ReversedIterable.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.ReversedIterable.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">ReversedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.ReversedIterable.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.ReversedIterable.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">ReversedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.frontend.ReversedIterable.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.ReversedIterable.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">ReversedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.ReversedIterable.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.ReversedIterable.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">ReversedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.ReversedIterable.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>










  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.UserGrad" class="doc doc-heading">
        <code>
freetensor.core.frontend.UserGrad            (<a class="autorefs autorefs-internal" title="freetensor.core.stmt.UserGradStaged" href="#freetensor.core.stmt.UserGradStaged">UserGradStaged</a>)
        </code>



<a href="#freetensor.core.frontend.UserGrad" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Define a custom gradient</p>
<p>Follow the following steps to define custom gradient:</p>
<ol>
<li>Add some <code>mark_version</code> statements in the program. <code>mark_version('y0', y)</code> marks the specific
versions of variable <code>y</code> <strong>at the program position of the statement</strong> and <strong>at all iterations</strong>
as <code>'y0'</code>.</li>
<li>Add a <code>UserGrad</code> scope.
2.1. <code>UserGrad</code> optionally receives parameter <code>stmt_range</code>, recorded by the <code>StmtRange</code> helper class,
which means the gradient is for the code specified in the range. Ignoring the parameter means setting
gradient for the previous statement of the scope.
2.2. Other parameters of <code>UserGrad</code> sets the mapping from original variables to gradient variables.
<code>with UserGradForPrevStmt(x, y) as (dx, dy)</code> provides <code>VarRef</code> <code>dx</code> and <code>dy</code> as gradient variables
to be used inside the scope.</li>
<li>In order to use the value from the forward pass in the backward pass, do not access the forward
variables directly in the scope. Instead, use <code>load_at_version</code> expressions. <code>load_at_version(y0, i, j)</code>
loads from <code>y[i, j]</code> <strong>at the specific version marked by <code>y0 = mark_version(y)</code></strong>, saved from <strong>the same
iteration in the forward pass</strong>. (If directly writing staged code, it is <code>MarkVersion('y0', y)</code>). In
other words, after AD, the position of <code>mark_version</code> and the dynamic loop iterator together makes up
the actual version number for the tape.</li>
<li>Build the AST with <code>pop_ast_and_user_grads</code> instead of <code>pop_ast</code>. An extra list will be returned
together with the AST, which you need to pass as <code>grad</code>'s <code>user_grads</code> argument. This list records
the forward-to-backward relation of the nodes.</li>
</ol>
<p>If you are directly writing staged code, use <code>UserGradStaged</code> instead.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>*args</strong> (<code>Sequence[freetensor.core.expr.VarRef]</code>) – (Positional variadic) Mapping from original variables to gradient variables</p></li>
            <li><p><strong>stmt_range</strong> (<code>StmtRange</code>) – The range in the original program that we are setting custom gradient for</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>



  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.Var" class="doc doc-heading">
        <code>
freetensor.core.frontend.Var            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagedTypeAnnotation" href="#freetensor.core.staging.StagedTypeAnnotation">StagedTypeAnnotation</a>)
        </code>



<a href="#freetensor.core.frontend.Var" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.frontend.Var.__class__" class="doc doc-heading">
        <code>
freetensor.core.frontend.Var.__class__            (<span title="abc.ABCMeta">ABCMeta</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">





  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h6 id="freetensor.core.frontend.Var.__class__.__base__" class="doc doc-heading">
        <code>
freetensor.core.frontend.Var.__class__.__base__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__class__.__base__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.frontend.Var.__class__.__base__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__class__.__base__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.frontend.Var.__class__.__base__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__class__.__base__.__new__" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.frontend.Var.__class__.__base__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__class__.__base__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.frontend.Var.__class__.__base__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.Var.__class__.__base__.register" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.Var.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>





  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.Var.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">Var</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">atype</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">mtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.Var.__init__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Declare a variable</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>shape</strong> (<code>Sequence[Expr] or Var</code>) – Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></li>
            <li><p><strong>dtype</strong> (<code>str or DataType</code>) – Data type of the variable</p></li>
            <li><p><strong>atype</strong> (<code>str or AccessType</code>) – Access type of the variable. It specifies whether (and how) the variable
is an I/O variable of the function it belongs to. Defaults to "input"</p></li>
            <li><p><strong>mtype</strong> (<code>str or MemType (Optional)</code>) – Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.VarCreator" class="doc doc-heading">
        <code>
freetensor.core.frontend.VarCreator            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagedAssignable" href="#freetensor.core.staging.StagedAssignable">StagedAssignable</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.frontend.VarCreator" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>VarCreator(shape: Union[Sequence, freetensor.core.expr.VarRef], dtype: str, mtype: str, assigned: bool = False)</p>




  <div class="doc doc-children">












  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.frontend.VarCreator.__class__" class="doc doc-heading">
        <code>
freetensor.core.frontend.VarCreator.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.VarCreator.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VarCreator.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.VarCreator.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VarCreator.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.frontend.VarCreator.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VarCreator.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.VarCreator.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VarCreator.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VarCreator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.VarCreator.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>








  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.VarCreator.assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VarCreator</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.VarCreator.assign" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign behavior. Creates a VarDef with its full name.</p>

    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.VersionMarker" class="doc doc-heading">
        <code>
freetensor.core.frontend.VersionMarker            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagedAssignable" href="#freetensor.core.staging.StagedAssignable">StagedAssignable</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.frontend.VersionMarker" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>VersionMarker(var: freetensor.core.expr.VarRef, assigned: bool = False)</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.frontend.VersionMarker.__class__" class="doc doc-heading">
        <code>
freetensor.core.frontend.VersionMarker.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.VersionMarker.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VersionMarker.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VersionMarker</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.VersionMarker.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VersionMarker.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VersionMarker</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.frontend.VersionMarker.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VersionMarker.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VersionMarker</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.VersionMarker.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.VersionMarker.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VersionMarker</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.VersionMarker.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>








  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.VersionMarker.assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">VersionMarker</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tape_name</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.VersionMarker.assign" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign behavior. Creates a MarkVersion with its full name.</p>

    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.frontend.dynamic_range" class="doc doc-heading">
        <code>
freetensor.core.frontend.dynamic_range            (<a class="autorefs autorefs-internal" title="freetensor.core.staging.StagedIterable" href="#freetensor.core.staging.StagedIterable">StagedIterable</a>)
        </code>



<a href="#freetensor.core.frontend.dynamic_range" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Dynamic range that generates For loop in IR tree.</p>




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.frontend.dynamic_range.__class__" class="doc doc-heading">
        <code>
freetensor.core.frontend.dynamic_range.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.frontend.dynamic_range.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.dynamic_range.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.dynamic_range.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.dynamic_range.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.frontend.dynamic_range.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.dynamic_range.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.dynamic_range.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.frontend.dynamic_range.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.dynamic_range.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>





  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.frontend.dynamic_range.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">dynamic_range</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.frontend.dynamic_range.__init__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Initialize a dynamic range.</p>
<p>Arguments semantic identical to builtin <code>range</code>.</p>

    </div>

  </div>







  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.frontend.capture_var" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">capture_var</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.capture_var" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Capture external array as tensor variable.</p>

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.frontend.empty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.empty" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an empty variable</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>shape</strong> (<code>Sequence[Expr] or Var</code>) – Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></li>
            <li><p><strong>dtype</strong> (<code>str or DataType</code>) – Data type of the variable</p></li>
            <li><p><strong>mtype</strong> (<code>str or MemType (Optional)</code>) – Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.frontend.push_for_backward" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">push_for_backward</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.push_for_backward" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Push the current value from the forward pass to be used at the backward pass</p>
<p>This function is for custom gradients. See <code>UserGrad</code> for details on how to provide custom
gradients.</p>
<p>You may imagine there is a virtual stack for each variable. Each time you call <code>x_handle =
push_for_backward(x)</code> in the forward pass, the value of <code>x</code> <strong>at the current iteration</strong>
will be "pushed" to the virtual stack. You can access <code>x_handle</code> at the backward pass. Each
time you access <code>x_handle</code>, you will "pop" the stack and get the value of <code>x</code> <strong>pushed at
the same iteration</strong>. Since the "stack" is virtual, you do NOT need to "pop" the same count
as "push"es: the version numbering is fully automatic. Besides, there may not be a real
stack at runtime: it can be compiled to any data structure.</p>
<p>This function will be staged to <code>mark_version</code> statement in the IR.</p>

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.frontend.var" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#freetensor.core.frontend.var" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an with variable a given initializer</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>initializer</strong> (<code>Sequence[Sequence[...Sequence[Expr]...]]</code>) – (Multi-level of) sequence of expressions. Will be data of the variable</p></li>
            <li><p><strong>shape</strong> (<code>Sequence[Expr] or Var</code>) – Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></li>
            <li><p><strong>dtype</strong> (<code>str or DataType</code>) – Data type of the variable</p></li>
            <li><p><strong>mtype</strong> (<code>str or MemType (Optional)</code>) – Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>










  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.func" class="doc doc-heading">
        <code>freetensor.core.func</code>



<a href="#freetensor.core.func" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.func.Func" class="doc doc-heading">
        <code>
freetensor.core.func.Func            (<a class="autorefs autorefs-internal" title="freetensor.core.enable_attach_backward.EnableAttachBackward" href="#freetensor.core.enable_attach_backward.EnableAttachBackward">EnableAttachBackward</a>, <span title="freetensor_ffi.Func">Func</span>)
        </code>



<a href="#freetensor.core.func.Func" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">

















  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.func.Func.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">Func</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.func.Func.__call__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Enable invoking a transformed AST in another function being transformed, via</p>
<p><code>inlined_invoke</code></p>

    </div>

  </div>








  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.jit" class="doc doc-heading">
        <code>freetensor.core.jit</code>



<a href="#freetensor.core.jit" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.jit.JIT" class="doc doc-heading">
        <code>
freetensor.core.jit.JIT        </code>



<a href="#freetensor.core.jit.JIT" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Declare a function parameter as a JIT parameter</p>
<p>A function with one or more JIT parameters will be compiled to a JIT template. It can
be instantiate after the JIT paraemters are provided</p>
<p>Usage: <code>x: JIT</code> or <code>x: JIT[AnyPythonType]</code>. The latter form has no syntactic meanings,
and is only for documentation.</p>
<p>NOTE 1: The <code>JIT</code> type annotation can only be used for parameter of the outer-most
function intended for <code>@transform</code> (or <code>@optimize</code>, etc). It can NOT be used for inner
functions intended for <code>@inline</code>.</p>
<p>NOTE 2: The <code>JIT</code> type annoation can only annotated on parameters inside the function
signature. It is NOT supported in annotations for statements.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.jit.JITTemplate" class="doc doc-heading">
        <code>
freetensor.core.jit.JITTemplate            (<span title="abc.ABC">ABC</span>)
        </code>



<a href="#freetensor.core.jit.JITTemplate" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>A template that can be instantiated given concrete arguments</p>
<p>By calling <code>instantiate</code> with actual arguments you are expecting to run a JIT function with,
an instantiated object will be returned. Subclasses of <code>JITTemplate</code> should override
<code>instantiate_by_only_jit_args</code>, and define what is actually returned.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>params</strong> (<code>OrderedDict</code>) – Parameter list from inspect.signature(func).parameters</p></li>
            <li><p><strong>jit_param_names</strong> (<code>Sequence</code>) – Sequence of names of JIT parameters in the original order defined in the function</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.jit.JITTemplate.__class__" class="doc doc-heading">
        <code>
freetensor.core.jit.JITTemplate.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.jit.JITTemplate.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.jit.JITTemplate.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.jit.JITTemplate.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.jit.JITTemplate.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.jit.JITTemplate.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.jit.JITTemplate.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.jit.JITTemplate.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.jit.JITTemplate.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.jit.JITTemplate.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.jit.JITTemplate.instantiate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.jit.JITTemplate.instantiate" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get an instance with the arguments you are expecting to run a JIT function with</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.jit.JITTemplate.instantiate_and_call" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">instantiate_and_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.jit.JITTemplate.instantiate_and_call" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get an instance and call it with the arguments you are expecting to run a JIT function with</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.jit.JITTemplate.instantiate_by_only_jit_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">instantiate_by_only_jit_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">jit_args</span><span class="p">)</span></code>


<a href="#freetensor.core.jit.JITTemplate.instantiate_by_only_jit_args" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get an instance with only JIT arguments</p>
<p>This function accpets a tuple of arguments. Keyword arguments is NOT supported, so
memoization can be easier, with considering the order of the arguments.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.jit.JITTemplate.separate_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">JITTemplate</span><span class="o">.</span><span class="n">separate_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.jit.JITTemplate.separate_args" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return a list of non-JIT args, and a list of JIT args</p>

    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.optimize" class="doc doc-heading">
        <code>freetensor.core.optimize</code>



<a href="#freetensor.core.optimize" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.optimize.optimize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backward_schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dynamic_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.core.optimize.optimize" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>An one-click optimization from Python function to binary executable</p>
<p>Usage:</p>
<pre><code>@optimize
def f(...):
    ...
</code></pre>
<p>It is equivalent to:</p>
<pre><code>@build_binary
@codegen
@lower
@transform
def f(...):
    ...
</code></pre>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>Python function or AST</code>) – The user function to optimize. If not specified, a partial function will
be returend, which can be used as a decorator</p></li>
            <li><p><strong>schedule_callback</strong> (<code>Optional[Callable[[freetensor.core.schedule.Schedule], NoneType]]</code>) – Schedule(s) to apply</p></li>
            <li><p><strong>backward_schedule_callback</strong> (<code>Callable[[freetensor.core.schedule.Schedule], NoneType]</code>) – Specify what schedule(s) to do for the backward function, if <code>ast</code> is returned
from AD with <code>attach_backward=True</code>. Defaults to be the same with <code>callback</code></p></li>
            <li><p><strong>target</strong> (<code>Optional[freetensor_ffi.Target]</code>) – The target architecture. You don't have to set target if you set device</p></li>
            <li><p><strong>device</strong> (<code>Optional[freetensor_ffi.Device]</code>) – Where to run the program</p></li>
            <li><p><strong>default_dynamic_range</strong> (<code>bool</code>) – If True, the built-in range is replaced with freetensor.dynamic_range.
Defaults to True</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – Verbosity level. Can be 0, 1 or 2</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.optimize.optimize_to_pytorch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">optimize_to_pytorch</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tapes</span><span class="o">=&lt;</span><span class="n">GradTapeMode</span><span class="o">.</span><span class="n">NoReuseOnly</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">forward_schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backward_schedule_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dynamic_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.core.optimize.optimize_to_pytorch" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Compile a FreeTensor function to a PyTorch call, whose gradient can be</p>
<p>recognized by PyTorch</p>
<p>The compiled function will be a typical PyTorch's "function" (rather than
a PyTorch's "module"). Technically, this means it is a wrapper function
around a PyTorch's <code>Function</code>'s <code>apply</code> method</p>
<p>Schedules (if any) must be applied to the forward function and the backward
function separated. For this reason, currently only first-order gradient
is supported</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>Python function or AST</code>) – The user function to optimize. If not specified, a partial function will
be returend, which can be used as a decorator</p></li>
            <li><p><strong>tapes</strong> (<code>Union[Sequence, freetensor_ffi.GradTapeMode]</code>) – Intermediate variables that need to be stored from the forward pass and
reused in the backward pass. This parameter can be a sequence, which contains
VarDef selectors of them. It can also be a <code>GradTapeMode</code>, then it will determine
which intermediate variables to be stored by heuristics. Avail <code>GradTapeMode</code>s
are: All: store all variables including local scalars; None: store nothing;
NoReuseOnly: store variables that only hold one version of data, which means
we do not have to store each version of them in their history</p></li>
            <li><p><strong>forward_schedule_callback</strong> (<code>Optional[Callable[[freetensor.core.schedule.Schedule], NoneType]]</code>) – Schedule(s) to apply to the forward function</p></li>
            <li><p><strong>backward_schedule_callback</strong> (<code>Optional[Callable[[freetensor.core.schedule.Schedule], NoneType]]</code>) – Schedule(s) to apply to the backward function</p></li>
            <li><p><strong>target</strong> (<code>Optional[freetensor_ffi.Target]</code>) – The target architecture. You don't have to set target if you set device</p></li>
            <li><p><strong>device</strong> (<code>Optional[freetensor_ffi.Device]</code>) – Where to run the program</p></li>
            <li><p><strong>default_dynamic_range</strong> (<code>bool</code>) – If True, the built-in range is replaced with freetensor.dynamic_range.
Defaults to True</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – Verbosity level. Can be 0, 1 or 2</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.param_ret_dict" class="doc doc-heading">
        <code>freetensor.core.param_ret_dict</code>



<a href="#freetensor.core.param_ret_dict" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.param_ret_dict.ParamRetDict" class="doc doc-heading">
        <code>
freetensor.core.param_ret_dict.ParamRetDict        </code>



<a href="#freetensor.core.param_ret_dict.ParamRetDict" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Look an object using either a function parameter or return value's name or position</p>




  <div class="doc doc-children">











  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.param_ret_dict.ParamRetDict.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">param_ret_dict</span><span class="o">.</span><span class="n">ParamRetDict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.param_ret_dict.ParamRetDict.__init__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Either <code>func</code> or (<code>func_name</code> and <code>param_names</code> and <code>return_names</code>) should be provided</p>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.param_ret_dict.Parameter" class="doc doc-heading">
        <code>
freetensor.core.param_ret_dict.Parameter        </code>



<a href="#freetensor.core.param_ret_dict.Parameter" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Alias of a parameter of a function by position instead of by name</p>
<p><code>Parameter(n)</code> represents the n-th parameter (counted from 0)</p>
<p><code>Parameter()</code> can be used if there is only one parameter</p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.param_ret_dict.Return" class="doc doc-heading">
        <code>
freetensor.core.param_ret_dict.Return        </code>



<a href="#freetensor.core.param_ret_dict.Return" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Alias of a return value of a function by position instead of by name</p>
<p><code>Return(n)</code> represents the n-th return value (counted from 0)</p>
<p><code>Return()</code> can be used if there is only one return value</p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.passes" class="doc doc-heading">
        <code>freetensor.core.passes</code>



<a href="#freetensor.core.passes" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.passes.lower" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">passes</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">ast</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_passes</span><span class="o">=</span><span class="p">[],</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.core.passes.lower" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Lower an AST using a series of passes</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>ast</strong> (<code>AST</code>) – The AST to be lowered. Can be a <code>Func</code> or a <code>Stmt</code>. If not specified, a
partial function of <code>lower</code> will be returned, which can be used as a
decorator</p></li>
            <li><p><strong>target</strong> (<code>Optional[freetensor_ffi.Target]</code>) – Lower the AST to a target with target-specific passes, then the AST can
be used for codegen. If not set, use the default Target in Config</p></li>
            <li><p><strong>skip_passes</strong> (<code>Sequence[str]</code>) – Skip some pass for testing or debugging. Names in <code>skip_passes</code> are in
underscore_style, as in Python. Please note that some passes will not be
skipped even specified in these parameter, because they are indirectly
called in some other passes</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – 0 = print nothing. 1 = print the lowered AST. 2 = print AST after every
single passes</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func or JITTemplate</code> – Return a Func for an AST if there is no JIT parameters. Return a JITTemplate
that generates a Func if there is at least one</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.return_values_pack" class="doc doc-heading">
        <code>freetensor.core.return_values_pack</code>



<a href="#freetensor.core.return_values_pack" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.return_values_pack.ReturnValuesPack" class="doc doc-heading">
        <code>
freetensor.core.return_values_pack.ReturnValuesPack        </code>



<a href="#freetensor.core.return_values_pack.ReturnValuesPack" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Hold return values from a Driver invocation</p>
<p>Return values can be retrieved in an anonymous manner: <code>x, y, z = pack</code>,
or in a named manner: <code>pack['x']</code></p>
<p>Please note that a ReturnValuesPack is different from a OrderedDict, as
OrderedDict unpacks to keys rather than values</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.return_values_pack.ReturnValuesPack.__contains__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">return_values_pack</span><span class="o">.</span><span class="n">ReturnValuesPack</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.return_values_pack.ReturnValuesPack.__contains__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Test if a return value exists</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.return_values_pack.ReturnValuesPack.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">return_values_pack</span><span class="o">.</span><span class="n">ReturnValuesPack</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.return_values_pack.ReturnValuesPack.__getitem__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get a return value with a name. Tuple is supported for multiple values</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.return_values_pack.ReturnValuesPack.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">return_values_pack</span><span class="o">.</span><span class="n">ReturnValuesPack</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.return_values_pack.ReturnValuesPack.__iter__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get all return values in the order declared in Func</p>

    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.schedule" class="doc doc-heading">
        <code>freetensor.core.schedule</code>



<a href="#freetensor.core.schedule" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.schedule.IDMap" class="doc doc-heading">
        <code>
freetensor.core.schedule.IDMap        </code>



<a href="#freetensor.core.schedule.IDMap" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>A dict-like container recording an ID-to-ID mapping, representing what IDs</p>
<p>become what IDs after a schedule</p>
<p>An IDMap can be looked up by numerical ID, or by Stmt instances or Selector
strings of the original (before applying schedule) AST</p>




  <div class="doc doc-children">















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.schedule.Schedule" class="doc doc-heading">
        <code>
freetensor.core.schedule.Schedule            (<span title="freetensor_ffi.Schedule">Schedule</span>)
        </code>



<a href="#freetensor.core.schedule.Schedule" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.as_matmul" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">as_matmul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">,</span> <span class="n">mode</span><span class="o">=&lt;</span><span class="n">AsMatMulMode</span><span class="o">.</span><span class="n">KeepMemLayout</span><span class="p">:</span> <span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.as_matmul" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Transform nested loops to be a external call to a matrix multiplication</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – ID of the loop</p></li>
            <li><p><strong>allow_var_reorder</strong> (<code>bool</code>) – If true, automatically try calling <code>var_reorder</code> to eanble <code>as_matmul</code></p></li>
            <li><p><strong>mode</strong> (<code>AsMatMulMode</code>) – What to do if the memory layout does not meet the requirement from the
external library. <code>KeepMemLayout</code> =&gt; Raise an exception. <code>TryVarReorder</code>
=&gt; try <code>var_reorder</code> on some variables, but may affect performance of
other use of these variable. <code>TryTranspose</code> =&gt; try <code>cache</code> and then
<code>var_reorder</code> on some variables, but will incur extra overhead.</p></li>
            <li><p><strong>target</strong> (<code>Target</code>) – Hardware target. If omitted, use the default target in config, or the
target set by <code>with</code> scopes.</p></li>
            <li><p><strong>backend</strong> (<code>Union[str, freetensor_ffi.MatMulBackend]</code>) – Backend library. Defaults to "mkl" for CPU targets, "cublas" for GPU
targets.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loop cannot be transformed to be a matrix multiplication</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.ast" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">ast</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.ast" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get the scheduled AST without function signature</p>
<p>This is mainly for debugging and testting purpose</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_fission_fuse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_fission_fuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_fission_fuse" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically fuse consecutive loops or vice versa using</p>
<p>some heuristics</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_inline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_inline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_inline" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically inline very-small VarDef nodes</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_mem_layout" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_mem_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_mem_layout" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically adjust memory layout of variables</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_parallelize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_parallelize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_parallelize" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically parallelize some loops using some heuristics</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_pluto" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_pluto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_pluto" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically apply pluto-based schedules</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_schedule" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_schedule" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatic scheduling using some heuristics</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_set_mem_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_set_mem_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_set_mem_type" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically set memory types using some heuristics</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_swap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_swap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_swap" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically swap statements to enable more fission or</p>
<p>fusion</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_unroll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_unroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_unroll" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically unroll loops using some heuristics</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.auto_use_lib" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">auto_use_lib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.auto_use_lib" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>(Experimental) Automatically use external libs using some heuristics</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>target</strong> (<code>Target</code>) – Target architecture</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.blend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.blend" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Unroll a loop and interleave statements from each iteration</p>
<p>E.g.</p>
<pre><code>for i = 0 to 2 {
f(i);
g(i);
}
</code></pre>
<p>will be transformed to be</p>
<pre><code>f(0);
f(1);
g(0);
g(1);
</code></pre>
<p>Virtual threads in TVM can be implemented via blend</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – The loop being transformed</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loop is not found, the loop length is not a constant, or
the dependences cannot be solved</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.cache" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stmt</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">mtype</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.cache" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Cache a variable into a new local variable</p>
<p>All needed data will be filled into the cache first, then all reads and
writes will be directed to the cache, and finally all needed data will be
flushed from the cache</p>
<p>Note for reduction: This transformation preserves the computation order.
It will transform</p>
<pre><code>a += x
a += y
</code></pre>
<p>to</p>
<pre><code>a.cache = a + x + y
a = a.cache
</code></pre>
<p>If you need a "real" cache for reduction, which reorders the computation,
use <code>cache_reduction</code> instead</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>stmt</strong> (<code>str, ID or Stmt</code>) – The statement or block (e.g. an If or a For) to be modified</p></li>
            <li><p><strong>var</strong> (<code>str</code>) – Name of the variable to be cached</p></li>
            <li><p><strong>mtype</strong> (<code>MemType</code>) – Where to cache</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the ID or name is not found</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(ID, ID, ID, ID)</code> – (ID of the statement that fills the cache, ID of the statement that
flushes from the cache, name of the cache variable, ID of the VarDef
node of the cache variable)</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.cache_reduction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">cache_reduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stmt</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">mtype</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.cache_reduction" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Perform local reductions (e.g. sum) in a local variable first, and then</p>
<p>reduce the local result to the global variable</p>
<p>E.g.</p>
<pre><code>a += x
a += y
</code></pre>
<p>will be transformed to be</p>
<pre><code>a.cache = x + y
a += a.cache
</code></pre>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>stmt</strong> (<code>str, ID or Stmt</code>) – The statement or block (e.g. an If or a For) to be modified</p></li>
            <li><p><strong>var</strong> (<code>str</code>) – Name of the variable to be cached. Only reductions are allowed on
<code>var</code> in <code>stmt</code>. Plain reads or writes are not allowed</p></li>
            <li><p><strong>mtype</strong> (<code>MemType</code>) – Where to cache</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the ID or name is not found, or there are unsupported reads or
writes</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(ID, ID, ID, ID)</code> – (ID of the statement that initialize the cache, ID of the statement
that reduces the local result to the global result, name of the
cache variable, ID of the VarDef node of the cache variable)</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.fission" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">fission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">allow_enlarge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.fission" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Fission a loop into two loops each containing part of the statements, one</p>
<p>followed by another</p>
<p>To split loop into two nested loops, use <code>split</code> instead</p>
<p>Statements inside the original loop will be distributed to one or both
(happening if they are scope statements) loops. If a statement is
originally labeled "S", it can be selected by "<span class="arithmatex">\(fission.0{S}" (from the
first loop) or "\)</span>fission.1{S}" (from the second loop) after fission. If
one of the resulting loop has an empty body, it will be removed</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – The loop to be fissioned</p></li>
            <li><p><strong>side</strong> (<code>FissionSide</code>) – If <code>After</code>, <code>splitter</code> is the last statement of the first loop. If <code>Before</code>,
<code>splitter</code> is the first statement of the second loop</p></li>
            <li><p><strong>splitter</strong> (<code>str (Selector string), ID, Stmt, or list of them</code>) – Where to fission the loop. If multiple statement are selected, fission the
look before or after all of them</p></li>
            <li><p><strong>allow_enlarge</strong> (<code>bool</code>) – If True, try to avoid dependence by enlarging some <code>VarDef</code> nodes. If False,
raise <code>InvalidSchedule</code> in such cases.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if any dependence cannot be resolved</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(IDMap, IDMap)</code> – ({old ID -&gt; new ID in 1st loop}, {old ID -&gt; new ID in 2nd loop}). If a loop
is removed because it has an empty body, it will not be in the returned map</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.fork" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.fork" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>fork(self: freetensor_ffi.Schedule) -&gt; freetensor_ffi.Schedule</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.func" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.func" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Get the scheduled function</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.fuse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">fuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop0</span><span class="p">,</span> <span class="n">loop1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.fuse" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Fuse two directly following loops with the same length into one</p>
<p>To merge nested loops into one, use <code>merge</code> instead</p>
<p><code>parallelize</code>, <code>unroll</code> and <code>vectorize</code> properties will be reset on the
fused loop</p>
<p>Suppose the original loops are labeled "L1" and "L2", the fused loop can
be selected by "$fuse{L1, L2}"</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop0</strong> (<code>str, ID or Stmt</code>) – The leading loop</p></li>
            <li><p><strong>loop1</strong> (<code>str, ID or Stmt, Optional</code>) – The following loop. If omitted, it will try to find a following loop
of <code>loop0</code></p></li>
            <li><p><strong>strict</strong> (<code>bool</code>) – False by default. If set to True, throw an error if unable to determine whether the two loops
are of the same length</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the two loops are not directly following, the two loops are not of
the same length, or there is any dependence cannot be resolved</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>ID</code> – ID of the result loop</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.inline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">inline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.inline" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Remove a variable. When the variable is used, recompute its value</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – The VarDef statement of the specific variable. It can not be an
I/O varible</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the variable cannot be completely removed</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.merge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop1</span><span class="p">,</span> <span class="n">loop2</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.merge" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Merge two directly nested loops into one</p>
<p>To fuse consecutive loops, use <code>fuse</code> instead</p>
<p><code>parallelize</code>, <code>unroll</code> and <code>vectorize</code> properties will be reset on the
merged loop</p>
<p>Suppose the original loops are labeled "L1" and "L2", the merged loop can
be selected by "$merge{L1, L2}"</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop1, loop2</strong> (<code>str, ID or Stmt</code>) – loops to be merged, can be in any order</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loops are not directly nested</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>ID</code> – ID of the merged loop</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.move_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stmt</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.move_to" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Move a statement to a new position</p>
<p>This is a composite schedule command, which is implemented with other
commands</p>
<p>If moving a statement out of some loops, identical loops will be added
around the moved statement, which is equivalent to fission these loops</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>stmt</strong> (<code>str, ID or Stmt</code>) – The statement to be moved</p></li>
            <li><p><strong>side</strong> (<code>MoveToSide</code>) – Whether <code>stmt</code> will be BEFORE or AFTER `dst</p></li>
            <li><p><strong>dst</strong> (<code>str (Selector string), ID, Stmt, or list of them</code>) – Insert <code>stmt</code> to be directly after this statement. If multiple
statements are selected, move to before or after all of them</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if there is no feasible path to move</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(ID, ID)</code> – (The new ID of the moved statement, The out-most newly introduced
statments including the added loops)</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.parallelize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">,</span> <span class="n">parallel</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.parallelize" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Mark a loop with a parallel implementation</p>
<p>This schedule follows a fork-join model: multiple workers (abstract
threads) are created (but physically the threads may be cached in a
thread pool) when the loop begins, do their jobs in parallel, and join
when the loop ends</p>
<p>OpenMP threads follow a typical fork-join model. CUDA threads run in a
bulk-synchronous parallel (BSP) model, which can also be mimiked by the
fork-join model: All threads start when the kernel get launched, but they
only begin to do their jobs when the parallel loop begins. Nevertheless,
the fork-join model needs the following extension to fully mimic a BSP
model:</p>
<p>Taking CUDA as an example, we allow binding a loop to <code>threadIdx.x</code>
inside another loop bound to <code>threadIdx.x</code>, which is illegal in a classic
fork-join model. For example, we may implement a matmul with
collaborative fetch as below:</p>
<pre><code>for i : threadIdx.x  # Li
  for j : threadIdx.y  # Lj
    local_sum = 0  # In gpu/local memory, unique to (i, j)
    for k0  # Lk0
      for k : threadIdx.y  # Lk1_a
        A_cache[k] = A[i, k]  # In gpu/shared, shared by different j
      for k : threadIdx.x  # Lk1_b
        B_cache[k] = B[k, j]  # In gpu/shared, shared by different i
      for k  # Lk1_c
        sum += A_cache[k] * B_cache[k]
    C[i, j] = local_sum
</code></pre>
<p>A seemingly plausible solution to avoid this extension is to reorder
<code>Lk0</code> to outer-most, and then move <code>Lk1_a</code> and <code>Lk1_b</code> out of <code>Li</code> or
<code>Lj</code>. This resolves the nested <code>threadIdx.x</code> and <code>threadIdx.y</code> binding
problem by running <code>Li+Lk1_a</code>, <code>Lj+Lk1_b</code> and <code>Li+Lj</code> interleavingly,
instead of running <code>Lk1_a</code> and <code>Lk1_b</code> inside <code>Li+Lj</code>. However, this
approach is illegal, because the local variable <code>local_sum</code> can no longer
be kept inside the body of <code>Li</code> and <code>Lj</code>: It has to be reused across
multiple runs of <code>Li</code> and <code>Lj</code></p>
<p>Please also note that we can bind one <code>threadIdx.x</code> to two loops only
when the body statement is loop-invariant to one of them. For example,
the following binding is still illegal, even in our extended fork-join
model, because it violates its serial semantics:</p>
<pre><code>for i : threadIdx.x
  for j : threadIdx.x
    A[i, j] ++
</code></pre>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – The loop</p></li>
            <li><p><strong>parallel</strong> (<code>ParallelScope</code>) – Parallel scope</p></li>
            <li><p><strong>allow_reduction</strong> (<code>bool</code>) – If false, raise InvalidSchedule if this schedule would introduce a
parallel reduction</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loop is not found or unable to be parallelized</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.parallelize_as" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">parallelize_as</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nest</span><span class="p">,</span> <span class="n">reference</span><span class="p">,</span> <span class="n">vardef</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.parallelize_as" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Parallelize a loop nest according to another loop nest to keep a tensor</p>
<p>thread-local</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>nest</strong> (<code>str, ID or Stmt</code>) – The loop nest to be parallelized. The ID can be of any statement type,
and all statements it contains will be parallelized.</p></li>
            <li><p><strong>reference</strong> (<code>str, ID or Stmt</code>) – The loop nest to be referenced. The ID can be of any statement type,
and all statements it contains will be referenced.</p></li>
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – The VarDef statement of the tensor to be kept thread-local.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if any of the ID is not found, or the reference loop nest is already
thread-non-local.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.permute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loops</span><span class="p">,</span> <span class="n">transform_func</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.permute" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Permute perfectly nested loops (directly nested loops without statements</p>
<p>in between) with the given loop space transformation function</p>
<p>The transformed loops follow ascending lexical order of the transformed
terms returned by <code>transformFunc</code> when called with original iteration</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loops</strong> (<code>array like of str, ID or Stmt</code>) – the list of perfectly nested loops to be permuted</p></li>
            <li><p><strong>transform_func</strong> (<code>Callable[[Expr], Expr]</code>) – the loop space transformation function, should be bijective</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>list of ID</code> – the list of IDs of permuted loops</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.pluto_fuse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">pluto_fuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop0</span><span class="p">,</span> <span class="n">loop1</span><span class="p">,</span> <span class="n">nest_level_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nest_level_1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fusable_overlap_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fusable_nonoverlap_tolerance</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">do_simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.pluto_fuse" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Use Pluto+ algorithm to permute and fuse two loops, with as most parallelizable</p>
<p>loops as possible at outermost levels.
The two loops are required to be consequent; all directly nested levels are
detected and subject to permutation. Remaining levels that cannot be fused are
left inside the fused loops as two statements</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop0</strong> (<code>str, ID or Stmt</code>) – The first loop to fuse</p></li>
            <li><p><strong>loop1</strong> (<code>str, ID or Stmt</code>) – The second loop to fuse</p></li>
            <li><p><strong>nest_level_0</strong> (<code>int</code>) – The number of nesting levels of loop 0 to be considered, defaults to maximum
possible</p></li>
            <li><p><strong>nest_level_1</strong> (<code>int</code>) – The number of nesting levels of loop 1 to be considered, defaults to maximum
possible</p></li>
            <li><p><strong>fusable_overlap_threshold</strong> (<code>int</code>) – The minimum overlapping size of two loops to be regarded fusable. Defaults
to 1</p></li>
            <li><p><strong>fusable_nonoverlap_tolerance</strong> (<code>int</code>) – The maximum non-overlapping size at either side of two loops to be regarded
fusable. Defaults to 4</p></li>
            <li><p><strong>do_simplify</strong> (<code>bool</code>) – Whether the result is simplified by the way, defaults to true</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loops are not consequent</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(ID, int)</code> – The ID of fused loop and level of parallelizable loops</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.pluto_permute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">pluto_permute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">,</span> <span class="n">nest_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">do_simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.pluto_permute" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Use Pluto+ algorithm to permute a single loop, with as most parallelizable loops</p>
<p>as possible at outermost levels.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – The loop to permute</p></li>
            <li><p><strong>nest_level</strong> (<code>int</code>) – The number of nesting levels to be considered, defaults to maximum possible</p></li>
            <li><p><strong>do_simplify</strong> (<code>bool</code>) – Whether the result is simplified by the way, defaults to true</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(ID, int)</code> – The ID of permuted loop and level of parallelizable loops</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.reorder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">mode</span><span class="o">=&lt;</span><span class="n">ReorderMode</span><span class="o">.</span><span class="n">PerfectOnly</span><span class="p">:</span> <span class="mi">0</span><span class="o">&gt;</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.reorder" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Reorder directly nested loops</p>
<p>To swap consecutive loops, use <code>swap</code> instead</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>order</strong> (<code>array like of str, ID or Stmt</code>) – Vector of loops. The requested order of the loops</p></li>
            <li><p><strong>mode</strong> (<code>ReorderMode</code>) – How to deal with imperfectly nested loops. <code>PerfectOnly</code> =&gt; raise an
exception. <code>MoveOutImperfect</code> =&gt; do <code>fission</code> in advance to move out
statements between the loops, which may enlarge intermediate tensors.
<code>MoveInImperfect</code> =&gt; move statements between the loops inwards after
adding gurads them them, which may hurt parallelism</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the input is invalid or there are breaking dependences</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.separate_tail" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">separate_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">noDuplicateVarDefs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.separate_tail" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Seperate main iterations and tail iterations of a loop</p>
<p>E.g.</p>
<pre><code>for i = 0 -&gt; 3 {
  for j = 0 -&gt; 4 {
     if (i * 4 + j &lt; 10) {
       ...
     }
  }
}
</code></pre>
<p>Each loop will be separated into 2 parts: the body and the tail. After
simplification, the program will finally be transformed to</p>
<pre><code>for i = 0 -&gt; 2 {
  for j = 0 -&gt; 4 {
    ...
  }
}
for j = 0 -&gt; 2 {
  ...
}
</code></pre>
<p>Ideally, all programs can benefit from this schedule. However, this
schedule may greatly increase the program size and make the compiling
time way too long. Therefore, this transformation is implemented as a
schedule, which can be applied optionally. (TODO: Optionally apply this
schedule to part of the program)</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>noDuplicateVarDefs</strong> (<code>bool</code>) – If there is two VarDef nodes in two branches, it may result in doubled
memory use, since different thread may go to different branch.
Set this parameter to true to stop duplicating VarDef nodes.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.set_mem_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">set_mem_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">,</span> <span class="n">mtype</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.set_mem_type" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Change where a variable is stored</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – ID of the VarDef statement of the specific variable</p></li>
            <li><p><strong>mtype</strong> (<code>MemType</code>) – Where the variable should be stored</p></li>
            <li><p><strong>rejectIndirectAccess</strong> (<code>bool</code>) – Registers usually do not support indirect access. If a variable is
accessed indirectly, setting it to use registers is meaningless even
successful. If this parameter is set to true, throw an exception if
the variable being set is accessed indirectly. Specifically, two types
of access are considered indirect: 1) The index is a load from another
variable, or 2) The index is a loop iterator and the loop has a
dynamic length (which can not be unrolled by a backend compiler). By
default, this parameter is determined automatically by <code>mtype</code>.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the variable is not found, or if rejecting an indirect access</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">factor</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nparts</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.split" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Split a loop into two nested loops</p>
<p>To fission a loop into two consecutive loops, use <code>fission</code> instead</p>
<p>Two modes are provided:</p>
<ol>
<li>Specify <code>factor</code> and leave <code>nparts</code> to -1. It will result in an outer
loop with length <code>ceil(n / factor)</code>, and an inner loop with length
<code>factor</code>, where <code>n</code> is the original loop length added by <code>shift</code>. The
original iterator <code>i</code> will be transformed to <code>i0 * factor + i1</code>, where
<code>i0</code> and <code>i1</code> are the iterators of the new outer and inner loops,
respectively</li>
<li>Specify <code>nparts</code> and leave <code>factor</code> to -1. It will result in an
outer loop with length <code>nparts</code>, and an inner loop with length <code>ceil(n /
nparts)</code>, where <code>n</code> is the original loop length added by <code>shift</code>. The
original iterator <code>i</code> will be transformed to <code>i0 * ceil(n / nparts) +
i1</code>, where <code>i0</code> and <code>i1</code> are the iterators of the new outer and inner
loops, respectively</li>
</ol>
<p>Please note that the second mode will introduce an <code>i0 * ceil(n /
nparts)</code> factor into the program, which cannot be recognized by
polyhedral analysis, which may hinder some following schedules. If
possible, plese use the first mode, and then reorder the inner and outer
loops</p>
<p>Suppose the original loop is labeled "L", the split two loops can be
selected by "<span class="arithmatex">\(split.0{L}" (the outer loop) and "\)</span>split.1{L}" (the inner
loop). If one of the resulting loop is proved to have only a single
iteration, it will be removed</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>node</strong> (<code>str, ID or Stmt</code>) – The loop to be split</p></li>
            <li><p><strong>factor</strong> (<code>int</code>) – Length of the inner loop. Set to -1 if using <code>nparts</code></p></li>
            <li><p><strong>nparts</strong> (<code>int</code>) – Length of the outer loop. Set to -1 if using <code>factor</code></p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loop is not found</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>(Optional[ID], Optional[ID])</code> – (outer loop ID, inner loop ID), either ID can be None if the loop is
proved to have only a single iteration</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.swap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.swap" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Swap statements in the same block</p>
<p>To reorder nested loops, use <code>reorder</code> instead</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>order</strong> (<code>List[str (Selector string), ID, List[ID], Stmt, or List[Stmt]]</code>) – The statements. If one item of the <code>order</code> list contains multiple
statements, the <code>order</code> list will be flattened</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the statements are not found or the dependences cannot be solved</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.unroll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">unroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">,</span> <span class="n">immediate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.unroll" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Unroll a loop</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – ID of the loop</p></li>
            <li><p><strong>immediate</strong> (<code>bool</code>) – If false (by default), postpone the unroll procedure to the backend
compiler, which saves scheduling time. If true, unroll the loop
immediately, which may help further simplifications based on the
unrolled result. If your purpose is just to fill the instruction cache,
set it to false. If you are unrolling a loop that computes array indices,
set it to true</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the loop is not found or length of the loop is not a constant</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.var_merge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">var_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.var_merge" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Merge two dimensions of a variable</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – ID of the VarDef statement of the specific variable</p></li>
            <li><p><strong>dim</strong> (<code>int</code>) – Merge the <code>dim</code>-th and the <code>(dim + 1)</code>-th dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.var_reorder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">var_reorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.var_reorder" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Reorder the dimensions of a variable</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – ID of the VarDef statement of the specific variable</p></li>
            <li><p><strong>order</strong> (<code>array like of str, ID or Stmt</code>) – Vector of integers. The new order of the dimensions</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the variable or the order is illegal</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.var_split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">var_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">factor</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nparts</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.var_split" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Split a dimension of a variable into two</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – ID of the VarDef statement of the specific variable</p></li>
            <li><p><strong>dim</strong> (<code>int</code>) – which dimension to be split</p></li>
            <li><p><strong>mode</strong> (<code>VarSplitMode</code>) – When the dimension to split is not divisible by <code>factor</code> or <code>nparts</code>,
the resulting shape may become larger. In <code>FixedSize</code> mode, the actual
buffer size will not be changed, and gurads will be added to prevent
out-of-bound accesses. In <code>RelaxedSize</code> mode, the buffer size may
increase. The <code>RelaxedSize</code> mode cannot be applied to I/O variables</p></li>
            <li><p><strong>factor</strong> (<code>int</code>) – Length of the inner (higher no.) dimension. Set to -1 if using <code>nparts</code></p></li>
            <li><p><strong>nparts</strong> (<code>int</code>) – Length of the outer (lower no.) loop. Set to -1 if using <code>factor</code></p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the variable or the dimension is not found</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.var_squeeze" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">var_squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.var_squeeze" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Remove a singleton (1-lengthed) dimension from a variable</p>
<p>This is a utility schedule, which can be used together with <code>var_split</code>,
<code>var_merge</code> and/or <code>var_reorder</code> to transform a variable to a desired
shape.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – ID of the VarDef statement of the specific variable</p></li>
            <li><p><strong>dim</strong> (<code>int</code>) – Remove the <code>dim</code>-th dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the variable is not found or the dimension is illegal</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.var_unsqueeze" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">var_unsqueeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vardef</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.var_unsqueeze" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Insert a singleton (1-lengthed) dimension to a variable</p>
<p>This is a utility schedule, which can be used together with <code>var_split</code>,
<code>var_merge</code> and/or <code>var_reorder</code> to transform a variable to a desired
shape.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>vardef</strong> (<code>str, ID or Stmt</code>) – ID of the VarDef statement of the specific variable</p></li>
            <li><p><strong>dim</strong> (<code>int</code>) – Insert a singleton dimension at the <code>dim</code>-th dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the variable is not found or the dimension is illegal</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.schedule.Schedule.vectorize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">Schedule</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.Schedule.vectorize" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Vectorize a loop</p>
<p>Please note that, as vectorization is different from architecture to
achitecture, the scheduler may or may not postpone it to the backend
compiler. The vectorization is a best-effort schedule</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>loop</strong> (<code>str, ID or Stmt</code>) – ID of the loop</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>InvalidSchedule</code> – if the ID or name is not found, or the dependence requirement is
not met</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.schedule.schedule" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">ast</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backward_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.core.schedule.schedule" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Apply any schedule on an AST through a user callback</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>ast</strong> (<code>Func or Stmt</code>) – The AST to schedule. If not specified, a partial function will be
returned that cna be used as a decorator</p></li>
            <li><p><strong>callback</strong> (<code>Callable[[freetensor.core.schedule.Schedule], NoneType]</code>) – Specify what schedule(s) to do in this callback</p></li>
            <li><p><strong>backward_callback</strong> (<code>Callable[[freetensor.core.schedule.Schedule], NoneType]</code>) – Specify what schedule(s) to do for the backward function, if <code>ast</code> is returned
from AD with <code>attach_backward=True</code>. Defaults to be the same with <code>callback</code></p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – 0 = print nothing. 1 = print the final AST. 2 = print an AST after
each schedule</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func or JITTemplate</code> – Return a Func for an AST if there is no JIT parameters. Return a JITTemplate
that generates a Func if there is at least one</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>




  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.staging" class="doc doc-heading">
        <code>freetensor.core.staging</code>



<a href="#freetensor.core.staging" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A staging framework to support the FreeTensor frontend.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.AllowShortcutScope" class="doc doc-heading">
        <code>
freetensor.core.staging.AllowShortcutScope        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.staging.AllowShortcutScope" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Allow return scope.</p>
<p>This is a context manager that allows return in statically deterministic control
flow.</p>




  <div class="doc doc-children">


















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.BreakException" class="doc doc-heading">
        <code>
freetensor.core.staging.BreakException            (<span title="Exception">Exception</span>)
        </code>



<a href="#freetensor.core.staging.BreakException" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Exception to be raised by StagingOverload.break_stmt.</p>
<p>Breaks from a for loop.</p>



    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.ContinueException" class="doc doc-heading">
        <code>
freetensor.core.staging.ContinueException            (<span title="Exception">Exception</span>)
        </code>



<a href="#freetensor.core.staging.ContinueException" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Exception to be raised by StagingOverload.continue_stmt.</p>
<p>Continues a for loop.</p>



    </div>

  </div>





  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.ReplaceAnnotations" class="doc doc-heading">
        <code>
freetensor.core.staging.ReplaceAnnotations            (<span title="ast.NodeTransformer">NodeTransformer</span>)
        </code>



<a href="#freetensor.core.staging.ReplaceAnnotations" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.ReplaceAnnotations.generic_visit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">ReplaceAnnotations</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.ReplaceAnnotations.generic_visit" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Called if no explicit visitor function exists for a node.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.ReplaceAnnotations.visit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">ReplaceAnnotations</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.ReplaceAnnotations.visit" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Visit a node.</p>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.ReturnException" class="doc doc-heading">
        <code>
freetensor.core.staging.ReturnException            (<span title="Exception">Exception</span>)
        </code>



<a href="#freetensor.core.staging.ReturnException" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Exception to be raised by StagingOverload.return_stmt.</p>
<p>Holds a return value that will be passed through to the function wrapper.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagedAssignable" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedAssignable            (<span title="abc.ABC">ABC</span>)
        </code>



<a href="#freetensor.core.staging.StagedAssignable" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.staging.StagedAssignable.__class__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedAssignable.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedAssignable.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedAssignable.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedAssignable.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedAssignable.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.staging.StagedAssignable.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedAssignable.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedAssignable.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedAssignable.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagedAssignable.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagedIterable" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedIterable            (<span title="abc.ABC">ABC</span>)
        </code>



<a href="#freetensor.core.staging.StagedIterable" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.staging.StagedIterable.__class__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedIterable.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedIterable.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedIterable.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedIterable.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedIterable.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.staging.StagedIterable.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedIterable.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedIterable.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedIterable.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedIterable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagedIterable.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>









  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagedPredicate" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedPredicate            (<span title="abc.ABC">ABC</span>)
        </code>



<a href="#freetensor.core.staging.StagedPredicate" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.staging.StagedPredicate.__class__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedPredicate.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedPredicate.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedPredicate.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedPredicate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedPredicate.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedPredicate.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedPredicate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.staging.StagedPredicate.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedPredicate.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedPredicate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedPredicate.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedPredicate.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedPredicate</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagedPredicate.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagedTypeAnnotation" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedTypeAnnotation        </code>



<a href="#freetensor.core.staging.StagedTypeAnnotation" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.staging.StagedTypeAnnotation.__class__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedTypeAnnotation.__class__            (<span title="abc.ABCMeta">ABCMeta</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">





  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h6 id="freetensor.core.staging.StagedTypeAnnotation.__class__.__base__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedTypeAnnotation.__class__.__base__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__.__base__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotation</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotation</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.__new__" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotation</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h7 id="freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotation</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__.__base__.register" class="headerlink" title="Permanent link">&para;</a></h7>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedTypeAnnotation.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotation</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotation.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagedTypeAnnotationMeta" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedTypeAnnotationMeta            (<span title="abc.ABCMeta">ABCMeta</span>)
        </code>



<a href="#freetensor.core.staging.StagedTypeAnnotationMeta" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.staging.StagedTypeAnnotationMeta.__base__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedTypeAnnotationMeta.__base__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotationMeta.__base__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedTypeAnnotationMeta.__base__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotationMeta</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotationMeta.__base__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedTypeAnnotationMeta.__base__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotationMeta</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotationMeta.__base__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedTypeAnnotationMeta.__base__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotationMeta</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotationMeta.__base__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedTypeAnnotationMeta.__base__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotationMeta</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagedTypeAnnotationMeta.__base__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>









  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagedTypeAnnotationMeta.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedTypeAnnotationMeta</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedTypeAnnotationMeta.register" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagedUnpackAssignable" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedUnpackAssignable            (<span title="abc.ABC">ABC</span>)
        </code>



<a href="#freetensor.core.staging.StagedUnpackAssignable" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="freetensor.core.staging.StagedUnpackAssignable.__class__" class="doc doc-heading">
        <code>
freetensor.core.staging.StagedUnpackAssignable.__class__            (<span title="type">type</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.StagedUnpackAssignable.__class__" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metaclass for defining Abstract Base Classes (ABCs).</p>
<p>Use this metaclass to create an ABC.  An ABC can be subclassed
directly, and then acts as a mix-in class.  You can also register
unrelated concrete classes (even built-in classes) and unrelated
ABCs as 'virtual subclasses' -- these and their descendants will
be considered subclasses of the registering ABC by the built-in
issubclass() function, but the registering ABC won't show up in
their MRO (Method Resolution Order) nor will method
implementations defined by the registering ABC be callable (not
even via super()).</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedUnpackAssignable.__class__.__instancecheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedUnpackAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedUnpackAssignable.__class__.__instancecheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for isinstance(instance, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedUnpackAssignable.__class__.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedUnpackAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#freetensor.core.staging.StagedUnpackAssignable.__class__.__new__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Create and return a new object.  See help(type) for accurate signature.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedUnpackAssignable.__class__.__subclasscheck__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedUnpackAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.core.staging.StagedUnpackAssignable.__class__.__subclasscheck__" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Override for issubclass(subclass, cls).</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="freetensor.core.staging.StagedUnpackAssignable.__class__.register" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagedUnpackAssignable</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagedUnpackAssignable.__class__.register" class="headerlink" title="Permanent link">&para;</a></h6>

    <div class="doc doc-contents ">

      <p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>

    </div>

  </div>





  </div>

    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagingError" class="doc doc-heading">
        <code>
freetensor.core.staging.StagingError            (<span title="Exception">Exception</span>)
        </code>



<a href="#freetensor.core.staging.StagingError" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Error occurred during staging function execution (i.e. IR tree generation).</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.StagingOverload" class="doc doc-heading">
        <code>
freetensor.core.staging.StagingOverload        </code>



<a href="#freetensor.core.staging.StagingOverload" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">





  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.allow_shortcut_scope" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">allow_shortcut_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allow</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.allow_shortcut_scope" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Opens a scope that allows shortcut control flows in a statically deterministic</p>
<p>context. Need to be closed by <code>with</code> statement.</p>

    </div>

  </div>





  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.assert_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">assert_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.assert_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Assert staging tool.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.assign_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">assign_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.assign_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign wrapper.</p>
<p>If <code>value</code> is instance of <code>StagedAssignable</code>, it's regarded as a customized
assign behavior and gets executed with the assigned target variable name.
This wrapper is used for initializing a variable.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.break_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">break_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.break_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Break staging tool. Only allow break in static control flow.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.continue_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">continue_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.continue_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Continue staging tool. Only allow continue in static control flow.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.custom_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">custom_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.custom_attr" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized attribute accessor.</p>
<p>The framework first looks for a Python native attribute. If not found, it looks
for this overloaded custom attribute resolver.</p>
<p>The default implementation provides no custom attribute.
Can be overridden by subclasses.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>obj</strong> (<code>Any</code>) – Object to access attribute.</p></li>
            <li><p><strong>attr</strong> (<code>str</code>) – Attribute name.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Any</code> – The attribute value.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.foreach" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.foreach" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized foreach wrapper.</p>
<p>If <code>value</code> is instance of <code>StagedIterable</code>, its regarded as a customized foreach
behavior and used to generate code for the python for loop.
Otherwise, we try to execute the loop as usual.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.functiondef_wrapper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">functiondef_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.functiondef_wrapper" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Function definition wrapper.</p>
<p>This wrapper performs extra initialization and cleanup for function definition.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.if_then_else_expr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">if_then_else_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">then_expr</span><span class="p">,</span> <span class="n">else_expr</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.if_then_else_expr" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>If-then-else expression staging tool.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.if_then_else_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">if_then_else_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">,</span> <span class="n">then_body</span><span class="p">,</span> <span class="n">else_body</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.if_then_else_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>If-then-else statement staging tool.</p>
<p>When predicate is deterministic in staging, only one branch is generated.
Otherwise, a If node in IR is generated.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.load_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">load_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.load_attr" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Load attribute staging tool. Allows customization of reading attributes.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.mark_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">mark_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.mark_position" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Code position handler.</p>
<p>Defaults to a no-op. Can be overridden by subclasses.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>lineno</strong> (<code>int</code>) – Line number of the next statement.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.metadata" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Metadata handler.</p>
<p>A metadata line is a comment starting with <code>#!</code> and followed by a metadata,
represented as a string parameter.</p>
<p>Defaults to a no-op.
Can be overridden by subclasses.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>content</strong> (<code>str</code>) – The metadata content.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.return_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">return_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">funcname</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.return_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Return staging tool. Only allow return in static control flow.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.unpack_assign_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">unpack_assign_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.unpack_assign_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Customized assign wrapper for one or more targets.</p>
<p>If <code>values</code> is instance of <code>StagedUnpackAssignable</code>, it's regarded as a customized
assign behavior and gets executed with all the assigned targets' names. Otherwise,
it calls <code>assign_stmt</code> with each sub-assignments.</p>
<p>Please note that <code>names</code> can be nested tuples like <code>("a", ("b", "c"))</code>.</p>
<p>Please also note that <code>names</code> can also be a single string like "a" even if <code>values</code>
is a tuple. There is no unpacking in this case</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.StagingOverload.while_stmt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">StagingOverload</span><span class="o">.</span><span class="n">while_stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpred</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.StagingOverload.while_stmt" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>While statement staging tool.</p>

    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.TransformError" class="doc doc-heading">
        <code>
freetensor.core.staging.TransformError            (<span title="Exception">Exception</span>)
        </code>



<a href="#freetensor.core.staging.TransformError" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Error occurred during AST transforming from python function to staging function</p>
<p>that generates IR tree.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.staging.Transformer" class="doc doc-heading">
        <code>
freetensor.core.staging.Transformer            (<span title="ast.NodeTransformer">NodeTransformer</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#freetensor.core.staging.Transformer" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Transformer(filename: 'str', base_lineno: 'int', curr_func: 'str' = None, nonlocals: 'List[List[str]]' = None)</p>




  <div class="doc doc-children">
















  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.generic_visit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a href="#freetensor.core.staging.Transformer.generic_visit" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Called if no explicit visitor function exists for a node.</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Visit a node.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_AnnAssign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_AnnAssign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_AnnAssign" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Rule:</p>
<p><code>x: Ty</code> -&gt; <code>freetensor__annotate__x = annotate_stmt('x', Ty)
if freetensor__annotate__x:
    x = freetensor__annotate__x(x)</code>: pure annotation</p>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_Assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_Assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_Assign" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Rule:</p>
<p><code>lhs = rhs</code> -&gt; <code>lhs = unpack_assign_stmt('lhs', rhs)</code>
<code>x.lhs = rhs</code> -&gt; <code>x.lhs = unpack_assign_stmt('lhs', rhs)</code>
<code>a, (b, c) = (x, (y, z))</code> -&gt; <code>a, (b, c) = unpack_assign_stmt(('a', ('b', 'c')), (x, (y, z)))</code>
<code>a = b = c</code> -&gt; <code>a = unpack_assign_stmt('a', c); b = unpack_assign_stmt('b', c)</code></p>
<p>If <code>unpack_assign_stmt</code> is not overloaded, <code>assign_stmt</code> will be called for each item</p>

    </div>

  </div>








  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_Compare" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_Compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_Compare" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Expand multiple comparison into <code>and</code> expression.</p>

    </div>

  </div>





  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_For" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_For</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_For" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Rule:</p>
<pre><code>for x in iter:
    body
</code></pre>
<p>-&gt;</p>
<pre><code>def for_body(x):
    body
foreach('x', iter, for_body)
</code></pre>

    </div>

  </div>




  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_If" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_If" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Rule:</p>
<pre><code>if pred:
    body
else:
    orelse
</code></pre>
<p>-&gt;</p>
<pre><code>def then_body():
    body
def else_body():
    orelse
if_then_else_stmt(pred, then_body, else_body)
</code></pre>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_IfExp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_IfExp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_IfExp" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Rule: <code>body if test else orelse</code> -&gt; <code>if_then_else_expr(test, body, orelse)</code></p>

    </div>

  </div>







  <div class="doc doc-object doc-method">



<h5 id="freetensor.core.staging.Transformer.visit_While" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">visit_While</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_node</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.Transformer.visit_While" class="headerlink" title="Permanent link">&para;</a></h5>

    <div class="doc doc-contents ">

      <p>Rule:</p>
<pre><code>while pred:
    body
</code></pre>
<p>-&gt;</p>
<pre><code>def while_body():
    body
while_stmt(lambda: pred, while_body)
</code></pre>

    </div>

  </div>









  </div>

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.staging.call_helper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">call_helper</span><span class="p">(</span><span class="n">callee</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.call_helper" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Call helper that generates a python AST Call node with given callee (overload</p>
<p>member) and arguments AST node.</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.staging.function_helper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">staging</span><span class="o">.</span><span class="n">function_helper</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">nonlocals</span><span class="p">)</span></code>


<a href="#freetensor.core.staging.function_helper" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Function helper that generates a python AST FunctionDef node with given name,</p>
<p>arguments name, and body.</p>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.stmt" class="doc doc-heading">
        <code>freetensor.core.stmt</code>



<a href="#freetensor.core.stmt" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Facility to build AST statements</p>
<p>Classes and functions in this module are internally used by <code>transformer</code> to construct ASTs.
They are also used by some internal tests. API of these classes and functions are subject to changes.
End users are encouraged to use <code>transformer</code>, instead of this module.</p>
<p>Classes and functions in this module are all in BigCamel naming style, to distinguish from
expressions in <code>expr.py</code></p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.Assert" class="doc doc-heading">
        <code>
freetensor.core.stmt.Assert        </code>



<a href="#freetensor.core.stmt.Assert" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Scope used to create an Assert node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with Assert(i &gt; 0):
    ... # Assertion body
</code></pre>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.Else" class="doc doc-heading">
        <code>
freetensor.core.stmt.Else        </code>



<a href="#freetensor.core.stmt.Else" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Scope used to create an else branch of an If node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with If(i &gt; 0):
    ... # True branch
with Else():
    ... # Else branch
</code></pre>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.For" class="doc doc-heading">
        <code>
freetensor.core.stmt.For        </code>



<a href="#freetensor.core.stmt.For" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Scope used to create a For node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with For('i', 0, n) as i:
    ... # Loop body
</code></pre>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.If" class="doc doc-heading">
        <code>
freetensor.core.stmt.If        </code>



<a href="#freetensor.core.stmt.If" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Scope used to create an If node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>
<p>E.g.:</p>
<pre><code>with If(i &gt; 0):
    ... # Branch body
</code></pre>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.Invoke" class="doc doc-heading">
        <code>
freetensor.core.stmt.Invoke        </code>



<a href="#freetensor.core.stmt.Invoke" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Inlined invocation of another AST</p>
<p><code>Invoke</code> is used as a scope (<code>with Invoke(...) as returned_vars</code>), so that variables returned by
the callee can be used in the socpe</p>
<p><code>Invoke</code> can be used for invoking a gradient function, which has already been lowered as an AST.
Please note that once a user function has been lowered as an AST, the dimensionalities of its
tensors get fixed. Therefore, to invoke ordinary user functions, please use <code>inline</code> in <code>transformer</code>
instead, which supports generic types</p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.NamedScope" class="doc doc-heading">
        <code>
freetensor.core.stmt.NamedScope        </code>



<a href="#freetensor.core.stmt.NamedScope" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Scope used to create an StmtSeq node with an explicit labels</p>
<p>E.g.:</p>
<pre><code>with NamedScope():
    ... # body
</code></pre>
<p>This scope is used for testing only. StmtSeq nodes can be deleted in many lowering passes</p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="freetensor.core.stmt.UserGradStaged" class="doc doc-heading">
        <code>
freetensor.core.stmt.UserGradStaged        </code>



<a href="#freetensor.core.stmt.UserGradStaged" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Internal staged implementation of <code>UserGrad</code></p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.Any" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">Any</span><span class="p">()</span></code>


<a href="#freetensor.core.stmt.Any" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an Any node (only for testing)</p>
<p>Any nodes matches any statement nodes in <code>ast.match</code></p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.Eval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">Eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>


<a href="#freetensor.core.stmt.Eval" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an Eval node</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.MarkLabel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">MarkLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></code>


<a href="#freetensor.core.stmt.MarkLabel" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Mark the ID of the following statement</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.MarkVersion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">MarkVersion</span><span class="p">(</span><span class="n">tape_name</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span></code>


<a href="#freetensor.core.stmt.MarkVersion" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create an MarkVersion node (only for custom gradient)</p>
<p>This node is only used for custom gradient. See <code>UserGrad</code>.</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.stmt.VarDef" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">VarDef</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kvs</span><span class="p">)</span></code>


<a href="#freetensor.core.stmt.VarDef" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>A factory function that creates a VarDef or a series of nested <code>VarDef</code>s</p>
<p>This scope is internally used by <code>transformer</code> and tests</p>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.transform" class="doc doc-heading">
        <code>freetensor.core.transform</code>



<a href="#freetensor.core.transform" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.transform.inline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">inline</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dynamic_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#freetensor.core.transform.inline" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Enable a user function to be called by a transformed function at run time</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>Python function</code>) – The user function</p></li>
            <li><p><strong>src</strong> (<code>str (Optional)</code>) – The source code of <code>func</code>. This parameter is only required if the source
code cannot be get automatically, e.g., if <code>func</code> is generated from an
<code>exec</code></p></li>
            <li><p><strong>default_dynamic_range</strong> (<code>bool</code>) – If True, the built-in range is replaced with freetensor.dynamic_range.
Defaults to True</p></li>
            <li><p><strong>verbose</strong> (<code>bool</code>) – True to print the generated Python code that is used for transforming</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.transform.transform" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dynamic_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bind</span><span class="o">=</span><span class="p">{},</span> <span class="n">jit_cache</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">cache</span> <span class="n">at</span> <span class="mh">0x14a34f001a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.core.transform.transform" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Transform a user function to an AST</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>func</strong> (<code>Python function</code>) – The user function to transform. If not specified, a partial function will
be returend, which can be used as a decorator</p></li>
            <li><p><strong>default_dynamic_range</strong> (<code>bool</code>) – If True, the built-in range is replaced with freetensor.dynamic_range.
Defaults to True</p></li>
            <li><p><strong>bind</strong> (<code>Mapping[str, Any]</code>) – Bind some parameters to specific values before transformations. Accpeting a
parameter-name-to-value dict.</p></li>
            <li><p><strong>jit_cache</strong> (<code>Callable[[Callable], Callable]</code>) – Function decorator used to cache JIT instances</p></li>
            <li><p><strong>target</strong> (<code>Target</code>) – If not None, set <code>config.default_target</code> when transforming. This affects the
default memory type use to create variables from <code>Var</code>, <code>empty</code> and etc.</p></li>
            <li><p><strong>verbose</strong> (<code>int</code>) – 0 = print nothing. 1 = print the resulting AST. 2 = 1 + print the generated
Python code that is used for transforming</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Func or JITTemplate</code> – Return a Func for an AST if there is no JIT parameters. Return a JITTemplate
that generates a Func if there is at least one</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.core.utils" class="doc doc-heading">
        <code>freetensor.core.utils</code>



<a href="#freetensor.core.utils" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h4 id="freetensor.core.utils.as_decorator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">as_decorator</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code>


<a href="#freetensor.core.utils.as_decorator" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Enable a multi-parameter function <code>f</code> to be used as a decorator</p>
<p>Suppose <code>g = as_decorator(f)</code>, enable the following usages:</p>
<pre><code>@g
def h(...):
    ...

@g(a=a, b=b, c=c)
def h(...):
    ...
</code></pre>
<p>Formally, <code>g</code> will have the same parameters as <code>f</code>. <code>f</code>'s first parameter should
be the function it decorate, say <code>h</code>, and may have other parameters with default
values. If <code>h</code> is set when called, <code>g</code> will return the decorated function, just
as <code>f</code> does. If <code>h</code> is not set, <code>g</code> will return an <code>f</code>'s partial function with
all other parameters set, and the partial function can then be decorate another
<code>h</code> again.</p>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>





  <div class="doc doc-object doc-module">



<h2 id="freetensor.libop" class="doc doc-heading">
        <code>freetensor.libop</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#freetensor.libop" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.assign" class="doc doc-heading">
        <code>freetensor.libop.assign</code>



<a href="#freetensor.libop.assign" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.add_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.add_to" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) add to a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.assign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.assign" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) assign to a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.floordiv_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">floordiv_to</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.floordiv_to" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) rounding-towards-negative-infinity integer division (following Python convention, but not C) from a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.mod_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">mod_to</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.mod_to" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) modulo (results are non-negative, following Python convention, but not C) from a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.mul_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">mul_to</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.mul_to" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) multiply to a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.sub_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">sub_to</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.sub_to" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) subtract from a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.assign.truediv_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">assign</span><span class="o">.</span><span class="n">truediv_to</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.assign.truediv_to" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) floating-point division from a tensor two another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The target tensor</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The source tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.concat" class="doc doc-heading">
        <code>freetensor.libop.concat</code>



<a href="#freetensor.libop.concat" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.concat.concat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.libop.concat.concat" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Concatenate a list of tensors into a single tensor on an existing axis (out-of-place)</p>
<p>All input tensors must have the same shape, except for the dimension size of the
axis to concatenate on.</p>
<p>All input tensors must have the same data type and memory type.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>inputs</strong> (<code>Sequence[freetensor.core.expr.VarRef]</code>) – Tensors for concatenation</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Dimension number for concatenation. Negative axis means counting from the last
dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – Concatenation result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.concat.concat_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">concat_</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.libop.concat.concat_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Concatenate a list of tensors into a single tensor on an existing axis (in-place)</p>
<p>All input tensors must have the same shape, except for the dimension size of the
axis to concatenate on.</p>
<p>All input tensors must have the same data type and memory type.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>inputs</strong> (<code>Sequence[freetensor.core.expr.VarRef]</code>) – Tensors for concatenation</p></li>
            <li><p><strong>output</strong> (<code>VarRef</code>) – Concatenation result</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Dimension number for concatenation. Negative axis means counting from the last
dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.concat.stack" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.libop.concat.stack" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Concatenate a list of tensors into a single tensor on a new axis (out-of-place)</p>
<p>All input tensors must have the same shape, data type and memory type.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>inputs</strong> (<code>Sequence[freetensor.core.expr.VarRef]</code>) – Tensors for concatenation</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Dimension number for concatenation. Negative axis means counting from the last
dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – Concatenation result</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.concat.stack_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">stack_</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#freetensor.libop.concat.stack_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Concatenate a list of tensors into a single tensor on a new axis (in-place)</p>
<p>All input tensors must have the same shape, data type and memory type.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>inputs</strong> (<code>Sequence[freetensor.core.expr.VarRef]</code>) – Tensors for concatenation</p></li>
            <li><p><strong>output</strong> (<code>VarRef</code>) – Concatenation result</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Dimension number for concatenation. Negative axis means counting from the last
dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.constant" class="doc doc-heading">
        <code>freetensor.libop.constant</code>



<a href="#freetensor.libop.constant" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.constant.ones" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">mtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.constant.ones" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create a one-valued tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>shape</strong> (<code>Sequence[Expr] or Var</code>) – Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></li>
            <li><p><strong>dtype</strong> (<code>str or DataType</code>) – Data type of the variable</p></li>
            <li><p><strong>mtype</strong> (<code>str or MemType (Optional)</code>) – Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The one-valued tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.constant.ones_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">ones_</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>


<a href="#freetensor.libop.constant.ones_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Fill ones to a tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The tensor to fill</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.constant.zeros" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">mtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.constant.zeros" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create a zero tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>shape</strong> (<code>Sequence[Expr] or Var</code>) – Shape of the variable. A variable can be created using a literal shape,
or another fixed-length VarRef as a shape</p></li>
            <li><p><strong>dtype</strong> (<code>str or DataType</code>) – Data type of the variable</p></li>
            <li><p><strong>mtype</strong> (<code>str or MemType (Optional)</code>) – Memory type of the variable. If omitted, the main memory type of the
default Target in config will be used</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The zero tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.constant.zeros_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">constant</span><span class="o">.</span><span class="n">zeros_</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>


<a href="#freetensor.libop.constant.zeros_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Fill zeros to a tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>y</strong> (<code>VarRef</code>) – The tensor to fill</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.conv" class="doc doc-heading">
        <code>freetensor.libop.conv</code>



<a href="#freetensor.libop.conv" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.conv.conv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">conv</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_pad</span><span class="o">=</span><span class="s1">&#39;NOTSET&#39;</span><span class="p">,</span> <span class="n">dilations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.conv.conv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Convolution. The result is returned</p>
<p>Parameters follow ONNX convention. Currently only 2-D convolution is supported</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.conv.conv_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">conv</span><span class="o">.</span><span class="n">conv_</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">auto_pad</span><span class="o">=</span><span class="s1">&#39;NOTSET&#39;</span><span class="p">,</span> <span class="n">dilations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.conv.conv_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Convolution. The result is written to another tensor</p>
<p>Parameters follow ONNX convention. Currently only 2-D convolution is supported</p>

    </div>

  </div>






  </div>

    </div>

  </div>




  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.element_wise" class="doc doc-heading">
        <code>freetensor.libop.element_wise</code>



<a href="#freetensor.libop.element_wise" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">













  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.abs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.abs" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise absolute value of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.abs_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">abs_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.abs_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise absolute value of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.add" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.add" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise addition of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.add_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.add_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise addition of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.binary_op" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">binary_op</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.binary_op" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) any element-wise operation on two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>op</strong> (<code>Callable</code>) – The operation applied to each item</p></li>
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.binary_op_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">binary_op_</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.binary_op_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) any element-wise operation on two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>op</strong> (<code>Callable</code>) – The operation applied to each item</p></li>
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ceil" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ceil" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise ceil of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ceil_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ceil_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ceil_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise ceil of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ceildiv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ceildiv</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ceildiv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise rounding-towards-positive-infinity integer division of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ceildiv_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ceildiv_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ceildiv_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise rounding-towards-positive-infinity integer division of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.cos" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.cos" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise cos of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.cos_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">cos_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.cos_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise cos of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.eq" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise equal of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.eq_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">eq_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.eq_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise equal of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.exp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.exp" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise natrual exponent of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.exp_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">exp_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.exp_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise natrual exponent of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.floor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.floor" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise floor of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.floor_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">floor_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.floor_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise floor of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.floordiv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.floordiv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise rounding-towards-negative-infinity integer division (following Python convention, but not C, recommended for performance) of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.floordiv_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">floordiv_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.floordiv_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise rounding-towards-negative-infinity integer division (following Python convention, but not C, recommended for performance) of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ge" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise greater-than-or-equal-to of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ge_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ge_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ge_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise greater-than-or-equal-to of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.gt" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise greater-than of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.gt_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">gt_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.gt_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise greater-than of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.l_and" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">l_and</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.l_and" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise logical and of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.l_and_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">l_and_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.l_and_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise logical and of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.l_not" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">l_not</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.l_not" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise logical not of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.l_not_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">l_not_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.l_not_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise logical not of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.l_or" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">l_or</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.l_or" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise logical or of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.l_or_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">l_or_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.l_or_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise logical or of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.le" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise less-than-or-equal-to of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.le_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">le_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.le_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise less-than-or-equal-to of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ln" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ln" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise natrual logarithm of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ln_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ln_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ln_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise natrual logarithm of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.lt" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise less-than of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.lt_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">lt_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.lt_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise less-than of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.max" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise maximum of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.max_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">max_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.max_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise maximum of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.min" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.min" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise minimum of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.min_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">min_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.min_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise minimum of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.mod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.mod" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise modulo (results are non-negative, following Python convention, but not C, recommended for performance) of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.mod_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">mod_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.mod_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise modulo (results are non-negative, following Python convention, but not C, recommended for performance) of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.mul" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.mul" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise multiplication of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.mul_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.mul_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise multiplication of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ne" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise non-equal of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.ne_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">ne_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.ne_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise non-equal of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.neg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">neg</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.neg" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise negation of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.neg_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">neg_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.neg_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise negation of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.relu" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.relu" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise ReLU of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.relu_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">relu_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.relu_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise ReLU of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.remainder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.remainder" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise remainder (results can be positive or negative, following C convention, but not Python, NOT recommended for performance) of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.remainder_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">remainder_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.remainder_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise remainder (results can be positive or negative, following C convention, but not Python, NOT recommended for performance) of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.round_towards_0_div" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">round_towards_0_div</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.round_towards_0_div" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise rounding-towards-0 integer division (following C convention, but not Python, NOT recommended for performance) of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.round_towards_0_div_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">round_towards_0_div_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.round_towards_0_div_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise rounding-towards-0 integer division (following C convention, but not Python, NOT recommended for performance) of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sigmoid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sigmoid" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise sigmoid of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sigmoid_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sigmoid_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sigmoid_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise sigmoid of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sin" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sin" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise sin of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sin_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sin_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sin_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise sin of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sqrt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sqrt" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise square root of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sqrt_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sqrt_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sqrt_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise square root of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.square" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.square" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise square of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.square_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">square_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.square_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise square of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sub" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sub" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise subtraction of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.sub_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">sub_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.sub_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise subtraction of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.tan" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.tan" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise tan of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.tan_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">tan_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.tan_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise tan of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.tanh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.tanh" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise tanh of a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.tanh_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">tanh_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.tanh_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Element-wise tanh of a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.truediv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">truediv</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.truediv" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise floating-point division of two tensors and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.truediv_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">truediv_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.truediv_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>(Broadcasted) element-wise floating-point division of two tensors. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – Left-hand-side operand</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – Right-hand-side operand</p></li>
            <li><p><strong>out</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.unary_op" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">unary_op</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.unary_op" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Any element-wise operation on a tensor and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>op</strong> (<code>Callable</code>) – The operation applied to each item</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.element_wise.unary_op_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">element_wise</span><span class="o">.</span><span class="n">unary_op_</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


<a href="#freetensor.libop.element_wise.unary_op_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Any element-wise operation on a tensor. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>op</strong> (<code>Callable</code>) – The operation applied to each item</p></li>
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.logsumexp" class="doc doc-heading">
        <code>freetensor.libop.logsumexp</code>



<a href="#freetensor.libop.logsumexp" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.logsumexp.logsumexp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">logsumexp</span><span class="o">.</span><span class="n">logsumexp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.libop.logsumexp.logsumexp" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Compute <code>ln sum_i exp(x_i)</code>, where <code>i</code> is along an axis. Return the result.</p>
<p>The computation is numerically stabilized.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Axis that the reduction is performed along. Negative axis means counting
from the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.logsumexp.logsumexp_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">logsumexp</span><span class="o">.</span><span class="n">logsumexp_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.libop.logsumexp.logsumexp_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Compute <code>ln sum_i exp(x_i)</code>, where <code>i</code> is along an axis. Write to tensor <code>y</code>.</p>
<p>The computation is numerically stabilized.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Axis that the reduction is performed along. Negative axis means counting
from the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.matmul" class="doc doc-heading">
        <code>freetensor.libop.matmul</code>



<a href="#freetensor.libop.matmul" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.matmul.einsum" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">matmul</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#freetensor.libop.matmul.einsum" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Einstein summation. The result is returned</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>fmt</strong> (<code>str</code>) – The format string. E.g. <code>"ik,kj-&gt;ij"</code> represents a matrix multiplcation</p></li>
            <li><p><strong>args</strong> (<code>Sequence[VarRef]</code>) – All inputs arguments. E.g. if <code>fmt</code> is <code>"ik,kj-&gt;ij"</code>,
it iterates axis <code>i</code> and <code>k</code> of <code>args[0]</code>, axis <code>k</code> and <code>j</code> of <code>args[1]</code>,
axis <code>i</code> and <code>j</code> of the returned value</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.matmul.einsum_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">matmul</span><span class="o">.</span><span class="n">einsum_</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#freetensor.libop.matmul.einsum_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Einstein summation. The result is written to the last argument</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>fmt</strong> (<code>str</code>) – The format string. E.g. <code>"ik,kj-&gt;ij"</code> represents a matrix multiplcation</p></li>
            <li><p><strong>args</strong> (<code>Sequence[VarRef]</code>) – All arguments including inputs and the output. E.g. if <code>fmt</code> is <code>"ik,kj-&gt;ij"</code>,
it iterates axis <code>i</code> and <code>k</code> of <code>args[0]</code>, axis <code>k</code> and <code>j</code> of <code>args[1]</code>,
axis <code>i</code> and <code>j</code> of <code>args[2]</code></p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.matmul.gemm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">matmul</span><span class="o">.</span><span class="n">gemm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trans_A</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trans_B</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>


<a href="#freetensor.libop.matmul.gemm" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>General matrix multiplcation following BLAS convention and return the result</p>
<p>It performs <code>Y = alpha tr?(A) @ tr?(B) + C</code>, where <code>@</code> represents matrix multiplication, <code>tr?</code>
represents an optional transposition</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>A</strong> (<code>VarRef</code>) – The left-hand-side operand of matrix multiplication</p></li>
            <li><p><strong>B</strong> (<code>VarRef</code>) – The right-hand-side operand of matrix multiplication</p></li>
            <li><p><strong>C</strong> (<code>VarRef (Optional)</code>) – The bias tensor</p></li>
            <li><p><strong>trans_A</strong> (<code>bool</code>) – If true, transpose <code>A</code>. Defaults to False</p></li>
            <li><p><strong>trans_B</strong> (<code>bool</code>) – If true, transpose <code>B</code>. Defaults to False</p></li>
            <li><p><strong>alpha</strong> (<code>float</code>) – Coefficient of <code>tr?(A) @ tr?(B)</code>. Defaults to 1.0</p></li>
            <li><p><strong>beta</strong> (<code>float</code>) – Coefficient of <code>C</code>. Defaults to 1.0</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The resulting tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.matmul.gemm_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">matmul</span><span class="o">.</span><span class="n">gemm_</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">trans_A</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trans_B</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>


<a href="#freetensor.libop.matmul.gemm_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>General matrix multiplcation following BLAS convention. The result is written to an existing tensor</p>
<p>It performs <code>Y = alpha tr?(A) @ tr?(B) + C</code>, where <code>@</code> represents matrix multiplication, <code>tr?</code>
represents an optional transposition</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>A</strong> (<code>VarRef</code>) – The left-hand-side operand of matrix multiplication</p></li>
            <li><p><strong>B</strong> (<code>VarRef</code>) – The right-hand-side operand of matrix multiplication</p></li>
            <li><p><strong>C</strong> (<code>VarRef (Optional)</code>) – The bias tensor</p></li>
            <li><p><strong>Y</strong> (<code>VarRef</code>) – The resulting tensor</p></li>
            <li><p><strong>trans_A</strong> (<code>bool</code>) – If true, transpose <code>A</code>. Defaults to False</p></li>
            <li><p><strong>trans_B</strong> (<code>bool</code>) – If true, transpose <code>B</code>. Defaults to False</p></li>
            <li><p><strong>alpha</strong> (<code>float</code>) – Coefficient of <code>tr?(A) @ tr?(B)</code>. Defaults to 1.0</p></li>
            <li><p><strong>beta</strong> (<code>float</code>) – Coefficient of <code>C</code>. Defaults to 1.0</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.matmul.matmul" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">matmul</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span></code>


<a href="#freetensor.libop.matmul.matmul" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Matrix multiplcation. The result is returned</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>A</strong> (<code>VarRef</code>) – The left-hand-side operand</p></li>
            <li><p><strong>B</strong> (<code>VarRef</code>) – The right-hand-side operand</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The resulting tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.matmul.matmul_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">matmul</span><span class="o">.</span><span class="n">matmul_</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span></code>


<a href="#freetensor.libop.matmul.matmul_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Matrix multiplcation. The result is written to an existing tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>A</strong> (<code>VarRef</code>) – The left-hand-side operand</p></li>
            <li><p><strong>B</strong> (<code>VarRef</code>) – The right-hand-side operand</p></li>
            <li><p><strong>C</strong> (<code>VarRef</code>) – The resulting tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.pooling" class="doc doc-heading">
        <code>freetensor.libop.pooling</code>



<a href="#freetensor.libop.pooling" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.global_avg_pool" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">global_avg_pool</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>


<a href="#freetensor.libop.pooling.global_avg_pool" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Global averaging pooling. The result is returned</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.global_avg_pool_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">global_avg_pool_</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span></code>


<a href="#freetensor.libop.pooling.global_avg_pool_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Global averaging pooling. The result is written to another tensor</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.max_pool" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">max_pool</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">auto_pad</span><span class="o">=</span><span class="s1">&#39;NOTSET&#39;</span><span class="p">,</span> <span class="n">dilations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.pooling.max_pool" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Maximum pooling. The result is returned</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.pooling.max_pool_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">pooling</span><span class="o">.</span><span class="n">max_pool_</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">auto_pad</span><span class="o">=</span><span class="s1">&#39;NOTSET&#39;</span><span class="p">,</span> <span class="n">dilations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.pooling.max_pool_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Maximum pooling. The result is written to another tensor</p>
<p>Parameters follow ONNX convention. Currently only 2-D pooling is supported</p>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.reduction" class="doc doc-heading">
        <code>freetensor.libop.reduction</code>



<a href="#freetensor.libop.reduction" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">











  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.all" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.all" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reduction of logical and of a tensor through one or more dimensions and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.all_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">all_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.all_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reduction of logical and of a tensor through one or more dimensions. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.any" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.any" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reduction of logical or of a tensor through one or more dimensions and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.any_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">any_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.any_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reduction of logical or of a tensor through one or more dimensions. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_max" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Maximum of a tensor through one or more dimensions and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_max_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_max_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_max_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Maximum of a tensor through one or more dimensions. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_min" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_min" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Minimum of a tensor through one or more dimensions and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_min_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_min_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_min_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Minimum of a tensor through one or more dimensions. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_prod" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_prod</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_prod" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Product of a tensor through one or more dimensions and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_prod_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_prod_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_prod_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Product of a tensor through one or more dimensions. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_sum" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_sum" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Sum of a tensor through one or more dimensions and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reduction.reduce_sum_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reduction</span><span class="o">.</span><span class="n">reduce_sum_</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kvs</span><span class="p">)</span></code>


<a href="#freetensor.libop.reduction.reduce_sum_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Sum of a tensor through one or more dimensions. The result is written to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int] (Optional)</code>) – Which dimensions to reduce through. Defaults to None, standing for all dimensions,
i.e., reduce the tensor to a scalar. Negative axis means counting form the last dimension</p></li>
            <li><p><strong>keepdims</strong> (<code>bool (Optional)</code>) – Keep the reduced dimensions as singleton dimensions. Defaults to True</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>








  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.reshape" class="doc doc-heading">
        <code>freetensor.libop.reshape</code>



<a href="#freetensor.libop.reshape" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.expand" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">expand_shape</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.expand" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Broadcast a tensor to a given shape, following the broadcasting rules</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>b</strong> (<code>Sequence of expressions</code>) – The broadcasted shape</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The broadcasted tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.expand_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">expand_</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.expand_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Broadcast a tensor to an existing tensor, following the broadcasting rules</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>a</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>b</strong> (<code>VarRef</code>) – The broadcasted tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.flatten" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.flatten" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Flatten a tensor to have two dimensions, and return the result</p>
<p>NOTE: This function follows the ONNX convension that reshapes to 2-D instead
of 1-D.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – The result tensor will have 2 dimensions. All dimensions up to <code>axis</code>
(inclusive) will be flattend to the first dimension. All dimensions after
<code>axis</code> (exclusive) will be flatten to the second dimension. Negative axis
means counting form the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.flatten_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">flatten_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.flatten_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Flatten a tensor to have two dimensions, and write to another tensor</p>
<p>NOTE: This function follows the ONNX convension that reshapes to 2-D instead
of 1-D.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – The result tensor will have 2 dimensions. All dimensions up to <code>axis</code>
(inclusive) will be flattend to the first dimension. All dimensions after
<code>axis</code> (exclusive) will be flatten to the second dimension. Negative axis
means counting form the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.flatten_onnx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">flatten_onnx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.flatten_onnx" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Flatten a tensor to have two dimensions, and return the result</p>
<p>NOTE: This function follows the ONNX convension that reshapes to 2-D instead
of 1-D.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – The result tensor will have 2 dimensions. All dimensions up to <code>axis</code>
(inclusive) will be flattend to the first dimension. All dimensions after
<code>axis</code> (exclusive) will be flatten to the second dimension. Negative axis
means counting form the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.flatten_onnx_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">flatten_onnx_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.flatten_onnx_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Flatten a tensor to have two dimensions, and write to another tensor</p>
<p>NOTE: This function follows the ONNX convension that reshapes to 2-D instead
of 1-D.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – The result tensor will have 2 dimensions. All dimensions up to <code>axis</code>
(inclusive) will be flattend to the first dimension. All dimensions after
<code>axis</code> (exclusive) will be flatten to the second dimension. Negative axis
means counting form the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.flatten_pytorch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">flatten_pytorch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">start_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.flatten_pytorch" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Flatten a tensor to have fewer dimensions, and return the result</p>
<p>NOTE: This function follows the PyTorch convension</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>start_dim, end_dim</strong> (<code>int (Optional)</code>) – All dimensions ranging from <code>start_dim</code> and <code>end_dim</code> (inclusive) will be
flattend to 1-D. Negative axis means counting form the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.flatten_pytorch_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">flatten_pytorch_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">start_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.flatten_pytorch_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Flatten a tensor to have fewer dimensions, and write to another tensor</p>
<p>NOTE: This function follows the PyTorch convension</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>start_dim, end_dim</strong> (<code>int (Optional)</code>) – All dimensions ranging from <code>start_dim</code> and <code>end_dim</code> (inclusive) will be
flattend to 1-D. Negative axis means counting form the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.reshape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.reshape" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reshape a tensor into a different shape with the same size</p>
<p>This operator will try to generate nested loops instead of looping over all
elements in a plain loop, so schedules can be better applied. It guarantees to
generates loops in the following cases:</p>
<ol>
<li>Splitting a dimension. E.g. 4 to 2x2, and there will be a 2x2 loop nest.</li>
<li>Merging dimensions. E.g. 2x2 to 4, and there will be a 2x2 loop nest.</li>
<li>Each non-affecting dimension will be iterated by a unique loop. E.g. 3x5x7
   to 5x3x7, and there will be a 15x7 loop nest, where the "7" dimension will
   be iterated by a unique loop.</li>
</ol>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>shape</strong> (<code>list of expression</code>) – The target shape</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.reshape_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">reshape_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.reshape_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Fill a tensor into another tensor with the same size but maybe different shape</p>
<p>This operator will try to generate nested loops instead of looping over all
elements in a plain loop, so schedules can be better applied. It guarantees to
generates loops in the following cases:</p>
<ol>
<li>Splitting a dimension. E.g. 4 to 2x2, and there will be a 2x2 loop nest.</li>
<li>Merging dimensions. E.g. 2x2 to 4, and there will be a 2x2 loop nest.</li>
<li>Each non-affecting dimension will be iterated by a unique loop. E.g. 3x5x7
   to 5x3x7, and there will be a 15x7 loop nest, where the "7" dimension will
   be iterated by a unique loop.</li>
</ol>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.squeeze" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.squeeze" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Remove singleton dimensions from a tensor, and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Dimension numbers of the singleton dimensions. Negative axis means counting
from the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The resulting tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.squeeze_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">squeeze_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.squeeze_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Remove singleton dimensions from a tensor, and write the result to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The resulting tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Dimension numbers of the singleton dimensions. Negative axis means counting
from the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.unsqueeze" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.unsqueeze" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Insert singleton dimensions to a tensor, and return the result</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Dimension numbers of the new singleton dimensions. Negative axis means counting
from the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The resulting tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.reshape.unsqueeze_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">reshape</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span></code>


<a href="#freetensor.libop.reshape.unsqueeze_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Insert singleton dimensions to a tensor, and write the result to another tensor</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The resulting tensor</p></li>
            <li><p><strong>axes</strong> (<code>Sequence[int]</code>) – Dimension numbers of the new singleton dimensions. Negative axis means counting
from the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>




  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.softmax" class="doc doc-heading">
        <code>freetensor.libop.softmax</code>



<a href="#freetensor.libop.softmax" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.softmax.softmax" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">softmax</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.softmax.softmax" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Softmax of tensor <code>x</code> along an axis and return the result</p>
<p>The computation is numerically stabilized.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>axis</strong> (<code>int (Optional)</code>) – Axis that the softmax is performed along. Negative axis means
counting from the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The result tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.softmax.softmax_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">softmax</span><span class="o">.</span><span class="n">softmax_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#freetensor.libop.softmax.softmax_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Softmax of tensor <code>x</code> along an axis, and write to tensor <code>y</code></p>
<p>The computation is numerically stabilized.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The result tensor</p></li>
            <li><p><strong>axis</strong> (<code>int</code>) – Axis that the softmax is performed along. Negative axis means
counting from the last dimension</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="freetensor.libop.transpose" class="doc doc-heading">
        <code>freetensor.libop.transpose</code>



<a href="#freetensor.libop.transpose" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.transpose.transpose" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">transpose</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">perm</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.transpose.transpose" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Transposition (out-of-place)</p>
<p>The <code>perm[i]</code>-th dimension of the input becomes the <code>i</code>-th dimension of
the output</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>perm</strong> (<code>Sequence[int]</code>) – Permutation of the dimensions. Negative values mean counting form the
last dimension. By default reversing all dimensions</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>VarRef</code> – The output tensor</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="freetensor.libop.transpose.transpose_" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freetensor</span><span class="o">.</span><span class="n">libop</span><span class="o">.</span><span class="n">transpose</span><span class="o">.</span><span class="n">transpose_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">perm</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#freetensor.libop.transpose.transpose_" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Transposition (in-place)</p>
<p>The <code>perm[i]</code>-th dimension of the input becomes the <code>i</code>-th dimension of
the output</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>x</strong> (<code>VarRef</code>) – The input tensor</p></li>
            <li><p><strong>y</strong> (<code>VarRef</code>) – The output tensor</p></li>
            <li><p><strong>perm</strong> (<code>Sequence[int]</code>) – Permutation of the dimensions. Negative values mean counting form the
last dimension. By default reversing all dimensions</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

  </div>






  </div>

    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../guide/ad/" class="btn btn-neutral float-left" title="Automatic Differentiation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../doxygen/html/" class="btn btn-neutral float-right" title="Internal C++ Interface">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../guide/ad/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../doxygen/html/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../javascripts/mathjax.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
